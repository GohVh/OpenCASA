\hypertarget{_persistent_random_walker_8java_source}{}\section{Persistent\+Random\+Walker.\+java}
\label{_persistent_random_walker_8java_source}\index{Persistent\+Random\+Walker.\+java@{Persistent\+Random\+Walker.\+java}}

\begin{DoxyCode}
00001 \textcolor{comment}{/*}
00002 \textcolor{comment}{ *   OpenCASA software v0.8 for video and image analysis}
00003 \textcolor{comment}{ *   Copyright (C) 2017  Carlos Alqu√©zar}
00004 \textcolor{comment}{ *}
00005 \textcolor{comment}{ *   This program is free software: you can redistribute it and/or modify}
00006 \textcolor{comment}{ *   it under the terms of the GNU General Public License as published by}
00007 \textcolor{comment}{ *   the Free Software Foundation, either version 3 of the License, or}
00008 \textcolor{comment}{ *   (at your option) any later version.}
00009 \textcolor{comment}{ *}
00010 \textcolor{comment}{ *   This program is distributed in the hope that it will be useful,}
00011 \textcolor{comment}{ *   but WITHOUT ANY WARRANTY; without even the implied warranty of}
00012 \textcolor{comment}{ *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the}
00013 \textcolor{comment}{ *   GNU General Public License for more details.}
00014 \textcolor{comment}{ *}
00015 \textcolor{comment}{ *   You should have received a copy of the GNU General Public License}
00016 \textcolor{comment}{ *   along with this program.  If not, see <https://www.gnu.org/licenses/>.}
00017 \textcolor{comment}{*/}    
00018 
00019 \textcolor{keyword}{package }data;
00020 
00021 \textcolor{keyword}{import} java.awt.Color;
00022 \textcolor{keyword}{import} java.awt.Point;
00023 \textcolor{keyword}{import} java.util.Random;
00024 
00025 \textcolor{keyword}{import} ij.ImagePlus;
00026 \textcolor{keyword}{import} ij.ImageStack;
00027 \textcolor{keyword}{import} ij.process.ByteProcessor;
00028 \textcolor{keyword}{import} ij.process.ImageProcessor;
00029 
\hypertarget{_persistent_random_walker_8java_source_l00034}{}\hyperlink{classdata_1_1_persistent_random_walker}{00034} \textcolor{keyword}{public} \textcolor{keyword}{class }\hyperlink{classdata_1_1_persistent_random_walker}{PersistentRandomWalker} \textcolor{keyword}{extends} \hyperlink{classdata_1_1_simulation}{Simulation} \{
00035 
00040   \textcolor{keyword}{class }Cell \{
00041 
00043     \textcolor{keywordtype}{int} sizex;
00045     \textcolor{keywordtype}{int} sizey;
00047     \textcolor{keywordtype}{float} x;
00049     \textcolor{keywordtype}{float} y;
00051     \textcolor{keywordtype}{double} angle;
00053     \textcolor{keywordtype}{float} speed;
00055     \textcolor{keywordtype}{double} Drot;
00057     \textcolor{keywordtype}{double} beta;
00059     \textcolor{keywordtype}{double} ro;
00061     Cell() \{
00062       Random rand = \textcolor{keyword}{new} Random();
00063       sizex = 10;
00064       sizey = 8;
00065       x = rand.nextInt(w);
00066       y = rand.nextInt(h);
00067       angle = 0;\textcolor{comment}{// random(-PI,PI);}
00068       speed = 3;\textcolor{comment}{// 4;}
00069       Drot = 0.1;
00070       beta = 0;
00071       ro = 1 / Drot;
00072     \}
00073 
00078     Cell(\textcolor{keywordtype}{double} b, \textcolor{keywordtype}{double} responsiveCells) \{
00079       Random rand = \textcolor{keyword}{new} Random();
00080       sizex = 10;
00081       sizey = 8;
00082       x = rand.nextInt(w);
00083       y = rand.nextInt(h);
00084       angle = 0;\textcolor{comment}{// random(-PI,PI);}
00085       speed = 3;\textcolor{comment}{// 4;}
00086       Drot = 0.1;
00087       \textcolor{comment}{// beta=0;//Control}
00088       \textcolor{comment}{// Chemotaxis}
00089       \textcolor{keywordflow}{if} (rand.nextFloat() < responsiveCells) \textcolor{comment}{// Only x% of the population is}
00090                                               \textcolor{comment}{// chemoattracted}
00091         beta = b;
00092       \textcolor{keywordflow}{else}
00093         beta = 0;
00094       ro = 1 / Drot;
00095     \}
00096 
00100     \textcolor{keywordtype}{void} update(ImageProcessor ip) \{
00101       Random rand = \textcolor{keyword}{new} Random();
00102       \textcolor{keywordtype}{double} epsilon = rand.nextGaussian();
00103       \textcolor{comment}{// Persistent random walker's differential equation}
00104       \textcolor{keywordtype}{double} da = -(beta / ro) * Math.sin(angle) + epsilon * Math.sqrt(2 * Drot);
00105       \textcolor{comment}{// Update variables}
00106       angle += da;
00107       angle = angle % (2 * Math.PI);
00108       \textcolor{keywordtype}{float} dx = (float) (speed * Math.cos(angle));
00109       \textcolor{keywordtype}{float} dy = (float) (speed * Math.sin(angle));
00110       x += dx;
00111       y += dy;
00112       \textcolor{comment}{// Draw Cell}
00113       ip.fillOval((\textcolor{keywordtype}{int}) x, (\textcolor{keywordtype}{int}) y, sizex, sizey);
00114 
00115     \}
00116   \}
00117 
00122   \textcolor{keyword}{class }Obstacle \{
00123 
00124     \textcolor{keywordtype}{int} x;
00125     \textcolor{keywordtype}{int} y;
00126     \textcolor{keywordtype}{int} radius;
00127 
00128     Obstacle() \{
00129       Random rand = \textcolor{keyword}{new} Random();
00130       x = rand.nextInt(w);
00131       y = rand.nextInt(h);
00132       radius = rand.nextInt(100);
00133     \}
00134 
00135     \textcolor{keywordtype}{void} update(ImageProcessor ip) \{
00136       ip.fillOval(x, y, radius, radius);
00137     \}
00138   \}
00139 
00141   \textcolor{keywordtype}{int} w = 800;
00143   \textcolor{keywordtype}{int} h = 800;
00145   \textcolor{keywordtype}{int} cellCount = 100;
00147   \textcolor{keywordtype}{int} obstaclesCount = 0;
00149   Cell[] sperm = \textcolor{keyword}{new} Cell[cellCount];
00151   Obstacle[] obstacles = \textcolor{keyword}{new} Obstacle[obstaclesCount];
00153   \textcolor{keywordtype}{int} SIMLENGTH = 500;
00155   Point[][] tracks = \textcolor{keyword}{new} Point[cellCount][SIMLENGTH];
\hypertarget{_persistent_random_walker_8java_source_l00157}{}\hyperlink{classdata_1_1_persistent_random_walker_ad49e0fa12d71d15eb1090e4e77c9f197}{00157}   \textcolor{keyword}{public} \hyperlink{classdata_1_1_persistent_random_walker_ad49e0fa12d71d15eb1090e4e77c9f197}{PersistentRandomWalker}() \{
00158 
00159     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = cellCount - 1; x >= 0; x--) \{
00160       sperm[x] = \textcolor{keyword}{new} Cell();
00161     \}
00162     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = obstaclesCount - 1; x >= 0; x--) \{
00163       obstacles[x] = \textcolor{keyword}{new} Obstacle();
00164     \}
00165   \}
00166 
\hypertarget{_persistent_random_walker_8java_source_l00171}{}\hyperlink{classdata_1_1_persistent_random_walker_a418219e73f9dc7ff97094ab05696dfa4}{00171}   \textcolor{keyword}{public} \hyperlink{classdata_1_1_persistent_random_walker_a418219e73f9dc7ff97094ab05696dfa4}{PersistentRandomWalker}(\textcolor{keywordtype}{double} b, \textcolor{keywordtype}{double} responsiveCells) \{
00172     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = cellCount - 1; x >= 0; x--) \{
00173       sperm[x] = \textcolor{keyword}{new} Cell(b, responsiveCells);
00174     \}
00175     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = obstaclesCount - 1; x >= 0; x--) \{
00176       obstacles[x] = \textcolor{keyword}{new} Obstacle();
00177     \}
00178   \}
00179 
\hypertarget{_persistent_random_walker_8java_source_l00185}{}\hyperlink{classdata_1_1_persistent_random_walker_ac0ac741c0140dfde5216dfd1f9c7d4d2}{00185}   \textcolor{keyword}{public} \hyperlink{classdata_1_1_persistent_random_walker_ac0ac741c0140dfde5216dfd1f9c7d4d2}{PersistentRandomWalker}(\textcolor{keywordtype}{double} b, \textcolor{keywordtype}{double} responsiveCells, \textcolor{keywordtype}{int} simlength) \{
00186     SIMLENGTH = simlength;
00187     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = cellCount - 1; x >= 0; x--) \{
00188       sperm[x] = \textcolor{keyword}{new} Cell(b, responsiveCells);
00189     \}
00190     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = obstaclesCount - 1; x >= 0; x--) \{
00191       obstacles[x] = \textcolor{keyword}{new} Obstacle();
00192     \}
00193   \}
00194 
00195   \textcolor{comment}{/*}
00196 \textcolor{comment}{   * (non-Javadoc)}
00197 \textcolor{comment}{   * }
00198 \textcolor{comment}{   * @see data.Simulation#createSimulation()}
00199 \textcolor{comment}{   */}
\hypertarget{_persistent_random_walker_8java_source_l00200}{}\hyperlink{classdata_1_1_persistent_random_walker_ad015489397f3b1157e02d08913211ee4}{00200}   \textcolor{keyword}{public} ImagePlus \hyperlink{classdata_1_1_persistent_random_walker_ad015489397f3b1157e02d08913211ee4}{createSimulation}() \{
00201     ImageStack imStack = \textcolor{keyword}{new} ImageStack(w, h);
00202     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} i = 0; i < SIMLENGTH; i++) \{
00203       ImageProcessor ip = \textcolor{keyword}{new} ByteProcessor(w, h);
00204       draw(ip);
00205       imStack.addSlice(ip);
00206     \}
00207     \textcolor{keywordflow}{return} \textcolor{keyword}{new} ImagePlus(\textcolor{stringliteral}{"PersistentRandomWalker"}, imStack);
00208   \}
00209 
00210   \textcolor{comment}{/*}
00211 \textcolor{comment}{   * (non-Javadoc)}
00212 \textcolor{comment}{   * }
00213 \textcolor{comment}{   * @see data.Simulation#draw(ij.process.ImageProcessor)}
00214 \textcolor{comment}{   */}
00215   \textcolor{keywordtype}{void} draw(ImageProcessor ip) \{
00216     ip.setColor(Color.black);
00217     ip.fill();
00218     ip.setColor(Color.white);
00219 
00220     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = obstaclesCount - 1; x >= 0; x--) \{
00221       obstacles[x].update(ip);
00222     \}
00223     \textcolor{keywordflow}{for} (\textcolor{keywordtype}{int} x = cellCount - 1; x >= 0; x--) \{
00224       sperm[x].update(ip);
00225     \}
00226   \}
00227 
00228   \textcolor{comment}{/*}
00229 \textcolor{comment}{   * (non-Javadoc)}
00230 \textcolor{comment}{   * }
00231 \textcolor{comment}{   * @see data.Simulation#run()}
00232 \textcolor{comment}{   */}
\hypertarget{_persistent_random_walker_8java_source_l00233}{}\hyperlink{classdata_1_1_persistent_random_walker_a13a43e6d814de94978c515cb084873b1}{00233}   \textcolor{keyword}{public} \textcolor{keywordtype}{void} \hyperlink{classdata_1_1_persistent_random_walker_a13a43e6d814de94978c515cb084873b1}{run}() \{
00234     \hyperlink{classdata_1_1_persistent_random_walker_ad015489397f3b1157e02d08913211ee4}{createSimulation}().show();
00235   \}
00236 \}
\end{DoxyCode}
