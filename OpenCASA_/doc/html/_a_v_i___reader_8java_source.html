<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCASA: C:/Users/USUARIO/git/opencasa/OpenCASA_/src/main/java/third_Party/AVI_Reader.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Morphometry.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCASA
   &#160;<span id="projectnumber">SNAPSHOT_0.1</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_a_v_i___reader_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">AVI_Reader.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_a_v_i___reader_8java.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   OpenCASA software v0.8 for video and image analysis</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   Copyright (C) 2017  Carlos Alqu√©zar</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   (at your option) any later version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*/</span>    </div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespacethird___party.html">   19</a></span>&#160;<span class="keyword">package </span>third_Party;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> java.awt.Image;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> java.awt.image.BufferedImage;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> java.awt.image.ColorModel;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">import</span> java.awt.image.IndexColorModel;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">import</span> java.io.File;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> java.io.IOException;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">import</span> java.io.InputStream;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;<span class="keyword">import</span> java.io.RandomAccessFile;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> java.util.Vector;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">import</span> javax.imageio.ImageIO;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> ij.IJ;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> ij.ImagePlus;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">import</span> ij.ImageStack;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">import</span> ij.VirtualStack;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">import</span> ij.WindowManager;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">import</span> ij.gui.GenericDialog;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">import</span> ij.io.FileInfo;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">import</span> ij.io.OpenDialog;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">import</span> ij.plugin.PlugIn;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;<span class="keyword">import</span> ij.process.ByteProcessor;</div><div class="line"><a name="l00043"></a><span class="lineno">   43</span>&#160;<span class="keyword">import</span> ij.process.ColorProcessor;</div><div class="line"><a name="l00044"></a><span class="lineno">   44</span>&#160;<span class="keyword">import</span> ij.process.ImageProcessor;</div><div class="line"><a name="l00045"></a><span class="lineno">   45</span>&#160;<span class="keyword">import</span> ij.process.ShortProcessor;</div><div class="line"><a name="l00046"></a><span class="lineno">   46</span>&#160;</div><div class="line"><a name="l00150"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html">  150</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classthird___party_1_1_a_v_i___reader.html">AVI_Reader</a> <span class="keyword">extends</span> VirtualStack implements PlugIn {</div><div class="line"><a name="l00151"></a><span class="lineno">  151</span>&#160;</div><div class="line"><a name="l00152"></a><span class="lineno">  152</span>&#160;  <span class="keyword">class </span>raInputStream <span class="keyword">extends</span> InputStream {</div><div class="line"><a name="l00153"></a><span class="lineno">  153</span>&#160;    RandomAccessFile rFile; <span class="comment">// where to read the data from</span></div><div class="line"><a name="l00154"></a><span class="lineno">  154</span>&#160;    <span class="keywordtype">int</span> readableSize; <span class="comment">// number of bytes that one should expect to be readable</span></div><div class="line"><a name="l00155"></a><span class="lineno">  155</span>&#160;    <span class="keywordtype">boolean</span> fixMJPG; <span class="comment">// whether to use an ugly hack to convert MJPG frames to</span></div><div class="line"><a name="l00156"></a><span class="lineno">  156</span>&#160;                     <span class="comment">// JPEG</span></div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;    byte[] buffer; <span class="comment">// holds beginning of data for fixing Huffman tables</span></div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keywordtype">int</span> bufferPointer; <span class="comment">// next position in buffer to read</span></div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keywordtype">int</span> bufferLength; <span class="comment">// bytes allocated in buffer</span></div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    raInputStream(RandomAccessFile rFile, <span class="keywordtype">int</span> readableSize, <span class="keywordtype">boolean</span> fixMJPG) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;      this.rFile = rFile;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;      this.readableSize = readableSize;</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;      this.fixMJPG = fixMJPG;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;      <span class="keywordflow">if</span> (fixMJPG) {</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;        buffer = <span class="keyword">new</span> byte[<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2ae593bd5a753069baf4f052e4436ff6">BUFFERSIZE</a>];</div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;        bufferLength = Math.min(<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2ae593bd5a753069baf4f052e4436ff6">BUFFERSIZE</a> - <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a>, readableSize);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;        bufferLength = rFile.read(buffer, 0, bufferLength);</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;        addHuffmanTables();</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      }</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;    }</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;    <span class="comment">// Add Huffman table if not present yet</span></div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;    <span class="keyword">private</span> <span class="keywordtype">void</span> addHuffmanTables() {</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;      <span class="keywordflow">if</span> (readShort(0) != 0xffd8 || bufferLength &lt; 6)</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// not a start of JPEG-like data</span></div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;      <span class="keywordtype">int</span> offset = 2;</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;      <span class="keywordtype">int</span> segmentLength = 0;</div><div class="line"><a name="l00180"></a><span class="lineno">  180</span>&#160;      <span class="keywordflow">do</span> {</div><div class="line"><a name="l00181"></a><span class="lineno">  181</span>&#160;        <span class="keywordtype">int</span> code = readShort(offset); <span class="comment">// read segment type</span></div><div class="line"><a name="l00182"></a><span class="lineno">  182</span>&#160;        <span class="comment">// IJ.log(&quot;code=0x&quot;+Long.toHexString(code));</span></div><div class="line"><a name="l00183"></a><span class="lineno">  183</span>&#160;        <span class="keywordflow">if</span> (code == 0xffc4) <span class="comment">// Huffman table found, nothing to do</span></div><div class="line"><a name="l00184"></a><span class="lineno">  184</span>&#160;          <span class="keywordflow">return</span>;</div><div class="line"><a name="l00185"></a><span class="lineno">  185</span>&#160;        <span class="keywordflow">else</span> <span class="keywordflow">if</span> (code == 0xffda || code == 0xffd9) { <span class="comment">// start of image data</span></div><div class="line"><a name="l00186"></a><span class="lineno">  186</span>&#160;                                                     <span class="comment">// or end of image?</span></div><div class="line"><a name="l00187"></a><span class="lineno">  187</span>&#160;          insertHuffmanTables(offset);</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;          <span class="keywordflow">return</span>; <span class="comment">// finished</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;        }</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;        offset += 2;</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;        segmentLength = readShort(offset); <span class="comment">// read length of this segment</span></div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;        offset += segmentLength; <span class="comment">// and skip the segment contents</span></div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      } <span class="keywordflow">while</span> (offset &lt; bufferLength - 4 &amp;&amp; segmentLength &gt;= 0);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;    }</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;    <span class="keyword">public</span> <span class="keywordtype">int</span> available() {</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      <span class="keywordflow">return</span> readableSize;</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;</div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;    <span class="comment">// insert Huffman tables at the given position</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keyword">private</span> <span class="keywordtype">void</span> insertHuffmanTables(<span class="keywordtype">int</span> position) {</div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;      <span class="comment">// IJ.log(&quot;inserting Huffman tables&quot;);</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;      System.arraycopy(buffer, position, buffer, position + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a>, bufferLength - position);</div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;      System.arraycopy(<a class="code" href="classthird___party_1_1_a_v_i___reader.html#aad6e7cb0d09711ad82ecf6fe3defab69">HUFFMAN_TABLES</a>, 0, buffer, position, <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a>);</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;      bufferLength += <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a>;</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      readableSize += <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a>;</div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;    }</div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;</div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    <span class="comment">// Read methods:</span></div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;    <span class="comment">// There is no check against reading beyond the allowed range, which is</span></div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    <span class="comment">// start position + readableSize</span></div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="comment">// (i.e., reading beyond the frame in the avi file would be possible).</span></div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;<span class="comment"></span>    <span class="keyword">public</span> <span class="keywordtype">int</span> read() <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;      readableSize--;</div><div class="line"><a name="l00216"></a><span class="lineno">  216</span>&#160;      <span class="keywordflow">if</span> (fixMJPG) {</div><div class="line"><a name="l00217"></a><span class="lineno">  217</span>&#160;        <span class="keywordtype">int</span> result = buffer[bufferPointer] &amp; 0xff;</div><div class="line"><a name="l00218"></a><span class="lineno">  218</span>&#160;        bufferPointer++;</div><div class="line"><a name="l00219"></a><span class="lineno">  219</span>&#160;        <span class="keywordflow">if</span> (bufferPointer &gt;= bufferLength)</div><div class="line"><a name="l00220"></a><span class="lineno">  220</span>&#160;          fixMJPG = <span class="keyword">false</span>; <span class="comment">// buffer exhausted, no more attempt to fix it</span></div><div class="line"><a name="l00221"></a><span class="lineno">  221</span>&#160;        <span class="keywordflow">return</span> result;</div><div class="line"><a name="l00222"></a><span class="lineno">  222</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l00223"></a><span class="lineno">  223</span>&#160;        <span class="keywordflow">return</span> rFile.read();</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;    }</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;</div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keyword">public</span> <span class="keywordtype">int</span> read(byte[] b, <span class="keywordtype">int</span> off, <span class="keywordtype">int</span> len) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;      <span class="comment">// IJ.log(&quot;read &quot;+len+&quot; bytes, fix=&quot;+fixMJPG);</span></div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;      <span class="keywordtype">int</span> nBytes;</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;      <span class="keywordflow">if</span> (fixMJPG) {</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;        nBytes = Math.min(len, bufferLength - bufferPointer);</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;        System.arraycopy(buffer, bufferPointer, b, off, nBytes);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;        bufferPointer += nBytes;</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;        <span class="keywordflow">if</span> (bufferPointer &gt;= bufferLength) {</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;          fixMJPG = <span class="keyword">false</span>;</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;          <span class="keywordflow">if</span> (len - nBytes &gt; 0)</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;            nBytes += rFile.read(b, off + nBytes, len - nBytes);</div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;        }</div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      } <span class="keywordflow">else</span></div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        nBytes = rFile.read(b, off, len);</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      readableSize -= nBytes;</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;      <span class="keywordflow">return</span> nBytes;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;    }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="comment">// read a short from the buffer</span></div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;    <span class="keyword">private</span> <span class="keywordtype">int</span> readShort(<span class="keywordtype">int</span> offset) {</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;      <span class="keywordflow">return</span> ((buffer[offset] &amp; 0xff) &lt;&lt; 8) | (buffer[offset + 1] &amp; 0xff);</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;    }</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;  }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  <span class="comment">// four-character codes for avi chunk types</span></div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;  <span class="comment">// NOTE: byte sequence is reversed - ints in Intel (little endian) byte</span></div><div class="line"><a name="l00253"></a><span class="lineno">  253</span>&#160;  <span class="comment">// order!</span></div><div class="line"><a name="l00254"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a940c57c06ee865b01eba1b36ccd87817">  254</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a940c57c06ee865b01eba1b36ccd87817">FOURCC_RIFF</a> = 0x46464952; <span class="comment">// &#39;RIFF&#39;</span></div><div class="line"><a name="l00255"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a06edff2c6566087d15d8cf7bd653da74">  255</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a06edff2c6566087d15d8cf7bd653da74">FOURCC_AVI</a> = 0x20495641; <span class="comment">// &#39;AVI &#39;</span></div><div class="line"><a name="l00256"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#afafd9f635c9ae45059288714c17b2daa">  256</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afafd9f635c9ae45059288714c17b2daa">FOURCC_AVIX</a> = 0x58495641; <span class="comment">// &#39;AVIX&#39; // extended AVI</span></div><div class="line"><a name="l00257"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad9521d7c6e8c59f4a5ee43a9de2b9865">  257</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad9521d7c6e8c59f4a5ee43a9de2b9865">FOURCC_ix00</a> = 0x30307869; <span class="comment">// &#39;ix00&#39; // index within</span></div><div class="line"><a name="l00258"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a41caf5016716a9db732d16f7f7cfeaad">  258</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a41caf5016716a9db732d16f7f7cfeaad">FOURCC_indx</a> = 0x78646e69; <span class="comment">// &#39;indx&#39; // main index</span></div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a66745b6dd14a2d5a3540fe40108e6c57">  259</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a66745b6dd14a2d5a3540fe40108e6c57">FOURCC_idx1</a> = 0x31786469; <span class="comment">// &#39;idx1&#39; // index of</span></div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;                                                     <span class="comment">// single &#39;movi&#39; block</span></div><div class="line"><a name="l00261"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa9e91f666aee5aaa5e4e8de3a8a0d04c">  261</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa9e91f666aee5aaa5e4e8de3a8a0d04c">FOURCC_LIST</a> = 0x5453494c; <span class="comment">// &#39;LIST&#39;</span></div><div class="line"><a name="l00262"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8dffa6826007ce508024f79583167472">  262</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8dffa6826007ce508024f79583167472">FOURCC_hdrl</a> = 0x6c726468; <span class="comment">// &#39;hdrl&#39;</span></div><div class="line"><a name="l00263"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7e97ef03c7c523da98768584afc88d78">  263</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7e97ef03c7c523da98768584afc88d78">FOURCC_avih</a> = 0x68697661; <span class="comment">// &#39;avih&#39;</span></div><div class="line"><a name="l00264"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abae261f54bdef65ceb5328e248922c17">  264</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abae261f54bdef65ceb5328e248922c17">FOURCC_strl</a> = 0x6c727473; <span class="comment">// &#39;strl&#39;</span></div><div class="line"><a name="l00265"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a169633f81044867d9ac16d556f878916">  265</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a169633f81044867d9ac16d556f878916">FOURCC_strh</a> = 0x68727473; <span class="comment">// &#39;strh&#39;</span></div><div class="line"><a name="l00266"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a9ea7f652ebad5fd64eaf7510593099ca">  266</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a9ea7f652ebad5fd64eaf7510593099ca">FOURCC_strf</a> = 0x66727473; <span class="comment">// &#39;strf&#39;</span></div><div class="line"><a name="l00267"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae17659bc83a5a05ced0bb379c8fbfd19">  267</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae17659bc83a5a05ced0bb379c8fbfd19">FOURCC_movi</a> = 0x69766f6d; <span class="comment">// &#39;movi&#39;</span></div><div class="line"><a name="l00268"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a6232c065caed00248e86b52888e9b752">  268</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6232c065caed00248e86b52888e9b752">FOURCC_rec</a> = 0x20636572; <span class="comment">// &#39;rec &#39;</span></div><div class="line"><a name="l00269"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#adf0ed21b252fa1d8aee518d97c43509b">  269</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#adf0ed21b252fa1d8aee518d97c43509b">FOURCC_JUNK</a> = 0x4b4e554a; <span class="comment">// &#39;JUNK&#39;</span></div><div class="line"><a name="l00270"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a79325bbe63915f151cb0a6dc44bf0425">  270</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a79325bbe63915f151cb0a6dc44bf0425">FOURCC_vids</a> = 0x73646976; <span class="comment">// &#39;vids&#39;</span></div><div class="line"><a name="l00271"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0f7f2e01806b2d5f10b90b7af43a2c5d">  271</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0f7f2e01806b2d5f10b90b7af43a2c5d">FOURCC_00db</a> = 0x62643030; <span class="comment">// &#39;00db&#39;</span></div><div class="line"><a name="l00272"></a><span class="lineno">  272</span>&#160;</div><div class="line"><a name="l00273"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a85598e264b22ea229afe9e0d9a5bc968">  273</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a85598e264b22ea229afe9e0d9a5bc968">FOURCC_00dc</a> = 0x63643030; <span class="comment">// &#39;00dc&#39;</span></div><div class="line"><a name="l00274"></a><span class="lineno">  274</span>&#160;  <span class="comment">// four-character codes for supported compression formats; see fourcc.org</span></div><div class="line"><a name="l00275"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">  275</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">NO_COMPRESSION</a> = 0; <span class="comment">// uncompressed, also &#39;RGB &#39;,</span></div><div class="line"><a name="l00276"></a><span class="lineno">  276</span>&#160;                                               <span class="comment">// &#39;RAW &#39;</span></div><div class="line"><a name="l00277"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#adddcf5a0e55227976c71d5fd5916b0a5">  277</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#adddcf5a0e55227976c71d5fd5916b0a5">NO_COMPRESSION_RGB</a> = 0x20424752; <span class="comment">// &#39;RGB &#39; -a name</span></div><div class="line"><a name="l00278"></a><span class="lineno">  278</span>&#160;                                                            <span class="comment">// for uncompressed</span></div><div class="line"><a name="l00279"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a18ff7da5dccb4c6607f2dc5068f2cbee">  279</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a18ff7da5dccb4c6607f2dc5068f2cbee">NO_COMPRESSION_RAW</a> = 0x20574152; <span class="comment">// &#39;RAW &#39; -a name</span></div><div class="line"><a name="l00280"></a><span class="lineno">  280</span>&#160;                                                            <span class="comment">// for uncompressed</span></div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aff28fa92f59b85a19c8d53b6fcabe69e">  281</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff28fa92f59b85a19c8d53b6fcabe69e">NO_COMPRESSION_Y800</a> = 0x30303859;<span class="comment">// &#39;Y800&#39; -a name</span></div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;                                                            <span class="comment">// for 8-bit</span></div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;                                                            <span class="comment">// grayscale</span></div><div class="line"><a name="l00284"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a3789f5d56eb31a9779e684c7deb6ee3a">  284</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3789f5d56eb31a9779e684c7deb6ee3a">NO_COMPRESSION_Y8</a> = 0x20203859; <span class="comment">// &#39;Y8 &#39; -another</span></div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;                                                           <span class="comment">// name for Y800</span></div><div class="line"><a name="l00286"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aec1d39b5f017b81e865a3e77708d06af">  286</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aec1d39b5f017b81e865a3e77708d06af">NO_COMPRESSION_GREY</a> = 0x59455247;<span class="comment">// &#39;GREY&#39; -another</span></div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;                                                            <span class="comment">// name for Y800</span></div><div class="line"><a name="l00288"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#adb6767b5b747f411aa4b70fe8f9e8994">  288</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#adb6767b5b747f411aa4b70fe8f9e8994">NO_COMPRESSION_Y16</a> = 0x20363159; <span class="comment">// &#39;Y16 &#39; -a name</span></div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;                                                            <span class="comment">// for 16-bit</span></div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;                                                            <span class="comment">// uncompressed</span></div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;                                                            <span class="comment">// grayscale</span></div><div class="line"><a name="l00292"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a16f7685800fae0997023bdb905c94d72">  292</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a16f7685800fae0997023bdb905c94d72">NO_COMPRESSION_MIL</a> = 0x204c494d; <span class="comment">// &#39;MIL &#39; - Matrox</span></div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;                                                            <span class="comment">// Imaging Library</span></div><div class="line"><a name="l00294"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0416d25470c685f6657b2a6b1f25e48c">  294</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0416d25470c685f6657b2a6b1f25e48c">AYUV_COMPRESSION</a> = 0x56555941; <span class="comment">// &#39;AYUV&#39;</span></div><div class="line"><a name="l00295"></a><span class="lineno">  295</span>&#160;                                                          <span class="comment">// -uncompressed, but</span></div><div class="line"><a name="l00296"></a><span class="lineno">  296</span>&#160;                                                          <span class="comment">// alpha, Y, U, V</span></div><div class="line"><a name="l00297"></a><span class="lineno">  297</span>&#160;                                                          <span class="comment">// bytes</span></div><div class="line"><a name="l00298"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#afee2b0fe721d4be2e5d6edec9eef0e09">  298</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afee2b0fe721d4be2e5d6edec9eef0e09">UYVY_COMPRESSION</a> = 0x59565955; <span class="comment">// &#39;UYVY&#39; - 4:2:2</span></div><div class="line"><a name="l00299"></a><span class="lineno">  299</span>&#160;                                                          <span class="comment">// with byte order u</span></div><div class="line"><a name="l00300"></a><span class="lineno">  300</span>&#160;                                                          <span class="comment">// y0 v y1</span></div><div class="line"><a name="l00301"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a482297bdb9a884d5820d1342f0e13d8a">  301</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a482297bdb9a884d5820d1342f0e13d8a">Y422_COMPRESSION</a> = 0x564E5955; <span class="comment">// &#39;Y422&#39; -another</span></div><div class="line"><a name="l00302"></a><span class="lineno">  302</span>&#160;                                                          <span class="comment">// name for of UYVY</span></div><div class="line"><a name="l00303"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aefc30707c2f9e4d9294f23590613584e">  303</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aefc30707c2f9e4d9294f23590613584e">UYNV_COMPRESSION</a> = 0x32323459; <span class="comment">// &#39;UYNV&#39; -another</span></div><div class="line"><a name="l00304"></a><span class="lineno">  304</span>&#160;                                                          <span class="comment">// name for of UYVY</span></div><div class="line"><a name="l00305"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a54eb6f808c5b9eee02976314a451dcad">  305</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a54eb6f808c5b9eee02976314a451dcad">CYUV_COMPRESSION</a> = 0x76757963; <span class="comment">// &#39;cyuv&#39; -as UYVY</span></div><div class="line"><a name="l00306"></a><span class="lineno">  306</span>&#160;                                                          <span class="comment">// but not top-down</span></div><div class="line"><a name="l00307"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a73bf03f3e7d7151d897dc4686668678c">  307</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a73bf03f3e7d7151d897dc4686668678c">V422_COMPRESSION</a> = 0x32323456; <span class="comment">// &#39;V422&#39; -as UYVY</span></div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;                                                          <span class="comment">// but not top-down</span></div><div class="line"><a name="l00309"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#acf3deb2ecb0e067f80f2dc6a2f34f010">  309</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#acf3deb2ecb0e067f80f2dc6a2f34f010">YUY2_COMPRESSION</a> = 0x32595559; <span class="comment">// &#39;YUY2&#39; - 4:2:2</span></div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;                                                          <span class="comment">// with byte order y0</span></div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;                                                          <span class="comment">// u y1 v</span></div><div class="line"><a name="l00312"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a23c19fb8474ea86b45cfa13fe4dd16dd">  312</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a23c19fb8474ea86b45cfa13fe4dd16dd">YUNV_COMPRESSION</a> = 0x564E5559; <span class="comment">// &#39;YUNV&#39; -another</span></div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;                                                          <span class="comment">// name for YUY2</span></div><div class="line"><a name="l00314"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a192aaa41f285d424c462e29ef7f6e87e">  314</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a192aaa41f285d424c462e29ef7f6e87e">YUYV_COMPRESSION</a> = 0x56595559; <span class="comment">// &#39;YUYV&#39; -another</span></div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;                                                          <span class="comment">// name for YUY2</span></div><div class="line"><a name="l00316"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a61f851865cb3fb2ac79662c76f75d1e1">  316</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a61f851865cb3fb2ac79662c76f75d1e1">YVYU_COMPRESSION</a> = 0x55595659; <span class="comment">// &#39;YVYU&#39; - 4:2:2</span></div><div class="line"><a name="l00317"></a><span class="lineno">  317</span>&#160;                                                          <span class="comment">// with byte order y0</span></div><div class="line"><a name="l00318"></a><span class="lineno">  318</span>&#160;                                                          <span class="comment">// u y1 v</span></div><div class="line"><a name="l00319"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a6e950b01e3308a25915da47063657900">  319</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e950b01e3308a25915da47063657900">JPEG_COMPRESSION</a> = 0x6765706a; <span class="comment">// &#39;jpeg&#39; JPEG</span></div><div class="line"><a name="l00320"></a><span class="lineno">  320</span>&#160;                                                          <span class="comment">// compression of</span></div><div class="line"><a name="l00321"></a><span class="lineno">  321</span>&#160;                                                          <span class="comment">// individual frames</span></div><div class="line"><a name="l00322"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a38fa9e3cad9c0a5a7df0ddd3d11aad0e">  322</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a38fa9e3cad9c0a5a7df0ddd3d11aad0e">JPEG_COMPRESSION2</a> = 0x4745504a; <span class="comment">// &#39;JPEG&#39; JPEG</span></div><div class="line"><a name="l00323"></a><span class="lineno">  323</span>&#160;                                                           <span class="comment">// compression of</span></div><div class="line"><a name="l00324"></a><span class="lineno">  324</span>&#160;                                                           <span class="comment">// individual frames</span></div><div class="line"><a name="l00325"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a2a2f40a58431f6f38931303068eb2816">  325</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2a2f40a58431f6f38931303068eb2816">JPEG_COMPRESSION3</a> = 0x04; <span class="comment">// BI_JPEG: JPEG</span></div><div class="line"><a name="l00326"></a><span class="lineno">  326</span>&#160;                                                     <span class="comment">// compression of</span></div><div class="line"><a name="l00327"></a><span class="lineno">  327</span>&#160;                                                     <span class="comment">// individual frames</span></div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0339593a5d0faed6f1da7d41a631bbfa">  328</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0339593a5d0faed6f1da7d41a631bbfa">MJPG_COMPRESSION</a> = 0x47504a4d; <span class="comment">// &#39;MJPG&#39; Motion</span></div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;                                                          <span class="comment">// JPEG, also reads</span></div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;                                                          <span class="comment">// compression of</span></div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;                                                          <span class="comment">// individual frames</span></div><div class="line"><a name="l00332"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a35f0e3b79e23892ab4cf6b8e2628bef7">  332</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a35f0e3b79e23892ab4cf6b8e2628bef7">PNG_COMPRESSION</a> = 0x20676e70; <span class="comment">// &#39;png &#39; PNG</span></div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;                                                         <span class="comment">// compression of</span></div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;                                                         <span class="comment">// individual frames</span></div><div class="line"><a name="l00335"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a317f840efd0048699567082757a29245">  335</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a317f840efd0048699567082757a29245">PNG_COMPRESSION2</a> = 0x20474e50; <span class="comment">// &#39;PNG &#39; PNG</span></div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;                                                          <span class="comment">// compression of</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;                                                          <span class="comment">// individual frames</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;</div><div class="line"><a name="l00339"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aac533bfe76b36f0fb97cf2b737483911">  339</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aac533bfe76b36f0fb97cf2b737483911">PNG_COMPRESSION3</a> = 0x05; <span class="comment">// BI_PNG PNG compression</span></div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;                                                    <span class="comment">// of individual frames</span></div><div class="line"><a name="l00341"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a060fa4dce1c907b733737ef07d44ceca">  341</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060fa4dce1c907b733737ef07d44ceca">BITMASK24</a> = 0x10000; <span class="comment">// for 24-bit (in contrast to</span></div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;                                                <span class="comment">// 8, 16,... not a bitmask)</span></div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;</div><div class="line"><a name="l00344"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">  344</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a> = 0xffffffffL; <span class="comment">// for conversion of sizes</span></div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;                                                     <span class="comment">// from unsigned int to</span></div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;                                                     <span class="comment">// long</span></div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;  <span class="comment">// flags from AVI chunk header</span></div><div class="line"><a name="l00348"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abdad34900c6c58013d7d982d29b4575b">  348</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abdad34900c6c58013d7d982d29b4575b">AVIF_HASINDEX</a> = 0x00000010; <span class="comment">// Index at end of file?</span></div><div class="line"><a name="l00349"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#af6db5b310a46bfa10d55b88219caf652">  349</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#af6db5b310a46bfa10d55b88219caf652">AVIF_MUSTUSEINDEX</a> = 0x00000020; <span class="comment">// ignored by this</span></div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;                                                           <span class="comment">// plugin</span></div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;</div><div class="line"><a name="l00352"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a00c56445525fd1e21ef004a496ac4b40">  352</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a00c56445525fd1e21ef004a496ac4b40">AVIF_ISINTERLEAVED</a> = 0x00000100; <span class="comment">// ignored by this</span></div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;                                                            <span class="comment">// plugin</span></div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;  <span class="comment">// constants used to read &#39;AVI 2&#39; index chunks (others than those defined</span></div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  <span class="comment">// here are not supported)</span></div><div class="line"><a name="l00356"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a889770167a698f8bfa91ee66947af086">  356</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> byte <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a889770167a698f8bfa91ee66947af086">AVI_INDEX_OF_CHUNKS</a> = 0x01; <span class="comment">// index of frames</span></div><div class="line"><a name="l00357"></a><span class="lineno">  357</span>&#160;</div><div class="line"><a name="l00358"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa5be394b26e7e3ab6e590ce7d455a05b">  358</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">final</span> <span class="keyword">static</span> byte <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa5be394b26e7e3ab6e590ce7d455a05b">AVI_INDEX_OF_INDEXES</a> = 0x00; <span class="comment">// main indx pointing</span></div><div class="line"><a name="l00359"></a><span class="lineno">  359</span>&#160;                                                         <span class="comment">// to ix00 etc</span></div><div class="line"><a name="l00360"></a><span class="lineno">  360</span>&#160;                                                         <span class="comment">// subindices</span></div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  <span class="comment">// static versions of dialog parameters that will be remembered</span></div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a1c9b6b612edba7d066f7385771c15613">  362</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1c9b6b612edba7d066f7385771c15613">staticConvertToGray</a>;</div><div class="line"><a name="l00363"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abf21677829232d48cb9bc1efcdfd1557">  363</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf21677829232d48cb9bc1efcdfd1557">staticFlipVertical</a>;</div><div class="line"><a name="l00364"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4d27bb277c107c931e0f80ce7947f5ea">  364</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4d27bb277c107c931e0f80ce7947f5ea">staticIsVirtual</a>;</div><div class="line"><a name="l00370"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a2ae593bd5a753069baf4f052e4436ff6">  370</a></span>&#160;  <span class="keyword">final</span> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2ae593bd5a753069baf4f052e4436ff6">BUFFERSIZE</a> = 4096; <span class="comment">// should be large enough to hold</span></div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;                                              <span class="comment">// the full JFIF header</span></div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;  <span class="comment">// up to beginning of the image data and the Huffman tables</span></div><div class="line"><a name="l00373"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aad6e7cb0d09711ad82ecf6fe3defab69">  373</a></span>&#160;  <span class="keyword">final</span> <span class="keyword">private</span> <span class="keyword">static</span> byte[] <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aad6e7cb0d09711ad82ecf6fe3defab69">HUFFMAN_TABLES</a> = <span class="keyword">new</span> byte[] { <span class="comment">// the &#39;DHT&#39;</span></div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;                                                            <span class="comment">// segment</span></div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;      (byte) 0xFF, (byte) 0xC4, 0x01, (byte) 0xA2, <span class="comment">// these 4 bytes are tag &amp;</span></div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;                                                   <span class="comment">// length; data follow</span></div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;      0x00, 0x00, 0x01, 0x05, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01,</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;      0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A, 0x0B, 0x01, 0x00, 0x03, 0x01, 0x01, 0x01, 0x01, 0x01, 0x01,</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;      0x01, 0x01, 0x01, 0x00, 0x00, 0x00, 0x00, 0x00, 0x00, 0x01, 0x02, 0x03, 0x04, 0x05, 0x06, 0x07, 0x08, 0x09, 0x0A,</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;      0x0B, 0x10, 0x00, 0x02, 0x01, 0x03, 0x03, 0x02, 0x04, 0x03, 0x05, 0x05, 0x04, 0x04, 0x00, 0x00, 0x01, 0x7D, 0x01,</div><div class="line"><a name="l00381"></a><span class="lineno">  381</span>&#160;      0x02, 0x03, 0x00, 0x04, 0x11, 0x05, 0x12, 0x21, 0x31, 0x41, 0x06, 0x13, 0x51, 0x61, 0x07, 0x22, 0x71, 0x14, 0x32,</div><div class="line"><a name="l00382"></a><span class="lineno">  382</span>&#160;      (byte) 0x81, (byte) 0x91, (byte) 0xA1, 0x08, 0x23, 0x42, (byte) 0xB1, (byte) 0xC1, 0x15, 0x52, (byte) 0xD1,</div><div class="line"><a name="l00383"></a><span class="lineno">  383</span>&#160;      (byte) 0xF0, 0x24, 0x33, 0x62, 0x72, (byte) 0x82, 0x09, 0x0A, 0x16, 0x17, 0x18, 0x19, 0x1A, 0x25, 0x26, 0x27,</div><div class="line"><a name="l00384"></a><span class="lineno">  384</span>&#160;      0x28, 0x29, 0x2A, 0x34, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x43, 0x44, 0x45, 0x46, 0x47, 0x48, 0x49, 0x4A, 0x53,</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;      0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69, 0x6A, 0x73, 0x74, 0x75, 0x76,</div><div class="line"><a name="l00386"></a><span class="lineno">  386</span>&#160;      0x77, 0x78, 0x79, 0x7A, (byte) 0x83, (byte) 0x84, (byte) 0x85, (byte) 0x86, (byte) 0x87, (byte) 0x88, (byte) 0x89,</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;      (byte) 0x8A, (byte) 0x92, (byte) 0x93, (byte) 0x94, (byte) 0x95, (byte) 0x96, (byte) 0x97, (byte) 0x98,</div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;      (byte) 0x99, (byte) 0x9A, (byte) 0xA2, (byte) 0xA3, (byte) 0xA4, (byte) 0xA5, (byte) 0xA6, (byte) 0xA7,</div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;      (byte) 0xA8, (byte) 0xA9, (byte) 0xAA, (byte) 0xB2, (byte) 0xB3, (byte) 0xB4, (byte) 0xB5, (byte) 0xB6,</div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;      (byte) 0xB7, (byte) 0xB8, (byte) 0xB9, (byte) 0xBA, (byte) 0xC2, (byte) 0xC3, (byte) 0xC4, (byte) 0xC5,</div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;      (byte) 0xC6, (byte) 0xC7, (byte) 0xC8, (byte) 0xC9, (byte) 0xCA, (byte) 0xD2, (byte) 0xD3, (byte) 0xD4,</div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;      (byte) 0xD5, (byte) 0xD6, (byte) 0xD7, (byte) 0xD8, (byte) 0xD9, (byte) 0xDA, (byte) 0xE1, (byte) 0xE2,</div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;      (byte) 0xE3, (byte) 0xE4, (byte) 0xE5, (byte) 0xE6, (byte) 0xE7, (byte) 0xE8, (byte) 0xE9, (byte) 0xEA,</div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;      (byte) 0xF1, (byte) 0xF2, (byte) 0xF3, (byte) 0xF4, (byte) 0xF5, (byte) 0xF6, (byte) 0xF7, (byte) 0xF8,</div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;      (byte) 0xF9, (byte) 0xFA, 0x11, 0x00, 0x02, 0x01, 0x02, 0x04, 0x04, 0x03, 0x04, 0x07, 0x05, 0x04, 0x04, 0x00,</div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;      0x01, 0x02, 0x77, 0x00, 0x01, 0x02, 0x03, 0x11, 0x04, 0x05, 0x21, 0x31, 0x06, 0x12, 0x41, 0x51, 0x07, 0x61, 0x71,</div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;      0x13, 0x22, 0x32, (byte) 0x81, 0x08, 0x14, 0x42, (byte) 0x91, (byte) 0xA1, (byte) 0xB1, (byte) 0xC1, 0x09, 0x23,</div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;      0x33, 0x52, (byte) 0xF0, 0x15, 0x62, 0x72, (byte) 0xD1, 0x0A, 0x16, 0x24, 0x34, (byte) 0xE1, 0x25, (byte) 0xF1,</div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;      0x17, 0x18, 0x19, 0x1A, 0x26, 0x27, 0x28, 0x29, 0x2A, 0x35, 0x36, 0x37, 0x38, 0x39, 0x3A, 0x43, 0x44, 0x45, 0x46,</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;      0x47, 0x48, 0x49, 0x4A, 0x53, 0x54, 0x55, 0x56, 0x57, 0x58, 0x59, 0x5A, 0x63, 0x64, 0x65, 0x66, 0x67, 0x68, 0x69,</div><div class="line"><a name="l00401"></a><span class="lineno">  401</span>&#160;      0x6A, 0x73, 0x74, 0x75, 0x76, 0x77, 0x78, 0x79, 0x7A, (byte) 0x82, (byte) 0x83, (byte) 0x84, (byte) 0x85,</div><div class="line"><a name="l00402"></a><span class="lineno">  402</span>&#160;      (byte) 0x86, (byte) 0x87, (byte) 0x88, (byte) 0x89, (byte) 0x8A, (byte) 0x92, (byte) 0x93, (byte) 0x94,</div><div class="line"><a name="l00403"></a><span class="lineno">  403</span>&#160;      (byte) 0x95, (byte) 0x96, (byte) 0x97, (byte) 0x98, (byte) 0x99, (byte) 0x9A, (byte) 0xA2, (byte) 0xA3,</div><div class="line"><a name="l00404"></a><span class="lineno">  404</span>&#160;      (byte) 0xA4, (byte) 0xA5, (byte) 0xA6, (byte) 0xA7, (byte) 0xA8, (byte) 0xA9, (byte) 0xAA, (byte) 0xB2,</div><div class="line"><a name="l00405"></a><span class="lineno">  405</span>&#160;      (byte) 0xB3, (byte) 0xB4, (byte) 0xB5, (byte) 0xB6, (byte) 0xB7, (byte) 0xB8, (byte) 0xB9, (byte) 0xBA,</div><div class="line"><a name="l00406"></a><span class="lineno">  406</span>&#160;      (byte) 0xC2, (byte) 0xC3, (byte) 0xC4, (byte) 0xC5, (byte) 0xC6, (byte) 0xC7, (byte) 0xC8, (byte) 0xC9,</div><div class="line"><a name="l00407"></a><span class="lineno">  407</span>&#160;      (byte) 0xCA, (byte) 0xD2, (byte) 0xD3, (byte) 0xD4, (byte) 0xD5, (byte) 0xD6, (byte) 0xD7, (byte) 0xD8,</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;      (byte) 0xD9, (byte) 0xDA, (byte) 0xE2, (byte) 0xE3, (byte) 0xE4, (byte) 0xE5, (byte) 0xE6, (byte) 0xE7,</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      (byte) 0xE8, (byte) 0xE9, (byte) 0xEA, (byte) 0xF2, (byte) 0xF3, (byte) 0xF4, (byte) 0xF5, (byte) 0xF6,</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;      (byte) 0xF7, (byte) 0xF8, (byte) 0xF9, (byte) 0xFA };</div><div class="line"><a name="l00411"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">  411</a></span>&#160;  <span class="keyword">final</span> <span class="keyword">private</span> <span class="keyword">static</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">HUFFMAN_LENGTH</a> = 420;</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;  <span class="comment">// dialog parameters</span></div><div class="line"><a name="l00413"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ac3215b5ca71c819b5596da8de72d1c51">  413</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac3215b5ca71c819b5596da8de72d1c51">firstFrame</a> = 1; <span class="comment">// the first frame to read</span></div><div class="line"><a name="l00414"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">  414</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">lastFrame</a> = -1; <span class="comment">// the last frame to read; 0 means &#39;read all&#39;</span></div><div class="line"><a name="l00415"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4ed3ed255ad8de9543bc052fdf79c1bf">  415</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4ed3ed255ad8de9543bc052fdf79c1bf">convertToGray</a> = <span class="keyword">false</span>; <span class="comment">// whether to convert color video to</span></div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;                                         <span class="comment">// grayscale</span></div><div class="line"><a name="l00417"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#af80522b94aad967163e1c1f632ccae18">  417</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#af80522b94aad967163e1c1f632ccae18">flipVertical</a> = <span class="keyword">false</span>; <span class="comment">// whether to flip image vertical</span></div><div class="line"><a name="l00418"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7a2de66ab228979ef527d69ef6f715d8">  418</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7a2de66ab228979ef527d69ef6f715d8">isVirtual</a> = <span class="keyword">false</span>; <span class="comment">// whether to open as virtual stack</span></div><div class="line"><a name="l00419"></a><span class="lineno">  419</span>&#160;  <span class="comment">// the input file</span></div><div class="line"><a name="l00420"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8618c6504f71d01eaf20a48c933aa036">  420</a></span>&#160;  <span class="keyword">private</span> RandomAccessFile <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8618c6504f71d01eaf20a48c933aa036">raFile</a>;</div><div class="line"><a name="l00421"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae622bf22747273cf481d814dfa90eb6f">  421</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae622bf22747273cf481d814dfa90eb6f">raFilePath</a>;</div><div class="line"><a name="l00422"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a68aadbc95be2cc904f2ad270a6c1a294">  422</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a68aadbc95be2cc904f2ad270a6c1a294">headerOK</a> = <span class="keyword">false</span>; <span class="comment">// whether header has been read</span></div><div class="line"><a name="l00423"></a><span class="lineno">  423</span>&#160;  <span class="comment">// more avi file properties etc</span></div><div class="line"><a name="l00424"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa13826806384d5f2ba71ef4b285ff94f">  424</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa13826806384d5f2ba71ef4b285ff94f">streamNumber</a>; <span class="comment">// number of the (first) video stream</span></div><div class="line"><a name="l00425"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad6257fda79573f030a67ca47eecc1fba">  425</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad6257fda79573f030a67ca47eecc1fba">type0xdb</a>, type0xdc; <span class="comment">// video stream chunks must have one of these</span></div><div class="line"><a name="l00426"></a><span class="lineno">  426</span>&#160;                                  <span class="comment">// two types (e.g. &#39;00db&#39; for straem 0)</span></div><div class="line"><a name="l00427"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8c2b5b20326297322c3386972e2df424">  427</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8c2b5b20326297322c3386972e2df424">fileSize</a>; <span class="comment">// file size</span></div><div class="line"><a name="l00428"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ada09a7124313fca7fec5b0d7b8eab470">  428</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ada09a7124313fca7fec5b0d7b8eab470">aviSize</a>; <span class="comment">// size of &#39;AVI&#39; chunk</span></div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a1219695073e216806175234ee03f49b9">  429</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1219695073e216806175234ee03f49b9">headerPositionEnd</a>; <span class="comment">// &#39;movi&#39; will start somewhere here</span></div><div class="line"><a name="l00430"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae73329845c623f6ec46c0d2015232711">  430</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae73329845c623f6ec46c0d2015232711">indexPosition</a>; <span class="comment">// position of the main index (indx)</span></div><div class="line"><a name="l00431"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0272cce922406183d9d5ac381e78908b">  431</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0272cce922406183d9d5ac381e78908b">indexPositionEnd</a>; <span class="comment">// indx seek end</span></div><div class="line"><a name="l00432"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abcd92cbd1dcb6a276e2917ab5cd8f4bd">  432</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abcd92cbd1dcb6a276e2917ab5cd8f4bd">moviPosition</a>; <span class="comment">// position of &#39;movi&#39; list</span></div><div class="line"><a name="l00433"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ab5eedec5cfca724a1ae285acde216554">  433</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ab5eedec5cfca724a1ae285acde216554">paddingGranularity</a> = 2; <span class="comment">// tags start at even address</span></div><div class="line"><a name="l00434"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ac3f9afd4034b5c3e012207318a5256e5">  434</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac3f9afd4034b5c3e012207318a5256e5">frameNumber</a> = 1; <span class="comment">// frame currently read; global because</span></div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;                               <span class="comment">// distributed over 1st AVi and further RIFF</span></div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;                               <span class="comment">// AVIX chunks</span></div><div class="line"><a name="l00437"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7c06c634e54b80462f7a61b91ba2bfc0">  437</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7c06c634e54b80462f7a61b91ba2bfc0">lastFrameToRead</a> = Integer.MAX_VALUE;</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa71c4bd35a9fe20e158956bd2cb25b28">  438</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa71c4bd35a9fe20e158956bd2cb25b28">totalFramesFromIndex</a>;<span class="comment">// number of frames from &#39;AVI 2.0&#39; indices</span></div><div class="line"><a name="l00439"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ab646837fe76c95f4e50b41ce2a32cf54">  439</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ab646837fe76c95f4e50b41ce2a32cf54">indexForCountingOnly</a>;<span class="comment">// don&#39;t read the index, only count int</span></div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;                                       <span class="comment">// totalFramesFromIndex how many entries</span></div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;  <span class="comment">// derived from BitMapInfo</span></div><div class="line"><a name="l00442"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a2162fee9234157ca1547716e83a26f37">  442</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2162fee9234157ca1547716e83a26f37">dataCompression</a>; <span class="comment">// data compression type used</span></div><div class="line"><a name="l00443"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a270bcae68f2d35537d6eb66edce16058">  443</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a270bcae68f2d35537d6eb66edce16058">scanLineSize</a>;</div><div class="line"><a name="l00444"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a5ee060949ab9bce8c73729050bc737a2">  444</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a5ee060949ab9bce8c73729050bc737a2">dataTopDown</a>; <span class="comment">// whether data start at top of image</span></div><div class="line"><a name="l00445"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a2b73f21f7624cabb5866d7f4efb510ae">  445</a></span>&#160;  <span class="keyword">private</span> ColorModel <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2b73f21f7624cabb5866d7f4efb510ae">cm</a>;</div><div class="line"><a name="l00446"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae22b1bffcf28d81d7416e1393ef6a5e3">  446</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae22b1bffcf28d81d7416e1393ef6a5e3">variableLength</a>; <span class="comment">// compressed (PNG, JPEG) frames have</span></div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;                                  <span class="comment">// variable length</span></div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;  <span class="comment">// for conversion to ImageJ stack</span></div><div class="line"><a name="l00449"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a35aefea5caf4ac524e96bd3aaf72e589">  449</a></span>&#160;  <span class="keyword">private</span> Vector <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a35aefea5caf4ac524e96bd3aaf72e589">frameInfos</a>; <span class="comment">// for virtual stack: long[] with frame pos&amp;size</span></div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;                             <span class="comment">// in file, time(usec)</span></div><div class="line"><a name="l00451"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a3718d0e6f5e4617dcc81a8e481361c7e">  451</a></span>&#160;  <span class="keyword">private</span> ImageStack <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3718d0e6f5e4617dcc81a8e481361c7e">stack</a>;</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;</div><div class="line"><a name="l00453"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad2278f058a9bb4421b37747cf5c5bd32">  453</a></span>&#160;  <span class="keyword">private</span> ImagePlus <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad2278f058a9bb4421b37747cf5c5bd32">imp</a>;</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;  <span class="comment">// for debug messages and error handling</span></div><div class="line"><a name="l00455"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4fb4207960d5de1c5dfab8e085517e49">  455</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4fb4207960d5de1c5dfab8e085517e49">verbose</a> = IJ.debugMode;</div><div class="line"><a name="l00456"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae51c21e096fc7d3c16c4b098e8772b50">  456</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae51c21e096fc7d3c16c4b098e8772b50">startTime</a>;</div><div class="line"><a name="l00457"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a1d0790ceb95e12b7cbca6a0a0958ce83">  457</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1d0790ceb95e12b7cbca6a0a0958ce83">aborting</a>;</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;  <span class="comment">// From AVI Header Chunk</span></div><div class="line"><a name="l00459"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a226b0a1d6946d4295dd0f0472f0ee378">  459</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a226b0a1d6946d4295dd0f0472f0ee378">dwMicroSecPerFrame</a>;</div><div class="line"><a name="l00460"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7ce69cd349ed8434299bbf8688a22971">  460</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7ce69cd349ed8434299bbf8688a22971">dwMaxBytesPerSec</a>;</div><div class="line"><a name="l00461"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a927a521601ccafb80d30d5d0b6938db4">  461</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a927a521601ccafb80d30d5d0b6938db4">dwReserved1</a>;</div><div class="line"><a name="l00462"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a5f50db97ac24d22f928d9fe84349df6b">  462</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a5f50db97ac24d22f928d9fe84349df6b">dwFlags</a>;</div><div class="line"><a name="l00463"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a687586aa131c3fed450ee954833497de">  463</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a687586aa131c3fed450ee954833497de">dwTotalFrames</a>; <span class="comment">// AVI 2.0: will be replaced by number of frames</span></div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;                             <span class="comment">// from index</span></div><div class="line"><a name="l00465"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a9aa0ffa678be4bc0d8a6dd481d1d5a69">  465</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a9aa0ffa678be4bc0d8a6dd481d1d5a69">dwInitialFrames</a>;</div><div class="line"><a name="l00466"></a><span class="lineno">  466</span>&#160;</div><div class="line"><a name="l00467"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#af71dfd9842e0d49e7093425c682accc2">  467</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#af71dfd9842e0d49e7093425c682accc2">dwStreams</a>;</div><div class="line"><a name="l00468"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7fe2f1443f6ace6bc10f161736cf37fe">  468</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7fe2f1443f6ace6bc10f161736cf37fe">dwSuggestedBufferSize</a>;</div><div class="line"><a name="l00469"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a08c43e3e1b584ab46351d34f5e673d52">  469</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a08c43e3e1b584ab46351d34f5e673d52">dwWidth</a>;</div><div class="line"><a name="l00470"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa0f9805a5e31b86fdae78b0c83397560">  470</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa0f9805a5e31b86fdae78b0c83397560">dwHeight</a>;</div><div class="line"><a name="l00471"></a><span class="lineno">  471</span>&#160;  <span class="comment">// From Stream Header Chunk</span></div><div class="line"><a name="l00472"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#adcbc1efe812b80e03f786802aca91c9f">  472</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#adcbc1efe812b80e03f786802aca91c9f">fccStreamHandler</a>;</div><div class="line"><a name="l00473"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad5d205e0f80feda5219d2fec97cc7aeb">  473</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad5d205e0f80feda5219d2fec97cc7aeb">dwStreamFlags</a>;</div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aeecf0501939b72f8c9439da4ffb31681">  474</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aeecf0501939b72f8c9439da4ffb31681">dwPriorityLanguage</a>; <span class="comment">// actually 2 16-bit words: wPriority and</span></div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;                                  <span class="comment">// wLanguage</span></div><div class="line"><a name="l00476"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8a6d0d067c96a7855defd0b583175a69">  476</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8a6d0d067c96a7855defd0b583175a69">dwStreamInitialFrames</a>;</div><div class="line"><a name="l00477"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#afc4ad2de3e2a87833b883d0c2be1c26c">  477</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afc4ad2de3e2a87833b883d0c2be1c26c">dwStreamScale</a>;</div><div class="line"><a name="l00478"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4de5805ac7c9c98431da308b4680a030">  478</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4de5805ac7c9c98431da308b4680a030">dwStreamRate</a>;</div><div class="line"><a name="l00479"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ac397f59813ccb9e2d9e477a3d796aedf">  479</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac397f59813ccb9e2d9e477a3d796aedf">dwStreamStart</a>;</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;</div><div class="line"><a name="l00481"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a88bb4aaade5e30fed579a366ec01aaef">  481</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a88bb4aaade5e30fed579a366ec01aaef">dwStreamLength</a>;</div><div class="line"><a name="l00482"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad05d8b83afe5487585ba0b76b4e562bf">  482</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad05d8b83afe5487585ba0b76b4e562bf">dwStreamSuggestedBufferSize</a>;</div><div class="line"><a name="l00483"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4c7dafb648f3af0e271835e7b57d336b">  483</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4c7dafb648f3af0e271835e7b57d336b">dwStreamQuality</a>;</div><div class="line"><a name="l00484"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ac4222c0f7a1f465b2501b8a6d494b97d">  484</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac4222c0f7a1f465b2501b8a6d494b97d">dwStreamSampleSize</a>;</div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;  <span class="comment">// From Stream Format Chunk: BITMAPINFO contents (40 bytes)</span></div><div class="line"><a name="l00486"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abd76827a0d420fc84cea9939fa729629">  486</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abd76827a0d420fc84cea9939fa729629">biSize</a>; <span class="comment">// size of this header in bytes (40)</span></div><div class="line"><a name="l00487"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8996757bd683838a4c14dc3802bc4d80">  487</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8996757bd683838a4c14dc3802bc4d80">biWidth</a>;</div><div class="line"><a name="l00488"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">  488</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>;</div><div class="line"><a name="l00489"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa9e38fa52fb30a225ae304cbc51f6a9f">  489</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">short</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa9e38fa52fb30a225ae304cbc51f6a9f">biPlanes</a>; <span class="comment">// no. of color planes: for the formats decoded; here</span></div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;                          <span class="comment">// always 1</span></div><div class="line"><a name="l00491"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4a949422fb2bb2aa1b70307b7591def9">  491</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">short</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a949422fb2bb2aa1b70307b7591def9">biBitCount</a>; <span class="comment">// Bits per Pixel</span></div><div class="line"><a name="l00492"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a31a4fa4c68cbc3c5fc109a866190c528">  492</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a31a4fa4c68cbc3c5fc109a866190c528">biCompression</a>;</div><div class="line"><a name="l00493"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a2f4d53cdf9cb569e0717514dc7a0e9e0">  493</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a2f4d53cdf9cb569e0717514dc7a0e9e0">biSizeImage</a>; <span class="comment">// size of image in bytes (may be 0: if so,</span></div><div class="line"><a name="l00494"></a><span class="lineno">  494</span>&#160;                           <span class="comment">// calculate)</span></div><div class="line"><a name="l00495"></a><span class="lineno">  495</span>&#160;</div><div class="line"><a name="l00496"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7da1a1be394a0f561653e1c1be3b3c19">  496</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7da1a1be394a0f561653e1c1be3b3c19">biXPelsPerMeter</a>; <span class="comment">// horizontal resolution, pixels/meter (may be</span></div><div class="line"><a name="l00497"></a><span class="lineno">  497</span>&#160;                               <span class="comment">// 0)</span></div><div class="line"><a name="l00498"></a><span class="lineno">  498</span>&#160;</div><div class="line"><a name="l00499"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a736023d549bc0b8cdd7d4519f344a613">  499</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a736023d549bc0b8cdd7d4519f344a613">biYPelsPerMeter</a>; <span class="comment">// vertical resolution, pixels/meter (may be 0)</span></div><div class="line"><a name="l00500"></a><span class="lineno">  500</span>&#160;</div><div class="line"><a name="l00501"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">  501</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">biClrUsed</a>; <span class="comment">// no. of colors in palette (if 0, calculate)</span></div><div class="line"><a name="l00502"></a><span class="lineno">  502</span>&#160;</div><div class="line"><a name="l00503"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a1b8bc08588b4d1c07756176010cecd58">  503</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1b8bc08588b4d1c07756176010cecd58">biClrImportant</a>; <span class="comment">// no. of important colors (appear first in</span></div><div class="line"><a name="l00504"></a><span class="lineno">  504</span>&#160;                              <span class="comment">// palette) (0 means all are important)</span></div><div class="line"><a name="l00505"></a><span class="lineno">  505</span>&#160;</div><div class="line"><a name="l00510"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a8ab8de0b3441fc072aa023892c98a230">  510</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a8ab8de0b3441fc072aa023892c98a230">deleteSlice</a>(<span class="keywordtype">int</span> n) {</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordflow">if</span> (frameInfos == null || frameInfos.size() == 0)</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;    <span class="keywordflow">if</span> (n &lt; 1 || n &gt; frameInfos.size())</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Argument out of range: &quot;</span> + n);</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;    frameInfos.removeElementAt(n - 1);</div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;  }</div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;</div><div class="line"><a name="l00518"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">  518</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(String msg) {</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;    aborting = <span class="keyword">true</span>;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    IJ.error(<span class="stringliteral">&quot;AVI Reader&quot;</span>, msg);</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;  }</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;</div><div class="line"><a name="l00523"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">  523</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a>(Exception e) {</div><div class="line"><a name="l00524"></a><span class="lineno">  524</span>&#160;    String msg;</div><div class="line"><a name="l00525"></a><span class="lineno">  525</span>&#160;    <span class="keywordflow">if</span> (e.getClass() == Exception.class) <span class="comment">// for &quot;home-built&quot; exceptions:</span></div><div class="line"><a name="l00526"></a><span class="lineno">  526</span>&#160;                                         <span class="comment">// message only</span></div><div class="line"><a name="l00527"></a><span class="lineno">  527</span>&#160;      msg = e.getMessage();</div><div class="line"><a name="l00528"></a><span class="lineno">  528</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00529"></a><span class="lineno">  529</span>&#160;      msg = e + <span class="stringliteral">&quot;\n&quot;</span> + e.getStackTrace()[0] + <span class="stringliteral">&quot;\n&quot;</span> + e.getStackTrace()[1];</div><div class="line"><a name="l00530"></a><span class="lineno">  530</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;An error occurred reading the AVI file.\n \n&quot;</span> + msg;</div><div class="line"><a name="l00531"></a><span class="lineno">  531</span>&#160;  }</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;</div><div class="line"><a name="l00537"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">  537</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(<span class="keywordtype">int</span> fourcc, <span class="keywordtype">boolean</span> isList, <span class="keywordtype">long</span> endPosition, <span class="keywordtype">boolean</span> throwNotFoundException)</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;      <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;    <span class="keywordtype">long</span> nextPos;</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    <span class="keywordtype">boolean</span> contentOk = <span class="keyword">false</span>;</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">do</span> {</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;      <span class="keywordtype">int</span> type = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee">readType</a>(endPosition);</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;      <span class="keywordflow">if</span> (type == 0) { <span class="comment">// reached endPosition without finding</span></div><div class="line"><a name="l00544"></a><span class="lineno">  544</span>&#160;        <span class="keywordflow">if</span> (throwNotFoundException)</div><div class="line"><a name="l00545"></a><span class="lineno">  545</span>&#160;          <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Required item &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fourcc) + <span class="stringliteral">&quot;&#39; not found&quot;</span>);</div><div class="line"><a name="l00546"></a><span class="lineno">  546</span>&#160;        <span class="keywordflow">else</span></div><div class="line"><a name="l00547"></a><span class="lineno">  547</span>&#160;          <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00548"></a><span class="lineno">  548</span>&#160;      }</div><div class="line"><a name="l00549"></a><span class="lineno">  549</span>&#160;      <span class="keywordtype">long</span> size = readInt() &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a>;</div><div class="line"><a name="l00550"></a><span class="lineno">  550</span>&#160;      nextPos = raFile.getFilePointer() + size;</div><div class="line"><a name="l00551"></a><span class="lineno">  551</span>&#160;      <span class="keywordflow">if</span> (isList &amp;&amp; type == FOURCC_LIST)</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;        type = readInt();</div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;        IJ.log(<span class="stringliteral">&quot;Searching for &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fourcc) + <span class="stringliteral">&quot;&#39;, found &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type) + <span class="stringliteral">&quot;&#39; &quot;</span></div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;            + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(nextPos - size, size));</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      <span class="keywordflow">if</span> (type == fourcc) {</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;        contentOk = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a85350caab45622b078587a67833fe2b4">readContents</a>(fourcc, nextPos);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        IJ.log(<span class="stringliteral">&quot;Discarded &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type) + <span class="stringliteral">&quot;&#39;: Contents does not fit&quot;</span>);</div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;      raFile.seek(nextPos);</div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;      <span class="keywordflow">if</span> (contentOk)</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;        <span class="keywordflow">return</span> nextPos; <span class="comment">// found and read, breaks the loop</span></div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;    } <span class="keywordflow">while</span> (!contentOk);</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;    <span class="keywordflow">return</span> nextPos;</div><div class="line"><a name="l00565"></a><span class="lineno">  565</span>&#160;  }</div><div class="line"><a name="l00566"></a><span class="lineno">  566</span>&#160;</div><div class="line"><a name="l00572"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4c4590dd4505a88b0a26aee5d575df20">  572</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">long</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4c4590dd4505a88b0a26aee5d575df20">findFourccAndSkip</a>(<span class="keywordtype">int</span> fourcc, <span class="keywordtype">boolean</span> isList, <span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00573"></a><span class="lineno">  573</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l00574"></a><span class="lineno">  574</span>&#160;      <span class="keywordtype">int</span> type = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee">readType</a>(endPosition);</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;      <span class="keywordflow">if</span> (type == 0) <span class="comment">// reached endPosition without finding</span></div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;        <span class="keywordflow">return</span> -1;</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;      <span class="keywordtype">long</span> size = readInt() &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a>;</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;      <span class="keywordtype">long</span> chunkPos = raFile.getFilePointer();</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;      <span class="keywordtype">long</span> nextPos = chunkPos + size; <span class="comment">// note that &#39;size&#39; of a list includes</span></div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;                                      <span class="comment">// the &#39;type&#39; that follows now</span></div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordflow">if</span> (isList &amp;&amp; type == FOURCC_LIST)</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;        type = readInt();</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;        IJ.log(<span class="stringliteral">&quot;Searching for (to skip) &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fourcc) + <span class="stringliteral">&quot;&#39;, found &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type) + <span class="stringliteral">&quot;&#39; &quot;</span></div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;            + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(chunkPos, size));</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      raFile.seek(nextPos);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordflow">if</span> (type == fourcc)</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;        <span class="keywordflow">return</span> chunkPos; <span class="comment">// found and skipped, breaks the loop</span></div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;    }</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;  }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;</div><div class="line"><a name="l00596"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">  596</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(<span class="keywordtype">int</span> fourcc) {</div><div class="line"><a name="l00597"></a><span class="lineno">  597</span>&#160;    String s = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l00598"></a><span class="lineno">  598</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; 4; i++) {</div><div class="line"><a name="l00599"></a><span class="lineno">  599</span>&#160;      <span class="keywordtype">int</span> c = fourcc &amp; 0xff;</div><div class="line"><a name="l00600"></a><span class="lineno">  600</span>&#160;      s += Character.toString((<span class="keywordtype">char</span>) c);</div><div class="line"><a name="l00601"></a><span class="lineno">  601</span>&#160;      fourcc &gt;&gt;= 8;</div><div class="line"><a name="l00602"></a><span class="lineno">  602</span>&#160;    }</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;    <span class="keywordflow">return</span> s;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;  }</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;</div><div class="line"><a name="l00606"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a336978e2eb7112d383ea131ff8bd0193">  606</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a336978e2eb7112d383ea131ff8bd0193">frameLabel</a>(<span class="keywordtype">long</span> timeMicroSec) {</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;    <span class="keywordflow">return</span> IJ.d2s(timeMicroSec / 1.e6) + <span class="stringliteral">&quot; s&quot;</span>;</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;  }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;</div><div class="line"><a name="l00611"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aa67e28fcf751e79407a8e33309c4df59">  611</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa67e28fcf751e79407a8e33309c4df59">getHeight</a>() {</div><div class="line"><a name="l00612"></a><span class="lineno">  612</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>;</div><div class="line"><a name="l00613"></a><span class="lineno">  613</span>&#160;  }</div><div class="line"><a name="l00614"></a><span class="lineno">  614</span>&#160;</div><div class="line"><a name="l00616"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a857b41097078525ba73d3d62fe99047e">  616</a></span>&#160;  <span class="keyword">public</span> ImagePlus <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a857b41097078525ba73d3d62fe99047e">getImagePlus</a>() {</div><div class="line"><a name="l00617"></a><span class="lineno">  617</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad2278f058a9bb4421b37747cf5c5bd32">imp</a>;</div><div class="line"><a name="l00618"></a><span class="lineno">  618</span>&#160;  }</div><div class="line"><a name="l00619"></a><span class="lineno">  619</span>&#160;</div><div class="line"><a name="l00625"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a0ce25d675c642fe70f4b9568e6514dc0">  625</a></span>&#160;  <span class="keyword">public</span> <span class="keyword">synchronized</span> ImageProcessor <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0ce25d675c642fe70f4b9568e6514dc0">getProcessor</a>(<span class="keywordtype">int</span> n) {</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;    <span class="keywordflow">if</span> (frameInfos == null || frameInfos.size() == 0 || raFilePath == null)</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;    <span class="keywordflow">if</span> (n &lt; 1 || n &gt; frameInfos.size())</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;Argument out of range: &quot;</span> + n);</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    Object pixels = null;</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    RandomAccessFile rFile = null;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;    String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a> = null;</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l00634"></a><span class="lineno">  634</span>&#160;      rFile = <span class="keyword">new</span> RandomAccessFile(<span class="keyword">new</span> File(raFilePath), <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00635"></a><span class="lineno">  635</span>&#160;      <span class="keywordtype">long</span>[] frameInfo = (<span class="keywordtype">long</span>[]) (frameInfos.get(n - 1));</div><div class="line"><a name="l00636"></a><span class="lineno">  636</span>&#160;      pixels = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a25d354ac0e1c0771dde30e7e7379ae">readFrame</a>(rFile, frameInfo[0], (<span class="keywordtype">int</span>) frameInfo[1]);</div><div class="line"><a name="l00637"></a><span class="lineno">  637</span>&#160;    } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l00638"></a><span class="lineno">  638</span>&#160;      exceptionMessage = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a>(e);</div><div class="line"><a name="l00639"></a><span class="lineno">  639</span>&#160;    } <span class="keywordflow">finally</span> {</div><div class="line"><a name="l00640"></a><span class="lineno">  640</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00641"></a><span class="lineno">  641</span>&#160;        rFile.close();</div><div class="line"><a name="l00642"></a><span class="lineno">  642</span>&#160;      } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l00643"></a><span class="lineno">  643</span>&#160;      }</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    }</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <span class="keywordflow">if</span> (exceptionMessage != null) {</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(exceptionMessage);</div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;      <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;    }</div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordflow">if</span> (pixels == null)</div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;      <span class="keywordflow">return</span> null; <span class="comment">// failed</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;    <span class="keywordflow">if</span> (pixels instanceof byte[])</div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> ByteProcessor(dwWidth, biHeight, (byte[]) pixels, cm);</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordflow">else</span> <span class="keywordflow">if</span> (pixels instanceof <span class="keywordtype">short</span>[])</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> ShortProcessor(dwWidth, biHeight, (<span class="keywordtype">short</span>[]) pixels, cm);</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> ColorProcessor(dwWidth, biHeight, (<span class="keywordtype">int</span>[]) pixels);</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;  }</div><div class="line"><a name="l00658"></a><span class="lineno">  658</span>&#160;</div><div class="line"><a name="l00660"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a3bd3cdd8c8ece98211ccf6b866093dc5">  660</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3bd3cdd8c8ece98211ccf6b866093dc5">getSize</a>() {</div><div class="line"><a name="l00661"></a><span class="lineno">  661</span>&#160;    <span class="keywordflow">if</span> (frameInfos == null)</div><div class="line"><a name="l00662"></a><span class="lineno">  662</span>&#160;      <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l00663"></a><span class="lineno">  663</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00664"></a><span class="lineno">  664</span>&#160;      <span class="keywordflow">return</span> frameInfos.size();</div><div class="line"><a name="l00665"></a><span class="lineno">  665</span>&#160;  }</div><div class="line"><a name="l00666"></a><span class="lineno">  666</span>&#160;</div><div class="line"><a name="l00671"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a5847e6c3323a34b06326a61e874616b2">  671</a></span>&#160;  <span class="keyword">public</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a5847e6c3323a34b06326a61e874616b2">getSliceLabel</a>(<span class="keywordtype">int</span> n) {</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;    <span class="keywordflow">if</span> (frameInfos == null || n &lt; 1 || n &gt; frameInfos.size())</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> IllegalArgumentException(<span class="stringliteral">&quot;No Virtual Stack or argument out of range: &quot;</span> + n);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a336978e2eb7112d383ea131ff8bd0193">frameLabel</a>(((<span class="keywordtype">long</span>[]) (frameInfos.get(n - 1)))[2]);</div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;  }</div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;</div><div class="line"><a name="l00678"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#afd0dc38d34abecc1cc6a8e85700fb8aa">  678</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afd0dc38d34abecc1cc6a8e85700fb8aa">getWidth</a>() {</div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a08c43e3e1b584ab46351d34f5e673d52">dwWidth</a>;</div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;  }</div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;</div><div class="line"><a name="l00700"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ae699b81fde03f1f2acf246a66ca12770">  700</a></span>&#160;  <span class="keyword">public</span> ImageStack <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae699b81fde03f1f2acf246a66ca12770">makeStack</a>(String path, <span class="keywordtype">int</span> firstFrame, <span class="keywordtype">int</span> lastFrame, <span class="keywordtype">boolean</span> isVirtual, <span class="keywordtype">boolean</span> convertToGray,</div><div class="line"><a name="l00701"></a><span class="lineno">  701</span>&#160;      <span class="keywordtype">boolean</span> flipVertical) {</div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;    this.firstFrame = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac3215b5ca71c819b5596da8de72d1c51">firstFrame</a>;</div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;    this.lastFrame = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">lastFrame</a>;</div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    this.isVirtual = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7a2de66ab228979ef527d69ef6f715d8">isVirtual</a>;</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    this.convertToGray = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4ed3ed255ad8de9543bc052fdf79c1bf">convertToGray</a>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    this.flipVertical = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#af80522b94aad967163e1c1f632ccae18">flipVertical</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a> = null;</div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;    IJ.showProgress(.001);</div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abd09c719eac6258ba43f4f22ba6e587e">readAVI</a>(path);</div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;    } <span class="keywordflow">catch</span> (OutOfMemoryError e) {</div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;      stack.trim();</div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;      e.printStackTrace();</div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;      IJ.showMessage(<span class="stringliteral">&quot;AVI Reader&quot;</span>,</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;          <span class="stringliteral">&quot;Out of memory.  &quot;</span> + stack.getSize() + <span class="stringliteral">&quot; of &quot;</span> + dwTotalFrames + <span class="stringliteral">&quot; frames will be opened.&quot;</span>);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;      exceptionMessage = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a>(e);</div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;    } <span class="keywordflow">finally</span> {</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;      <span class="keywordflow">try</span> {</div><div class="line"><a name="l00720"></a><span class="lineno">  720</span>&#160;        raFile.close();</div><div class="line"><a name="l00721"></a><span class="lineno">  721</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00722"></a><span class="lineno">  722</span>&#160;          IJ.log(<span class="stringliteral">&quot;File closed.&quot;</span>);</div><div class="line"><a name="l00723"></a><span class="lineno">  723</span>&#160;      } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l00724"></a><span class="lineno">  724</span>&#160;      }</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;      IJ.showProgress(1.0);</div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    }</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    <span class="keywordflow">if</span> (exceptionMessage != null) {</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(exceptionMessage);</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;      <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    }</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keywordflow">if</span> (isVirtual &amp;&amp; frameInfos != null)</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;      stack = <span class="keyword">this</span>;</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordflow">if</span> (stack != null &amp;&amp; cm != null)</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;      stack.setColorModel(cm);</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3718d0e6f5e4617dcc81a8e481361c7e">stack</a>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;  }</div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;</div><div class="line"><a name="l00739"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a3ed951465a3d01864dfcd07e0f62fff4">  739</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3ed951465a3d01864dfcd07e0f62fff4">openAndReadHeader</a>(String path) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    startTime = System.currentTimeMillis();</div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;      IJ.log(<span class="stringliteral">&quot;OPEN AND READ AVI FILE HEADER &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;    File file = <span class="keyword">new</span> File(path); <span class="comment">// o p e n</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;    raFile = <span class="keyword">new</span> RandomAccessFile(file, <span class="stringliteral">&quot;r&quot;</span>);</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;    raFilePath = path;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;    fileSize = raFile.length();</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;    <span class="keywordtype">int</span> fileType = readInt(); <span class="comment">// f i l e h e a d e r</span></div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      IJ.log(<span class="stringliteral">&quot;File header: File type=&#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fileType) + <span class="stringliteral">&quot;&#39; (should be &#39;RIFF&#39;)&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;    <span class="keywordflow">if</span> (fileType != FOURCC_RIFF)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Not an AVI file.&quot;</span>);</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;    aviSize = readInt() &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a>; <span class="comment">// size of AVI chunk</span></div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;    <span class="keywordtype">int</span> riffType = readInt();</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;      IJ.log(<span class="stringliteral">&quot;File header: RIFF type=&#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(riffType) + <span class="stringliteral">&quot;&#39; (should be &#39;AVI &#39;)&quot;</span>);</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;    <span class="keywordflow">if</span> (riffType != FOURCC_AVI)</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Not an AVI file.&quot;</span>);</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;    <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_hdrl, <span class="keyword">true</span>, fileSize, <span class="keyword">true</span>);</div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;    startTime -= System.currentTimeMillis(); <span class="comment">// becomes minus elapsed Time</span></div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;    headerOK = <span class="keyword">true</span>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;  }</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;</div><div class="line"><a name="l00763"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">  763</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(<span class="keywordtype">long</span> size) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;    <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(raFile.getFilePointer(), size);</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;  }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;</div><div class="line"><a name="l00767"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a215ef7fd53bae77c17ea7d3743948ef8">  767</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a215ef7fd53bae77c17ea7d3743948ef8">posSizeString</a>(<span class="keywordtype">long</span> pos, <span class="keywordtype">long</span> size) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l00768"></a><span class="lineno">  768</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot;0x&quot;</span> + Long.toHexString(pos) + <span class="stringliteral">&quot;-0x&quot;</span> + Long.toHexString(pos + size - 1) + <span class="stringliteral">&quot; (&quot;</span> + size + <span class="stringliteral">&quot; Bytes)&quot;</span>;</div><div class="line"><a name="l00769"></a><span class="lineno">  769</span>&#160;  }</div><div class="line"><a name="l00770"></a><span class="lineno">  770</span>&#160;</div><div class="line"><a name="l00772"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#abd09c719eac6258ba43f4f22ba6e587e">  772</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abd09c719eac6258ba43f4f22ba6e587e">readAVI</a>(String path) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00773"></a><span class="lineno">  773</span>&#160;    <span class="keywordflow">if</span> (!headerOK) <span class="comment">// we have not read the header yet?</span></div><div class="line"><a name="l00774"></a><span class="lineno">  774</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3ed951465a3d01864dfcd07e0f62fff4">openAndReadHeader</a>(path);</div><div class="line"><a name="l00775"></a><span class="lineno">  775</span>&#160;    startTime += System.currentTimeMillis();<span class="comment">// taking previously elapsed time</span></div><div class="line"><a name="l00776"></a><span class="lineno">  776</span>&#160;                                            <span class="comment">// into account</span></div><div class="line"><a name="l00778"></a><span class="lineno">  778</span>&#160;<span class="comment"></span>    <span class="keywordflow">if</span> (lastFrame &gt; 0) <span class="comment">// last frame number to read: from Dialog</span></div><div class="line"><a name="l00779"></a><span class="lineno">  779</span>&#160;      lastFrameToRead = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">lastFrame</a>;</div><div class="line"><a name="l00780"></a><span class="lineno">  780</span>&#160;    <span class="keywordflow">if</span> (lastFrame &lt; 0 &amp;&amp; dwTotalFrames &gt; 0) <span class="comment">// negative means &quot;end frame minus</span></div><div class="line"><a name="l00781"></a><span class="lineno">  781</span>&#160;                                            <span class="comment">// ...&quot;</span></div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;      lastFrameToRead = dwTotalFrames + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">lastFrame</a>;</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    <span class="keywordflow">if</span> (lastFrameToRead &lt; firstFrame) <span class="comment">// no frames to read</span></div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    <span class="keywordtype">boolean</span> hasIndex = (dwFlags &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abdad34900c6c58013d7d982d29b4575b">AVIF_HASINDEX</a>) != 0;</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (isVirtual || firstFrame &gt; 1) { <span class="comment">// avoid scanning frame-by-frame where</span></div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;                                       <span class="comment">// we only need the positions</span></div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;      frameInfos = <span class="keyword">new</span> Vector(100); <span class="comment">// holds frame positions, sizes and time</span></div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;                                    <span class="comment">// since start</span></div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;      <span class="keywordtype">long</span> nextPosition = -1;</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;      <span class="keywordflow">if</span> (indexPosition &gt; 0) { <span class="comment">// attempt to get AVI2.0 index instead of</span></div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;                               <span class="comment">// scanning for all frames</span></div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;        raFile.seek(indexPosition);</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;        nextPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_indx, <span class="keyword">false</span>, indexPositionEnd, <span class="keyword">false</span>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;      }</div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      <span class="keywordflow">if</span> (hasIndex &amp;&amp; frameInfos.size() == 0) { <span class="comment">// got nothing from indx,</span></div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;                                                <span class="comment">// attempt to read AVI 1</span></div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;                                                <span class="comment">// index &#39;idx1&#39;</span></div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;        raFile.seek(headerPositionEnd);</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;        moviPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4c4590dd4505a88b0a26aee5d575df20">findFourccAndSkip</a>(FOURCC_movi, <span class="keyword">true</span>, fileSize); <span class="comment">// go</span></div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;                                                                       <span class="comment">// behind</span></div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;                                                                       <span class="comment">// the</span></div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;                                                                       <span class="comment">// &#39;movi&#39;</span></div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;                                                                       <span class="comment">// list</span></div><div class="line"><a name="l00805"></a><span class="lineno">  805</span>&#160;        <span class="keywordflow">if</span> (moviPosition &gt; 0)</div><div class="line"><a name="l00806"></a><span class="lineno">  806</span>&#160;          nextPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_idx1, <span class="keyword">false</span>, fileSize, <span class="keyword">false</span>);</div><div class="line"><a name="l00807"></a><span class="lineno">  807</span>&#160;      }</div><div class="line"><a name="l00808"></a><span class="lineno">  808</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00809"></a><span class="lineno">  809</span>&#160;        IJ.log(<span class="stringliteral">&quot;&#39;frameInfos&#39; has &quot;</span> + frameInfos.size() + <span class="stringliteral">&quot; entries&quot;</span>);</div><div class="line"><a name="l00810"></a><span class="lineno">  810</span>&#160;    }</div><div class="line"><a name="l00811"></a><span class="lineno">  811</span>&#160;    <span class="keywordflow">if</span> (isVirtual &amp;&amp; frameInfos.size() &gt; 0) <span class="comment">// Virtual Stack only needs</span></div><div class="line"><a name="l00812"></a><span class="lineno">  812</span>&#160;                                            <span class="comment">// reading the index</span></div><div class="line"><a name="l00813"></a><span class="lineno">  813</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00814"></a><span class="lineno">  814</span>&#160;    <span class="comment">// Read AVI (movie data) frame by frame - if no index tag is present the</span></div><div class="line"><a name="l00815"></a><span class="lineno">  815</span>&#160;    <span class="comment">// pointers</span></div><div class="line"><a name="l00816"></a><span class="lineno">  816</span>&#160;    <span class="comment">// for the virtual AVI stack will be read here</span></div><div class="line"><a name="l00817"></a><span class="lineno">  817</span>&#160;    raFile.seek(headerPositionEnd);</div><div class="line"><a name="l00818"></a><span class="lineno">  818</span>&#160;    <span class="keywordflow">if</span> (firstFrame &gt; 1 &amp;&amp; frameInfos.size() &gt; 0) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;      <span class="keywordtype">long</span>[] frameInfo = (<span class="keywordtype">long</span>[]) frameInfos.get(0);</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;      raFile.seek(frameInfo[0] - 8); <span class="comment">// chunk starts 8 bytes before frame</span></div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;                                     <span class="comment">// data</span></div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;      frameNumber = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac3215b5ca71c819b5596da8de72d1c51">firstFrame</a>;</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;        IJ.log(<span class="stringliteral">&quot;directly go to frame &quot;</span> + firstFrame + <span class="stringliteral">&quot; @ 0x&quot;</span> + Long.toHexString(frameInfo[0] - 8));</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;      readMovieData(fileSize);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;      frameNumber = 1;</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_movi, <span class="keyword">true</span>, fileSize, <span class="keyword">true</span>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    }</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordtype">long</span> pos = raFile.getFilePointer();</div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;    <span class="comment">// IJ.log(&quot;at 0x&quot;+Long.toHexString(pos)+&quot;</span></div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="comment">// filesize=0x&quot;+Long.toHexString(fileSize));</span></div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;    <span class="comment">// extended AVI: try to find further &#39;RIFF&#39; chunks, where we expect AVIX</span></div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="comment">// tags</span></div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;    <span class="keywordflow">while</span> (pos &gt; 0 &amp;&amp; pos &lt; fileSize &amp;&amp; (frameNumber &lt; lastFrameToRead + 1)) {</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;      pos = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_RIFF, <span class="keyword">false</span>, fileSize, <span class="keyword">false</span>);</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      System.out.println(<span class="stringliteral">&quot;Reading AVI...&quot;</span> + 100 * frameNumber / lastFrameToRead + <span class="stringliteral">&quot;%&quot;</span>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;    }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;    <span class="keywordflow">return</span>;</div><div class="line"><a name="l00841"></a><span class="lineno">  841</span>&#160;  }</div><div class="line"><a name="l00842"></a><span class="lineno">  842</span>&#160;</div><div class="line"><a name="l00847"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#ad22821cde3b5326489f24ad437513919">  847</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad22821cde3b5326489f24ad437513919">readAvi2Index</a>(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00848"></a><span class="lineno">  848</span>&#160;    <span class="keywordtype">short</span> wLongsPerEntry = readShort();</div><div class="line"><a name="l00849"></a><span class="lineno">  849</span>&#160;    byte bIndexSubType = raFile.readByte();</div><div class="line"><a name="l00850"></a><span class="lineno">  850</span>&#160;    byte bIndexType = raFile.readByte();</div><div class="line"><a name="l00851"></a><span class="lineno">  851</span>&#160;    <span class="keywordtype">int</span> nEntriesInUse = readInt();</div><div class="line"><a name="l00852"></a><span class="lineno">  852</span>&#160;    <span class="keywordtype">int</span> dwChunkId = readInt();</div><div class="line"><a name="l00853"></a><span class="lineno">  853</span>&#160;    <span class="keywordtype">long</span> qwBaseOffset = readLong();</div><div class="line"><a name="l00854"></a><span class="lineno">  854</span>&#160;    readInt(); <span class="comment">// dwReserved3</span></div><div class="line"><a name="l00855"></a><span class="lineno">  855</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00856"></a><span class="lineno">  856</span>&#160;      String bIndexString = bIndexType == AVI_INDEX_OF_CHUNKS ? <span class="stringliteral">&quot;: AVI_INDEX_OF_CHUNKS&quot;</span></div><div class="line"><a name="l00857"></a><span class="lineno">  857</span>&#160;          : bIndexType == AVI_INDEX_OF_INDEXES ? <span class="stringliteral">&quot;: AVI_INDEX_OF_INDEXES&quot;</span> : <span class="stringliteral">&quot;: UNSUPPOERTED&quot;</span>;</div><div class="line"><a name="l00858"></a><span class="lineno">  858</span>&#160;      IJ.log(<span class="stringliteral">&quot;AVI 2 INDEX:&quot;</span>);</div><div class="line"><a name="l00859"></a><span class="lineno">  859</span>&#160;      IJ.log(<span class="stringliteral">&quot;   wLongsPerEntry=&quot;</span> + wLongsPerEntry);</div><div class="line"><a name="l00860"></a><span class="lineno">  860</span>&#160;      IJ.log(<span class="stringliteral">&quot;   bIndexSubType=&quot;</span> + bIndexSubType);</div><div class="line"><a name="l00861"></a><span class="lineno">  861</span>&#160;      IJ.log(<span class="stringliteral">&quot;   bIndexType=&quot;</span> + bIndexType + bIndexString);</div><div class="line"><a name="l00862"></a><span class="lineno">  862</span>&#160;      IJ.log(<span class="stringliteral">&quot;   nEntriesInUse=&quot;</span> + nEntriesInUse);</div><div class="line"><a name="l00863"></a><span class="lineno">  863</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwChunkId=&#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(dwChunkId) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div><div class="line"><a name="l00864"></a><span class="lineno">  864</span>&#160;      <span class="keywordflow">if</span> (bIndexType == AVI_INDEX_OF_CHUNKS)</div><div class="line"><a name="l00865"></a><span class="lineno">  865</span>&#160;        IJ.log(<span class="stringliteral">&quot;   qwBaseOffset=&quot;</span> + <span class="stringliteral">&quot;0x&quot;</span> + Long.toHexString(qwBaseOffset));</div><div class="line"><a name="l00866"></a><span class="lineno">  866</span>&#160;    }</div><div class="line"><a name="l00867"></a><span class="lineno">  867</span>&#160;    <span class="keywordflow">if</span> (bIndexType == AVI_INDEX_OF_INDEXES) { <span class="comment">// &#39;indx&#39; points to other</span></div><div class="line"><a name="l00868"></a><span class="lineno">  868</span>&#160;                                              <span class="comment">// indices</span></div><div class="line"><a name="l00869"></a><span class="lineno">  869</span>&#160;      <span class="keywordflow">if</span> (wLongsPerEntry != 4)</div><div class="line"><a name="l00870"></a><span class="lineno">  870</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// badly formed index, ignore it</span></div><div class="line"><a name="l00871"></a><span class="lineno">  871</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nEntriesInUse; i++) {</div><div class="line"><a name="l00872"></a><span class="lineno">  872</span>&#160;        <span class="keywordtype">long</span> qwOffset = readLong();</div><div class="line"><a name="l00873"></a><span class="lineno">  873</span>&#160;        <span class="keywordtype">int</span> dwSize = readInt();</div><div class="line"><a name="l00874"></a><span class="lineno">  874</span>&#160;        <span class="keywordtype">int</span> dwDuration = readInt(); <span class="comment">// ignored; not trustworthy anyhow</span></div><div class="line"><a name="l00875"></a><span class="lineno">  875</span>&#160;        <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00876"></a><span class="lineno">  876</span>&#160;          <span class="comment">// IJ.log(&quot;qwOffset:&quot;+qwOffset);</span></div><div class="line"><a name="l00877"></a><span class="lineno">  877</span>&#160;          IJ.log(<span class="stringliteral">&quot;   index data &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(dwChunkId) + <span class="stringliteral">&quot;&#39; &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(qwOffset, dwSize) + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l00878"></a><span class="lineno">  878</span>&#160;        }</div><div class="line"><a name="l00879"></a><span class="lineno">  879</span>&#160;        <span class="keywordtype">long</span> temp = raFile.getFilePointer();</div><div class="line"><a name="l00880"></a><span class="lineno">  880</span>&#160;        raFile.seek(qwOffset);</div><div class="line"><a name="l00881"></a><span class="lineno">  881</span>&#160;        <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_ix00, <span class="keyword">false</span>, qwOffset + dwSize, <span class="keyword">true</span>);</div><div class="line"><a name="l00882"></a><span class="lineno">  882</span>&#160;        raFile.seek(temp);</div><div class="line"><a name="l00883"></a><span class="lineno">  883</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt; lastFrameToRead)</div><div class="line"><a name="l00884"></a><span class="lineno">  884</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00885"></a><span class="lineno">  885</span>&#160;      }</div><div class="line"><a name="l00886"></a><span class="lineno">  886</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (bIndexType == AVI_INDEX_OF_CHUNKS) {</div><div class="line"><a name="l00887"></a><span class="lineno">  887</span>&#160;      <span class="keywordflow">if</span> (wLongsPerEntry != 2)</div><div class="line"><a name="l00888"></a><span class="lineno">  888</span>&#160;        <span class="keywordflow">return</span>; <span class="comment">// badly formed index, ignore it</span></div><div class="line"><a name="l00889"></a><span class="lineno">  889</span>&#160;      <span class="keywordflow">if</span> (dwChunkId != type0xdb &amp;&amp; dwChunkId != type0xdc) { <span class="comment">// not the stream</span></div><div class="line"><a name="l00890"></a><span class="lineno">  890</span>&#160;                                                            <span class="comment">// we search for?</span></div><div class="line"><a name="l00891"></a><span class="lineno">  891</span>&#160;                                                            <span class="comment">// (should not</span></div><div class="line"><a name="l00892"></a><span class="lineno">  892</span>&#160;                                                            <span class="comment">// happen)</span></div><div class="line"><a name="l00893"></a><span class="lineno">  893</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00894"></a><span class="lineno">  894</span>&#160;          IJ.log(<span class="stringliteral">&quot;INDEX ERROR: SKIPPED ix00, wrong stream number or type, should be &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type0xdb) + <span class="stringliteral">&quot; or &quot;</span></div><div class="line"><a name="l00895"></a><span class="lineno">  895</span>&#160;              + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type0xdc));</div><div class="line"><a name="l00896"></a><span class="lineno">  896</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00897"></a><span class="lineno">  897</span>&#160;      }</div><div class="line"><a name="l00898"></a><span class="lineno">  898</span>&#160;      <span class="keywordflow">if</span> (indexForCountingOnly) { <span class="comment">// only count number of entries, don&#39;t put</span></div><div class="line"><a name="l00899"></a><span class="lineno">  899</span>&#160;                                  <span class="comment">// into table</span></div><div class="line"><a name="l00900"></a><span class="lineno">  900</span>&#160;        totalFramesFromIndex += nEntriesInUse;</div><div class="line"><a name="l00901"></a><span class="lineno">  901</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00902"></a><span class="lineno">  902</span>&#160;      }</div><div class="line"><a name="l00903"></a><span class="lineno">  903</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; nEntriesInUse; i++) {</div><div class="line"><a name="l00904"></a><span class="lineno">  904</span>&#160;        <span class="keywordtype">long</span> dwOffset = readInt() &amp; 0xffffffffL;</div><div class="line"><a name="l00905"></a><span class="lineno">  905</span>&#160;        <span class="keywordtype">long</span> pos = qwBaseOffset + dwOffset;</div><div class="line"><a name="l00906"></a><span class="lineno">  906</span>&#160;        <span class="keywordtype">int</span> dwSize = readInt();</div><div class="line"><a name="l00907"></a><span class="lineno">  907</span>&#160;        <span class="keywordflow">if</span> (isVirtual)</div><div class="line"><a name="l00908"></a><span class="lineno">  908</span>&#160;          IJ.showProgress((<span class="keywordtype">double</span>) frameNumber / lastFrameToRead);</div><div class="line"><a name="l00909"></a><span class="lineno">  909</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt;= firstFrame) {</div><div class="line"><a name="l00910"></a><span class="lineno">  910</span>&#160;          frameInfos.add(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { pos, dwSize, (long) frameNumber * dwMicroSecPerFrame });</div><div class="line"><a name="l00911"></a><span class="lineno">  911</span>&#160;          <span class="comment">// if (verbose)</span></div><div class="line"><a name="l00912"></a><span class="lineno">  912</span>&#160;          <span class="comment">// IJ.log(&quot;movie data &quot;+frameNumber+&quot;</span></div><div class="line"><a name="l00913"></a><span class="lineno">  913</span>&#160;          <span class="comment">// &#39;&quot;+fourccString(dwChunkId)+&quot;&#39;</span></div><div class="line"><a name="l00914"></a><span class="lineno">  914</span>&#160;          <span class="comment">// &quot;+posSizeString(pos,dwSize)+timeString());</span></div><div class="line"><a name="l00915"></a><span class="lineno">  915</span>&#160;        }</div><div class="line"><a name="l00916"></a><span class="lineno">  916</span>&#160;        frameNumber++;</div><div class="line"><a name="l00917"></a><span class="lineno">  917</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt; lastFrameToRead)</div><div class="line"><a name="l00918"></a><span class="lineno">  918</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l00919"></a><span class="lineno">  919</span>&#160;      }</div><div class="line"><a name="l00920"></a><span class="lineno">  920</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00921"></a><span class="lineno">  921</span>&#160;        IJ.log(<span class="stringliteral">&quot;Index read up to frame &quot;</span> + (frameNumber - 1));</div><div class="line"><a name="l00922"></a><span class="lineno">  922</span>&#160;    }</div><div class="line"><a name="l00923"></a><span class="lineno">  923</span>&#160;  }</div><div class="line"><a name="l00924"></a><span class="lineno">  924</span>&#160;</div><div class="line"><a name="l00925"></a><span class="lineno">  925</span>&#160;  <span class="keywordtype">void</span> readAviHeader() <span class="keywordflow">throws</span> Exception, IOException { <span class="comment">// &#39;avih&#39;</span></div><div class="line"><a name="l00926"></a><span class="lineno">  926</span>&#160;    dwMicroSecPerFrame = readInt();</div><div class="line"><a name="l00927"></a><span class="lineno">  927</span>&#160;    dwMaxBytesPerSec = readInt();</div><div class="line"><a name="l00928"></a><span class="lineno">  928</span>&#160;    dwReserved1 = readInt(); <span class="comment">// in newer avi formats, this is</span></div><div class="line"><a name="l00929"></a><span class="lineno">  929</span>&#160;                             <span class="comment">// dwPaddingGranularity?</span></div><div class="line"><a name="l00930"></a><span class="lineno">  930</span>&#160;    dwFlags = readInt();</div><div class="line"><a name="l00931"></a><span class="lineno">  931</span>&#160;    dwTotalFrames = readInt();</div><div class="line"><a name="l00932"></a><span class="lineno">  932</span>&#160;    dwInitialFrames = readInt();</div><div class="line"><a name="l00933"></a><span class="lineno">  933</span>&#160;    dwStreams = readInt();</div><div class="line"><a name="l00934"></a><span class="lineno">  934</span>&#160;    dwSuggestedBufferSize = readInt();</div><div class="line"><a name="l00935"></a><span class="lineno">  935</span>&#160;    dwWidth = readInt();</div><div class="line"><a name="l00936"></a><span class="lineno">  936</span>&#160;    dwHeight = readInt();</div><div class="line"><a name="l00937"></a><span class="lineno">  937</span>&#160;    <span class="comment">// dwReserved[4] follows, ignored</span></div><div class="line"><a name="l00938"></a><span class="lineno">  938</span>&#160;</div><div class="line"><a name="l00939"></a><span class="lineno">  939</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00940"></a><span class="lineno">  940</span>&#160;      IJ.log(<span class="stringliteral">&quot;AVI HEADER (avih):&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l00941"></a><span class="lineno">  941</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwMicroSecPerFrame=&quot;</span> + dwMicroSecPerFrame);</div><div class="line"><a name="l00942"></a><span class="lineno">  942</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwMaxBytesPerSec=&quot;</span> + dwMaxBytesPerSec);</div><div class="line"><a name="l00943"></a><span class="lineno">  943</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwReserved1=&quot;</span> + dwReserved1);</div><div class="line"><a name="l00944"></a><span class="lineno">  944</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwFlags=&quot;</span> + dwFlags);</div><div class="line"><a name="l00945"></a><span class="lineno">  945</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwTotalFrames=&quot;</span> + dwTotalFrames);</div><div class="line"><a name="l00946"></a><span class="lineno">  946</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwInitialFrames=&quot;</span> + dwInitialFrames);</div><div class="line"><a name="l00947"></a><span class="lineno">  947</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreams=&quot;</span> + dwStreams);</div><div class="line"><a name="l00948"></a><span class="lineno">  948</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwSuggestedBufferSize=&quot;</span> + dwSuggestedBufferSize);</div><div class="line"><a name="l00949"></a><span class="lineno">  949</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwWidth=&quot;</span> + dwWidth);</div><div class="line"><a name="l00950"></a><span class="lineno">  950</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwHeight=&quot;</span> + dwHeight);</div><div class="line"><a name="l00951"></a><span class="lineno">  951</span>&#160;    }</div><div class="line"><a name="l00952"></a><span class="lineno">  952</span>&#160;  }</div><div class="line"><a name="l00953"></a><span class="lineno">  953</span>&#160;</div><div class="line"><a name="l00958"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a05011c9bdfcfe2e5b3489416fb12ff87">  958</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a05011c9bdfcfe2e5b3489416fb12ff87">readAVIX</a>(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00959"></a><span class="lineno">  959</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00960"></a><span class="lineno">  960</span>&#160;      IJ.log(<span class="stringliteral">&quot;Trying to read AVIX&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l00961"></a><span class="lineno">  961</span>&#160;    <span class="keywordtype">int</span> riffType = readInt();</div><div class="line"><a name="l00962"></a><span class="lineno">  962</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l00963"></a><span class="lineno">  963</span>&#160;      IJ.log(<span class="stringliteral">&quot;File header: RIFF type=&#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(riffType) + <span class="stringliteral">&quot;&#39; (should be &#39;AVIX&#39;)&quot;</span>);</div><div class="line"><a name="l00964"></a><span class="lineno">  964</span>&#160;    <span class="keywordflow">if</span> (riffType != FOURCC_AVIX)</div><div class="line"><a name="l00965"></a><span class="lineno">  965</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Not an AVI file.&quot;</span>);</div><div class="line"><a name="l00966"></a><span class="lineno">  966</span>&#160;    <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_movi, <span class="keyword">true</span>, fileSize, <span class="keyword">true</span>); <span class="comment">// read movie data</span></div><div class="line"><a name="l00967"></a><span class="lineno">  967</span>&#160;  }</div><div class="line"><a name="l00968"></a><span class="lineno">  968</span>&#160;</div><div class="line"><a name="l00972"></a><span class="lineno">  972</span>&#160;  <span class="keywordtype">void</span> readBitMapInfo(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l00973"></a><span class="lineno">  973</span>&#160;    biSize = readInt();</div><div class="line"><a name="l00974"></a><span class="lineno">  974</span>&#160;    biWidth = readInt();</div><div class="line"><a name="l00975"></a><span class="lineno">  975</span>&#160;    biHeight = readInt();</div><div class="line"><a name="l00976"></a><span class="lineno">  976</span>&#160;    biPlanes = readShort();</div><div class="line"><a name="l00977"></a><span class="lineno">  977</span>&#160;    biBitCount = readShort();</div><div class="line"><a name="l00978"></a><span class="lineno">  978</span>&#160;    biCompression = readInt();</div><div class="line"><a name="l00979"></a><span class="lineno">  979</span>&#160;    biSizeImage = readInt();</div><div class="line"><a name="l00980"></a><span class="lineno">  980</span>&#160;    biXPelsPerMeter = readInt();</div><div class="line"><a name="l00981"></a><span class="lineno">  981</span>&#160;    biYPelsPerMeter = readInt();</div><div class="line"><a name="l00982"></a><span class="lineno">  982</span>&#160;    biClrUsed = readInt();</div><div class="line"><a name="l00983"></a><span class="lineno">  983</span>&#160;    biClrImportant = readInt();</div><div class="line"><a name="l00984"></a><span class="lineno">  984</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l00985"></a><span class="lineno">  985</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biSize=&quot;</span> + biSize);</div><div class="line"><a name="l00986"></a><span class="lineno">  986</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biWidth=&quot;</span> + biWidth);</div><div class="line"><a name="l00987"></a><span class="lineno">  987</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biHeight=&quot;</span> + biHeight);</div><div class="line"><a name="l00988"></a><span class="lineno">  988</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biPlanes=&quot;</span> + biPlanes);</div><div class="line"><a name="l00989"></a><span class="lineno">  989</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biBitCount=&quot;</span> + biBitCount);</div><div class="line"><a name="l00990"></a><span class="lineno">  990</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biCompression=0x&quot;</span> + Integer.toHexString(biCompression) + <span class="stringliteral">&quot; &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(biCompression) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div><div class="line"><a name="l00991"></a><span class="lineno">  991</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biSizeImage=&quot;</span> + biSizeImage);</div><div class="line"><a name="l00992"></a><span class="lineno">  992</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biXPelsPerMeter=&quot;</span> + biXPelsPerMeter);</div><div class="line"><a name="l00993"></a><span class="lineno">  993</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biYPelsPerMeter=&quot;</span> + biYPelsPerMeter);</div><div class="line"><a name="l00994"></a><span class="lineno">  994</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biClrUsed=&quot;</span> + biClrUsed);</div><div class="line"><a name="l00995"></a><span class="lineno">  995</span>&#160;      IJ.log(<span class="stringliteral">&quot;   biClrImportant=&quot;</span> + biClrImportant);</div><div class="line"><a name="l00996"></a><span class="lineno">  996</span>&#160;    }</div><div class="line"><a name="l00997"></a><span class="lineno">  997</span>&#160;</div><div class="line"><a name="l00998"></a><span class="lineno">  998</span>&#160;    <span class="keywordtype">int</span> allowedBitCount = 0;</div><div class="line"><a name="l00999"></a><span class="lineno">  999</span>&#160;    <span class="keywordtype">boolean</span> readPalette = <span class="keyword">false</span>;</div><div class="line"><a name="l01000"></a><span class="lineno"> 1000</span>&#160;    <span class="keywordflow">switch</span> (biCompression) {</div><div class="line"><a name="l01001"></a><span class="lineno"> 1001</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION:</div><div class="line"><a name="l01002"></a><span class="lineno"> 1002</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_RGB:</div><div class="line"><a name="l01003"></a><span class="lineno"> 1003</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_RAW:</div><div class="line"><a name="l01004"></a><span class="lineno"> 1004</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">NO_COMPRESSION</a>;</div><div class="line"><a name="l01005"></a><span class="lineno"> 1005</span>&#160;      dataTopDown = biHeight &lt; 0; <span class="comment">// RGB mode is usually bottom-up, negative</span></div><div class="line"><a name="l01006"></a><span class="lineno"> 1006</span>&#160;                                  <span class="comment">// height signals top-down</span></div><div class="line"><a name="l01007"></a><span class="lineno"> 1007</span>&#160;      allowedBitCount = 8 | BITMASK24 | 32; <span class="comment">// we don&#39;t support 1, 2 and 4</span></div><div class="line"><a name="l01008"></a><span class="lineno"> 1008</span>&#160;                                            <span class="comment">// byte data</span></div><div class="line"><a name="l01009"></a><span class="lineno"> 1009</span>&#160;      readPalette = biBitCount &lt;= 8;</div><div class="line"><a name="l01010"></a><span class="lineno"> 1010</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01011"></a><span class="lineno"> 1011</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_Y8:</div><div class="line"><a name="l01012"></a><span class="lineno"> 1012</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_GREY:</div><div class="line"><a name="l01013"></a><span class="lineno"> 1013</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_Y800:</div><div class="line"><a name="l01014"></a><span class="lineno"> 1014</span>&#160;      dataTopDown = <span class="keyword">true</span>;</div><div class="line"><a name="l01015"></a><span class="lineno"> 1015</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">NO_COMPRESSION</a>;</div><div class="line"><a name="l01016"></a><span class="lineno"> 1016</span>&#160;      allowedBitCount = 8;</div><div class="line"><a name="l01017"></a><span class="lineno"> 1017</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01018"></a><span class="lineno"> 1018</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_Y16:</div><div class="line"><a name="l01019"></a><span class="lineno"> 1019</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION_MIL:</div><div class="line"><a name="l01020"></a><span class="lineno"> 1020</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">NO_COMPRESSION</a>;</div><div class="line"><a name="l01021"></a><span class="lineno"> 1021</span>&#160;      allowedBitCount = 16;</div><div class="line"><a name="l01022"></a><span class="lineno"> 1022</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01023"></a><span class="lineno"> 1023</span>&#160;    <span class="keywordflow">case</span> AYUV_COMPRESSION:</div><div class="line"><a name="l01024"></a><span class="lineno"> 1024</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0416d25470c685f6657b2a6b1f25e48c">AYUV_COMPRESSION</a>;</div><div class="line"><a name="l01025"></a><span class="lineno"> 1025</span>&#160;      allowedBitCount = 32;</div><div class="line"><a name="l01026"></a><span class="lineno"> 1026</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01027"></a><span class="lineno"> 1027</span>&#160;    <span class="keywordflow">case</span> UYVY_COMPRESSION:</div><div class="line"><a name="l01028"></a><span class="lineno"> 1028</span>&#160;    <span class="keywordflow">case</span> UYNV_COMPRESSION:</div><div class="line"><a name="l01029"></a><span class="lineno"> 1029</span>&#160;      dataTopDown = <span class="keyword">true</span>;</div><div class="line"><a name="l01030"></a><span class="lineno"> 1030</span>&#160;    <span class="keywordflow">case</span> CYUV_COMPRESSION: <span class="comment">// same, not top-down</span></div><div class="line"><a name="l01031"></a><span class="lineno"> 1031</span>&#160;    <span class="keywordflow">case</span> V422_COMPRESSION:</div><div class="line"><a name="l01032"></a><span class="lineno"> 1032</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afee2b0fe721d4be2e5d6edec9eef0e09">UYVY_COMPRESSION</a>;</div><div class="line"><a name="l01033"></a><span class="lineno"> 1033</span>&#160;      allowedBitCount = 16;</div><div class="line"><a name="l01034"></a><span class="lineno"> 1034</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01035"></a><span class="lineno"> 1035</span>&#160;    <span class="keywordflow">case</span> YUY2_COMPRESSION:</div><div class="line"><a name="l01036"></a><span class="lineno"> 1036</span>&#160;    <span class="keywordflow">case</span> YUNV_COMPRESSION:</div><div class="line"><a name="l01037"></a><span class="lineno"> 1037</span>&#160;    <span class="keywordflow">case</span> YUYV_COMPRESSION:</div><div class="line"><a name="l01038"></a><span class="lineno"> 1038</span>&#160;      dataTopDown = <span class="keyword">true</span>;</div><div class="line"><a name="l01039"></a><span class="lineno"> 1039</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#acf3deb2ecb0e067f80f2dc6a2f34f010">YUY2_COMPRESSION</a>;</div><div class="line"><a name="l01040"></a><span class="lineno"> 1040</span>&#160;      allowedBitCount = 16;</div><div class="line"><a name="l01041"></a><span class="lineno"> 1041</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01042"></a><span class="lineno"> 1042</span>&#160;    <span class="keywordflow">case</span> YVYU_COMPRESSION:</div><div class="line"><a name="l01043"></a><span class="lineno"> 1043</span>&#160;      dataTopDown = <span class="keyword">true</span>;</div><div class="line"><a name="l01044"></a><span class="lineno"> 1044</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a61f851865cb3fb2ac79662c76f75d1e1">YVYU_COMPRESSION</a>;</div><div class="line"><a name="l01045"></a><span class="lineno"> 1045</span>&#160;      allowedBitCount = 16;</div><div class="line"><a name="l01046"></a><span class="lineno"> 1046</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01047"></a><span class="lineno"> 1047</span>&#160;    <span class="keywordflow">case</span> JPEG_COMPRESSION:</div><div class="line"><a name="l01048"></a><span class="lineno"> 1048</span>&#160;    <span class="keywordflow">case</span> JPEG_COMPRESSION2:</div><div class="line"><a name="l01049"></a><span class="lineno"> 1049</span>&#160;    <span class="keywordflow">case</span> JPEG_COMPRESSION3:</div><div class="line"><a name="l01050"></a><span class="lineno"> 1050</span>&#160;    <span class="keywordflow">case</span> MJPG_COMPRESSION:</div><div class="line"><a name="l01051"></a><span class="lineno"> 1051</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e950b01e3308a25915da47063657900">JPEG_COMPRESSION</a>;</div><div class="line"><a name="l01052"></a><span class="lineno"> 1052</span>&#160;      variableLength = <span class="keyword">true</span>;</div><div class="line"><a name="l01053"></a><span class="lineno"> 1053</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01054"></a><span class="lineno"> 1054</span>&#160;    <span class="keywordflow">case</span> PNG_COMPRESSION:</div><div class="line"><a name="l01055"></a><span class="lineno"> 1055</span>&#160;    <span class="keywordflow">case</span> PNG_COMPRESSION2:</div><div class="line"><a name="l01056"></a><span class="lineno"> 1056</span>&#160;    <span class="keywordflow">case</span> PNG_COMPRESSION3:</div><div class="line"><a name="l01057"></a><span class="lineno"> 1057</span>&#160;      variableLength = <span class="keyword">true</span>;</div><div class="line"><a name="l01058"></a><span class="lineno"> 1058</span>&#160;      dataCompression = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a35f0e3b79e23892ab4cf6b8e2628bef7">PNG_COMPRESSION</a>;</div><div class="line"><a name="l01059"></a><span class="lineno"> 1059</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01060"></a><span class="lineno"> 1060</span>&#160;    <span class="keywordflow">default</span>:</div><div class="line"><a name="l01061"></a><span class="lineno"> 1061</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Unsupported compression: &quot;</span> + Integer.toHexString(biCompression)</div><div class="line"><a name="l01062"></a><span class="lineno"> 1062</span>&#160;          + (biCompression &gt;= 0x20202020 ? <span class="stringliteral">&quot; &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(biCompression) + <span class="stringliteral">&quot;&#39;&quot;</span> : <span class="stringliteral">&quot;&quot;</span>));</div><div class="line"><a name="l01063"></a><span class="lineno"> 1063</span>&#160;    }</div><div class="line"><a name="l01064"></a><span class="lineno"> 1064</span>&#160;</div><div class="line"><a name="l01065"></a><span class="lineno"> 1065</span>&#160;    <span class="keywordtype">int</span> bitCountTest = biBitCount == 24 ? BITMASK24 : <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a949422fb2bb2aa1b70307b7591def9">biBitCount</a>; <span class="comment">// convert</span></div><div class="line"><a name="l01066"></a><span class="lineno"> 1066</span>&#160;                                                                  <span class="comment">// &quot;24&quot; to a</span></div><div class="line"><a name="l01067"></a><span class="lineno"> 1067</span>&#160;                                                                  <span class="comment">// flag</span></div><div class="line"><a name="l01068"></a><span class="lineno"> 1068</span>&#160;    <span class="keywordflow">if</span> (allowedBitCount != 0 &amp;&amp; (bitCountTest &amp; allowedBitCount) == 0)</div><div class="line"><a name="l01069"></a><span class="lineno"> 1069</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(</div><div class="line"><a name="l01070"></a><span class="lineno"> 1070</span>&#160;          <span class="stringliteral">&quot;Unsupported: &quot;</span> + biBitCount + <span class="stringliteral">&quot; bits/pixel for compression &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(biCompression) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div><div class="line"><a name="l01071"></a><span class="lineno"> 1071</span>&#160;</div><div class="line"><a name="l01072"></a><span class="lineno"> 1072</span>&#160;    <span class="keywordflow">if</span> (biHeight &lt; 0) <span class="comment">// negative height was for top-down data in RGB mode</span></div><div class="line"><a name="l01073"></a><span class="lineno"> 1073</span>&#160;      biHeight = -<a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>;</div><div class="line"><a name="l01074"></a><span class="lineno"> 1074</span>&#160;</div><div class="line"><a name="l01075"></a><span class="lineno"> 1075</span>&#160;    <span class="comment">// Scan line is padded with zeroes to be a multiple of four bytes</span></div><div class="line"><a name="l01076"></a><span class="lineno"> 1076</span>&#160;    scanLineSize = ((biWidth * biBitCount + 31) / 32) * 4;</div><div class="line"><a name="l01077"></a><span class="lineno"> 1077</span>&#160;</div><div class="line"><a name="l01078"></a><span class="lineno"> 1078</span>&#160;    <span class="comment">// a value of biClrUsed=0 means we determine this based on the bits per</span></div><div class="line"><a name="l01079"></a><span class="lineno"> 1079</span>&#160;    <span class="comment">// pixel</span></div><div class="line"><a name="l01080"></a><span class="lineno"> 1080</span>&#160;    <span class="keywordflow">if</span> (readPalette &amp;&amp; biClrUsed == 0)</div><div class="line"><a name="l01081"></a><span class="lineno"> 1081</span>&#160;      biClrUsed = 1 &lt;&lt; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a949422fb2bb2aa1b70307b7591def9">biBitCount</a>;</div><div class="line"><a name="l01082"></a><span class="lineno"> 1082</span>&#160;</div><div class="line"><a name="l01083"></a><span class="lineno"> 1083</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l01084"></a><span class="lineno"> 1084</span>&#160;      IJ.log(<span class="stringliteral">&quot;   &gt; data compression=0x&quot;</span> + Integer.toHexString(dataCompression) + <span class="stringliteral">&quot; &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(dataCompression)</div><div class="line"><a name="l01085"></a><span class="lineno"> 1085</span>&#160;          + <span class="stringliteral">&quot;&#39;&quot;</span>);</div><div class="line"><a name="l01086"></a><span class="lineno"> 1086</span>&#160;      IJ.log(<span class="stringliteral">&quot;   &gt; palette colors=&quot;</span> + biClrUsed);</div><div class="line"><a name="l01087"></a><span class="lineno"> 1087</span>&#160;      IJ.log(<span class="stringliteral">&quot;   &gt; scan line size=&quot;</span> + scanLineSize);</div><div class="line"><a name="l01088"></a><span class="lineno"> 1088</span>&#160;      IJ.log(<span class="stringliteral">&quot;   &gt; data top down=&quot;</span> + dataTopDown);</div><div class="line"><a name="l01089"></a><span class="lineno"> 1089</span>&#160;    }</div><div class="line"><a name="l01090"></a><span class="lineno"> 1090</span>&#160;</div><div class="line"><a name="l01091"></a><span class="lineno"> 1091</span>&#160;    <span class="comment">// read color palette</span></div><div class="line"><a name="l01092"></a><span class="lineno"> 1092</span>&#160;    <span class="keywordflow">if</span> (readPalette) {</div><div class="line"><a name="l01093"></a><span class="lineno"> 1093</span>&#160;      <span class="keywordtype">long</span> spaceForPalette = endPosition - raFile.getFilePointer();</div><div class="line"><a name="l01094"></a><span class="lineno"> 1094</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01095"></a><span class="lineno"> 1095</span>&#160;        IJ.log(<span class="stringliteral">&quot;   Reading &quot;</span> + biClrUsed + <span class="stringliteral">&quot; Palette colors: &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(spaceForPalette));</div><div class="line"><a name="l01096"></a><span class="lineno"> 1096</span>&#160;      <span class="keywordflow">if</span> (spaceForPalette &lt; biClrUsed * 4)</div><div class="line"><a name="l01097"></a><span class="lineno"> 1097</span>&#160;        <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Not enough data (&quot;</span> + spaceForPalette + <span class="stringliteral">&quot;) for palette of size &quot;</span> + (biClrUsed * 4));</div><div class="line"><a name="l01098"></a><span class="lineno"> 1098</span>&#160;      byte[] pr = <span class="keyword">new</span> byte[<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">biClrUsed</a>];</div><div class="line"><a name="l01099"></a><span class="lineno"> 1099</span>&#160;      byte[] pg = <span class="keyword">new</span> byte[<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">biClrUsed</a>];</div><div class="line"><a name="l01100"></a><span class="lineno"> 1100</span>&#160;      byte[] pb = <span class="keyword">new</span> byte[<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">biClrUsed</a>];</div><div class="line"><a name="l01101"></a><span class="lineno"> 1101</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">biClrUsed</a>; i++) {</div><div class="line"><a name="l01102"></a><span class="lineno"> 1102</span>&#160;        pb[i] = raFile.readByte();</div><div class="line"><a name="l01103"></a><span class="lineno"> 1103</span>&#160;        pg[i] = raFile.readByte();</div><div class="line"><a name="l01104"></a><span class="lineno"> 1104</span>&#160;        pr[i] = raFile.readByte();</div><div class="line"><a name="l01105"></a><span class="lineno"> 1105</span>&#160;        raFile.readByte();</div><div class="line"><a name="l01106"></a><span class="lineno"> 1106</span>&#160;      }</div><div class="line"><a name="l01107"></a><span class="lineno"> 1107</span>&#160;      cm = <span class="keyword">new</span> IndexColorModel(biBitCount, biClrUsed, pr, pg, pb);</div><div class="line"><a name="l01108"></a><span class="lineno"> 1108</span>&#160;    }</div><div class="line"><a name="l01109"></a><span class="lineno"> 1109</span>&#160;  }</div><div class="line"><a name="l01110"></a><span class="lineno"> 1110</span>&#160;</div><div class="line"><a name="l01116"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a7a8a9e1a6cdb0c23f0920887559e20fa"> 1116</a></span>&#160;  <span class="keyword">private</span> Object <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7a8a9e1a6cdb0c23f0920887559e20fa">readCompressedFrame</a>(RandomAccessFile rFile, <span class="keywordtype">int</span> size) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01117"></a><span class="lineno"> 1117</span>&#160;    InputStream inputStream = <span class="keyword">new</span> raInputStream(rFile, size, biCompression == MJPG_COMPRESSION);</div><div class="line"><a name="l01118"></a><span class="lineno"> 1118</span>&#160;    BufferedImage bi = ImageIO.read(inputStream);</div><div class="line"><a name="l01119"></a><span class="lineno"> 1119</span>&#160;    <span class="keywordflow">if</span> (bi == null)</div><div class="line"><a name="l01120"></a><span class="lineno"> 1120</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;can&#39;t read frame, ImageIO returns null&quot;</span>);</div><div class="line"><a name="l01121"></a><span class="lineno"> 1121</span>&#160;    <span class="keywordtype">int</span> type = bi.getType();</div><div class="line"><a name="l01122"></a><span class="lineno"> 1122</span>&#160;    ImageProcessor ip = null;</div><div class="line"><a name="l01123"></a><span class="lineno"> 1123</span>&#160;    <span class="comment">// IJ.log(&quot;BufferedImage Type=&quot;+type);</span></div><div class="line"><a name="l01124"></a><span class="lineno"> 1124</span>&#160;    <span class="keywordflow">if</span> (type == BufferedImage.TYPE_BYTE_GRAY) {</div><div class="line"><a name="l01125"></a><span class="lineno"> 1125</span>&#160;      ip = <span class="keyword">new</span> ByteProcessor(bi);</div><div class="line"><a name="l01126"></a><span class="lineno"> 1126</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (type == bi.TYPE_BYTE_INDEXED) {</div><div class="line"><a name="l01127"></a><span class="lineno"> 1127</span>&#160;      cm = bi.getColorModel();</div><div class="line"><a name="l01128"></a><span class="lineno"> 1128</span>&#160;      ip = <span class="keyword">new</span> ByteProcessor((Image) bi);</div><div class="line"><a name="l01129"></a><span class="lineno"> 1129</span>&#160;    } <span class="keywordflow">else</span></div><div class="line"><a name="l01130"></a><span class="lineno"> 1130</span>&#160;      ip = <span class="keyword">new</span> ColorProcessor(bi);</div><div class="line"><a name="l01131"></a><span class="lineno"> 1131</span>&#160;    <span class="keywordflow">if</span> (convertToGray)</div><div class="line"><a name="l01132"></a><span class="lineno"> 1132</span>&#160;      ip = ip.convertToByte(<span class="keyword">false</span>);</div><div class="line"><a name="l01133"></a><span class="lineno"> 1133</span>&#160;    <span class="keywordflow">if</span> (flipVertical)</div><div class="line"><a name="l01134"></a><span class="lineno"> 1134</span>&#160;      ip.flipVertical();</div><div class="line"><a name="l01135"></a><span class="lineno"> 1135</span>&#160;    <span class="keywordflow">return</span> ip.getPixels();</div><div class="line"><a name="l01136"></a><span class="lineno"> 1136</span>&#160;  }</div><div class="line"><a name="l01137"></a><span class="lineno"> 1137</span>&#160;</div><div class="line"><a name="l01139"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a85350caab45622b078587a67833fe2b4"> 1139</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a85350caab45622b078587a67833fe2b4">readContents</a>(<span class="keywordtype">int</span> fourcc, <span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01140"></a><span class="lineno"> 1140</span>&#160;    <span class="keywordflow">switch</span> (fourcc) {</div><div class="line"><a name="l01141"></a><span class="lineno"> 1141</span>&#160;    <span class="keywordflow">case</span> FOURCC_hdrl:</div><div class="line"><a name="l01142"></a><span class="lineno"> 1142</span>&#160;      headerPositionEnd = endPosition;</div><div class="line"><a name="l01143"></a><span class="lineno"> 1143</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_avih, <span class="keyword">false</span>, endPosition, <span class="keyword">true</span>);</div><div class="line"><a name="l01144"></a><span class="lineno"> 1144</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_strl, <span class="keyword">true</span>, endPosition, <span class="keyword">true</span>);</div><div class="line"><a name="l01145"></a><span class="lineno"> 1145</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01146"></a><span class="lineno"> 1146</span>&#160;    <span class="keywordflow">case</span> FOURCC_avih:</div><div class="line"><a name="l01147"></a><span class="lineno"> 1147</span>&#160;      readAviHeader();</div><div class="line"><a name="l01148"></a><span class="lineno"> 1148</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01149"></a><span class="lineno"> 1149</span>&#160;    <span class="keywordflow">case</span> FOURCC_strl:</div><div class="line"><a name="l01150"></a><span class="lineno"> 1150</span>&#160;      <span class="keywordtype">long</span> nextPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_strh, <span class="keyword">false</span>, endPosition, <span class="keyword">false</span>);</div><div class="line"><a name="l01151"></a><span class="lineno"> 1151</span>&#160;      <span class="keywordflow">if</span> (nextPosition &lt; 0)</div><div class="line"><a name="l01152"></a><span class="lineno"> 1152</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01153"></a><span class="lineno"> 1153</span>&#160;      indexPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_strf, <span class="keyword">false</span>, endPosition, <span class="keyword">true</span>);</div><div class="line"><a name="l01154"></a><span class="lineno"> 1154</span>&#160;      indexPositionEnd = endPosition;</div><div class="line"><a name="l01155"></a><span class="lineno"> 1155</span>&#160;      indexForCountingOnly = <span class="keyword">true</span>; <span class="comment">// try reading indx for counting number of</span></div><div class="line"><a name="l01156"></a><span class="lineno"> 1156</span>&#160;                                   <span class="comment">// entries</span></div><div class="line"><a name="l01157"></a><span class="lineno"> 1157</span>&#160;      totalFramesFromIndex = 0;</div><div class="line"><a name="l01158"></a><span class="lineno"> 1158</span>&#160;      nextPosition = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">findFourccAndRead</a>(FOURCC_indx, <span class="keyword">false</span>, endPosition, <span class="keyword">false</span>);</div><div class="line"><a name="l01159"></a><span class="lineno"> 1159</span>&#160;      <span class="keywordflow">if</span> (nextPosition &gt; 0 &amp;&amp; totalFramesFromIndex &gt; dwTotalFrames)</div><div class="line"><a name="l01160"></a><span class="lineno"> 1160</span>&#160;        dwTotalFrames = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aa71c4bd35a9fe20e158956bd2cb25b28">totalFramesFromIndex</a>;</div><div class="line"><a name="l01161"></a><span class="lineno"> 1161</span>&#160;      indexForCountingOnly = <span class="keyword">false</span>;</div><div class="line"><a name="l01162"></a><span class="lineno"> 1162</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01163"></a><span class="lineno"> 1163</span>&#160;    <span class="keywordflow">case</span> FOURCC_strh:</div><div class="line"><a name="l01164"></a><span class="lineno"> 1164</span>&#160;      <span class="keywordtype">int</span> streamType = readInt();</div><div class="line"><a name="l01165"></a><span class="lineno"> 1165</span>&#160;      <span class="keywordflow">if</span> (streamType != FOURCC_vids) {</div><div class="line"><a name="l01166"></a><span class="lineno"> 1166</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01167"></a><span class="lineno"> 1167</span>&#160;          IJ.log(<span class="stringliteral">&quot;Non-video Stream &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(streamType) + <span class="stringliteral">&quot; skipped&quot;</span>);</div><div class="line"><a name="l01168"></a><span class="lineno"> 1168</span>&#160;        streamNumber++;</div><div class="line"><a name="l01169"></a><span class="lineno"> 1169</span>&#160;        <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01170"></a><span class="lineno"> 1170</span>&#160;      }</div><div class="line"><a name="l01171"></a><span class="lineno"> 1171</span>&#160;      readStreamHeader();</div><div class="line"><a name="l01172"></a><span class="lineno"> 1172</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01173"></a><span class="lineno"> 1173</span>&#160;    <span class="keywordflow">case</span> FOURCC_strf:</div><div class="line"><a name="l01174"></a><span class="lineno"> 1174</span>&#160;      readBitMapInfo(endPosition);</div><div class="line"><a name="l01175"></a><span class="lineno"> 1175</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01176"></a><span class="lineno"> 1176</span>&#160;    <span class="keywordflow">case</span> FOURCC_indx:</div><div class="line"><a name="l01177"></a><span class="lineno"> 1177</span>&#160;    <span class="keywordflow">case</span> FOURCC_ix00:</div><div class="line"><a name="l01178"></a><span class="lineno"> 1178</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ad22821cde3b5326489f24ad437513919">readAvi2Index</a>(endPosition);</div><div class="line"><a name="l01179"></a><span class="lineno"> 1179</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01180"></a><span class="lineno"> 1180</span>&#160;    <span class="keywordflow">case</span> FOURCC_idx1:</div><div class="line"><a name="l01181"></a><span class="lineno"> 1181</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aea9045a6694e8ada35565a2072f9dc85">readOldFrameIndex</a>(endPosition);</div><div class="line"><a name="l01182"></a><span class="lineno"> 1182</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01183"></a><span class="lineno"> 1183</span>&#160;    <span class="keywordflow">case</span> FOURCC_RIFF:</div><div class="line"><a name="l01184"></a><span class="lineno"> 1184</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a05011c9bdfcfe2e5b3489416fb12ff87">readAVIX</a>(endPosition);</div><div class="line"><a name="l01185"></a><span class="lineno"> 1185</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01186"></a><span class="lineno"> 1186</span>&#160;    <span class="keywordflow">case</span> FOURCC_movi:</div><div class="line"><a name="l01187"></a><span class="lineno"> 1187</span>&#160;      readMovieData(endPosition);</div><div class="line"><a name="l01188"></a><span class="lineno"> 1188</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01189"></a><span class="lineno"> 1189</span>&#160;    }</div><div class="line"><a name="l01190"></a><span class="lineno"> 1190</span>&#160;    <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Program error, type &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fourcc));</div><div class="line"><a name="l01191"></a><span class="lineno"> 1191</span>&#160;  }</div><div class="line"><a name="l01192"></a><span class="lineno"> 1192</span>&#160;</div><div class="line"><a name="l01197"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a398f49f5494ee8c68e125e2910c09c71"> 1197</a></span>&#160;  <span class="keyword">private</span> Object <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a398f49f5494ee8c68e125e2910c09c71">readFixedLengthFrame</a>(RandomAccessFile rFile, <span class="keywordtype">int</span> size) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01198"></a><span class="lineno"> 1198</span>&#160;    <span class="keywordflow">if</span> (size &lt; scanLineSize * biHeight) <span class="comment">// check minimum size (fixed frame</span></div><div class="line"><a name="l01199"></a><span class="lineno"> 1199</span>&#160;                                        <span class="comment">// length format)</span></div><div class="line"><a name="l01200"></a><span class="lineno"> 1200</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Data chunk size &quot;</span> + size + <span class="stringliteral">&quot; too short (&quot;</span> + (scanLineSize * biHeight) + <span class="stringliteral">&quot; required)&quot;</span>);</div><div class="line"><a name="l01201"></a><span class="lineno"> 1201</span>&#160;    byte[] rawData = <span class="keyword">new</span> byte[size];</div><div class="line"><a name="l01202"></a><span class="lineno"> 1202</span>&#160;    <span class="keywordtype">int</span> n = rFile.read(rawData, 0, size);</div><div class="line"><a name="l01203"></a><span class="lineno"> 1203</span>&#160;    <span class="keywordflow">if</span> (n &lt; rawData.length)</div><div class="line"><a name="l01204"></a><span class="lineno"> 1204</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Frame ended prematurely after &quot;</span> + n + <span class="stringliteral">&quot; bytes&quot;</span>);</div><div class="line"><a name="l01205"></a><span class="lineno"> 1205</span>&#160;</div><div class="line"><a name="l01206"></a><span class="lineno"> 1206</span>&#160;    <span class="keywordtype">boolean</span> topDown = flipVertical ? !dataTopDown : <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a5ee060949ab9bce8c73729050bc737a2">dataTopDown</a>;</div><div class="line"><a name="l01207"></a><span class="lineno"> 1207</span>&#160;    Object pixels = null;</div><div class="line"><a name="l01208"></a><span class="lineno"> 1208</span>&#160;    byte[] bPixels = null;</div><div class="line"><a name="l01209"></a><span class="lineno"> 1209</span>&#160;    <span class="keywordtype">int</span>[] cPixels = null;</div><div class="line"><a name="l01210"></a><span class="lineno"> 1210</span>&#160;    <span class="keywordtype">short</span>[] sPixels = null;</div><div class="line"><a name="l01211"></a><span class="lineno"> 1211</span>&#160;    <span class="keywordflow">if</span> (biBitCount &lt;= 8 || convertToGray) {</div><div class="line"><a name="l01212"></a><span class="lineno"> 1212</span>&#160;      bPixels = <span class="keyword">new</span> byte[dwWidth * <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>];</div><div class="line"><a name="l01213"></a><span class="lineno"> 1213</span>&#160;      pixels = bPixels;</div><div class="line"><a name="l01214"></a><span class="lineno"> 1214</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (biBitCount == 16 &amp;&amp; dataCompression == NO_COMPRESSION) {</div><div class="line"><a name="l01215"></a><span class="lineno"> 1215</span>&#160;      sPixels = <span class="keyword">new</span> <span class="keywordtype">short</span>[dwWidth * <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>];</div><div class="line"><a name="l01216"></a><span class="lineno"> 1216</span>&#160;      pixels = sPixels;</div><div class="line"><a name="l01217"></a><span class="lineno"> 1217</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01218"></a><span class="lineno"> 1218</span>&#160;      cPixels = <span class="keyword">new</span> <span class="keywordtype">int</span>[dwWidth * <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">biHeight</a>];</div><div class="line"><a name="l01219"></a><span class="lineno"> 1219</span>&#160;      pixels = cPixels;</div><div class="line"><a name="l01220"></a><span class="lineno"> 1220</span>&#160;    }</div><div class="line"><a name="l01221"></a><span class="lineno"> 1221</span>&#160;    <span class="keywordtype">int</span> offset = topDown ? 0 : (biHeight - 1) * dwWidth;</div><div class="line"><a name="l01222"></a><span class="lineno"> 1222</span>&#160;    <span class="keywordtype">int</span> rawOffset = 0;</div><div class="line"><a name="l01223"></a><span class="lineno"> 1223</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = biHeight - 1; i &gt;= 0; i--) { <span class="comment">// for all lines</span></div><div class="line"><a name="l01224"></a><span class="lineno"> 1224</span>&#160;      <span class="keywordflow">if</span> (biBitCount &lt;= 8)</div><div class="line"><a name="l01225"></a><span class="lineno"> 1225</span>&#160;        unpack8bit(rawData, rawOffset, bPixels, offset, dwWidth);</div><div class="line"><a name="l01226"></a><span class="lineno"> 1226</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (convertToGray)</div><div class="line"><a name="l01227"></a><span class="lineno"> 1227</span>&#160;        unpackGray(rawData, rawOffset, bPixels, offset, dwWidth);</div><div class="line"><a name="l01228"></a><span class="lineno"> 1228</span>&#160;      <span class="keywordflow">else</span> <span class="keywordflow">if</span> (biBitCount == 16 &amp;&amp; dataCompression == NO_COMPRESSION)</div><div class="line"><a name="l01229"></a><span class="lineno"> 1229</span>&#160;        unpackShort(rawData, rawOffset, sPixels, offset, dwWidth);</div><div class="line"><a name="l01230"></a><span class="lineno"> 1230</span>&#160;      <span class="keywordflow">else</span></div><div class="line"><a name="l01231"></a><span class="lineno"> 1231</span>&#160;        unpack(rawData, rawOffset, cPixels, offset, dwWidth);</div><div class="line"><a name="l01232"></a><span class="lineno"> 1232</span>&#160;      rawOffset += <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a270bcae68f2d35537d6eb66edce16058">scanLineSize</a>;</div><div class="line"><a name="l01233"></a><span class="lineno"> 1233</span>&#160;      offset += topDown ? dwWidth : -<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a08c43e3e1b584ab46351d34f5e673d52">dwWidth</a>;</div><div class="line"><a name="l01234"></a><span class="lineno"> 1234</span>&#160;    }</div><div class="line"><a name="l01235"></a><span class="lineno"> 1235</span>&#160;    <span class="keywordflow">return</span> pixels;</div><div class="line"><a name="l01236"></a><span class="lineno"> 1236</span>&#160;  }</div><div class="line"><a name="l01237"></a><span class="lineno"> 1237</span>&#160;</div><div class="line"><a name="l01239"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a4a25d354ac0e1c0771dde30e7e7379ae"> 1239</a></span>&#160;  <span class="keyword">private</span> Object <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a25d354ac0e1c0771dde30e7e7379ae">readFrame</a>(RandomAccessFile rFile, <span class="keywordtype">long</span> filePos, <span class="keywordtype">int</span> size) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01240"></a><span class="lineno"> 1240</span>&#160;    rFile.seek(filePos);</div><div class="line"><a name="l01241"></a><span class="lineno"> 1241</span>&#160;    <span class="comment">// if (verbose)</span></div><div class="line"><a name="l01242"></a><span class="lineno"> 1242</span>&#160;    <span class="comment">// IJ.log(&quot;virtual AVI: readFrame @&quot;+posSizeString(filePos, size));</span></div><div class="line"><a name="l01243"></a><span class="lineno"> 1243</span>&#160;    <span class="keywordflow">if</span> (variableLength) <span class="comment">// JPEG or PNG-compressed frames</span></div><div class="line"><a name="l01244"></a><span class="lineno"> 1244</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7a8a9e1a6cdb0c23f0920887559e20fa">readCompressedFrame</a>(rFile, size);</div><div class="line"><a name="l01245"></a><span class="lineno"> 1245</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l01246"></a><span class="lineno"> 1246</span>&#160;      <span class="keywordflow">return</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a398f49f5494ee8c68e125e2910c09c71">readFixedLengthFrame</a>(rFile, size);</div><div class="line"><a name="l01247"></a><span class="lineno"> 1247</span>&#160;  }</div><div class="line"><a name="l01248"></a><span class="lineno"> 1248</span>&#160;</div><div class="line"><a name="l01254"></a><span class="lineno"> 1254</span>&#160;  <span class="keyword">final</span> <span class="keywordtype">int</span> readInt() <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l01255"></a><span class="lineno"> 1255</span>&#160;    <span class="keywordtype">int</span> result = 0;</div><div class="line"><a name="l01256"></a><span class="lineno"> 1256</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> shiftBy = 0; shiftBy &lt; 32; shiftBy += 8)</div><div class="line"><a name="l01257"></a><span class="lineno"> 1257</span>&#160;      result |= (raFile.readByte() &amp; 0xff) &lt;&lt; shiftBy;</div><div class="line"><a name="l01258"></a><span class="lineno"> 1258</span>&#160;    <span class="keywordflow">return</span> result;</div><div class="line"><a name="l01259"></a><span class="lineno"> 1259</span>&#160;  }</div><div class="line"><a name="l01260"></a><span class="lineno"> 1260</span>&#160;</div><div class="line"><a name="l01266"></a><span class="lineno"> 1266</span>&#160;  <span class="keyword">final</span> <span class="keywordtype">long</span> readLong() <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l01267"></a><span class="lineno"> 1267</span>&#160;    <span class="keywordtype">long</span> low = readInt() &amp; 0x00000000FFFFFFFFL;</div><div class="line"><a name="l01268"></a><span class="lineno"> 1268</span>&#160;    <span class="keywordtype">long</span> high = readInt() &amp; 0x00000000FFFFFFFFL;</div><div class="line"><a name="l01269"></a><span class="lineno"> 1269</span>&#160;    <span class="keywordtype">long</span> result = high &lt;&lt; 32 | low;</div><div class="line"><a name="l01270"></a><span class="lineno"> 1270</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">long</span>) result; <span class="comment">// (high &lt;&lt; 32 | low);</span></div><div class="line"><a name="l01271"></a><span class="lineno"> 1271</span>&#160;  }</div><div class="line"><a name="l01272"></a><span class="lineno"> 1272</span>&#160;</div><div class="line"><a name="l01277"></a><span class="lineno"> 1277</span>&#160;  <span class="keywordtype">void</span> readMovieData(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01278"></a><span class="lineno"> 1278</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01279"></a><span class="lineno"> 1279</span>&#160;      IJ.log(<span class="stringliteral">&quot;MOVIE DATA &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(endPosition - raFile.getFilePointer()) + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l01280"></a><span class="lineno"> 1280</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01281"></a><span class="lineno"> 1281</span>&#160;      IJ.log(<span class="stringliteral">&quot;Searching for stream &quot;</span> + streamNumber + <span class="stringliteral">&quot;: &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type0xdb) + <span class="stringliteral">&quot;&#39; or &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type0xdc)</div><div class="line"><a name="l01282"></a><span class="lineno"> 1282</span>&#160;          + <span class="stringliteral">&quot;&#39; chunks&quot;</span>);</div><div class="line"><a name="l01283"></a><span class="lineno"> 1283</span>&#160;    <span class="keywordflow">if</span> (isVirtual) {</div><div class="line"><a name="l01284"></a><span class="lineno"> 1284</span>&#160;      <span class="keywordflow">if</span> (frameInfos == null) <span class="comment">// we might have it already from reading the</span></div><div class="line"><a name="l01285"></a><span class="lineno"> 1285</span>&#160;                              <span class="comment">// first chunk</span></div><div class="line"><a name="l01286"></a><span class="lineno"> 1286</span>&#160;        frameInfos = <span class="keyword">new</span> Vector(100); <span class="comment">// holds frame positions in file (for</span></div><div class="line"><a name="l01287"></a><span class="lineno"> 1287</span>&#160;                                      <span class="comment">// non-constant frame sizes, should</span></div><div class="line"><a name="l01288"></a><span class="lineno"> 1288</span>&#160;                                      <span class="comment">// hold long[] with pos and size)</span></div><div class="line"><a name="l01289"></a><span class="lineno"> 1289</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (stack == null)</div><div class="line"><a name="l01290"></a><span class="lineno"> 1290</span>&#160;      stack = <span class="keyword">new</span> ImageStack(dwWidth, biHeight);</div><div class="line"><a name="l01291"></a><span class="lineno"> 1291</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) { <span class="comment">// loop over all chunks</span></div><div class="line"><a name="l01292"></a><span class="lineno"> 1292</span>&#160;      <span class="keywordtype">int</span> type = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee">readType</a>(endPosition);</div><div class="line"><a name="l01293"></a><span class="lineno"> 1293</span>&#160;      <span class="keywordflow">if</span> (type == 0)</div><div class="line"><a name="l01294"></a><span class="lineno"> 1294</span>&#160;        <span class="keywordflow">break</span>; <span class="comment">// end of &#39;movi&#39; reached?</span></div><div class="line"><a name="l01295"></a><span class="lineno"> 1295</span>&#160;      <span class="keywordtype">long</span> size = readInt() &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a>;</div><div class="line"><a name="l01296"></a><span class="lineno"> 1296</span>&#160;      <span class="keywordtype">long</span> pos = raFile.getFilePointer();</div><div class="line"><a name="l01297"></a><span class="lineno"> 1297</span>&#160;      <span class="keywordtype">long</span> nextPos = pos + size;</div><div class="line"><a name="l01298"></a><span class="lineno"> 1298</span>&#160;      <span class="keywordflow">if</span> ((type == type0xdb || type == type0xdc) &amp;&amp; size &gt; 0) {</div><div class="line"><a name="l01299"></a><span class="lineno"> 1299</span>&#160;        IJ.showProgress((<span class="keywordtype">double</span>) frameNumber / lastFrameToRead);</div><div class="line"><a name="l01300"></a><span class="lineno"> 1300</span>&#160;        <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01301"></a><span class="lineno"> 1301</span>&#160;          IJ.log(frameNumber + <span class="stringliteral">&quot; movie data &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type) + <span class="stringliteral">&quot;&#39; &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(size) + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>());</div><div class="line"><a name="l01302"></a><span class="lineno"> 1302</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt;= firstFrame) {</div><div class="line"><a name="l01303"></a><span class="lineno"> 1303</span>&#160;          <span class="keywordflow">if</span> (isVirtual)</div><div class="line"><a name="l01304"></a><span class="lineno"> 1304</span>&#160;            frameInfos.add(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { pos, size, frameNumber * dwMicroSecPerFrame });</div><div class="line"><a name="l01305"></a><span class="lineno"> 1305</span>&#160;          <span class="keywordflow">else</span> { <span class="comment">// read the frame</span></div><div class="line"><a name="l01306"></a><span class="lineno"> 1306</span>&#160;            Object pixels = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4a25d354ac0e1c0771dde30e7e7379ae">readFrame</a>(raFile, pos, (<span class="keywordtype">int</span>) size);</div><div class="line"><a name="l01307"></a><span class="lineno"> 1307</span>&#160;            String label = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a336978e2eb7112d383ea131ff8bd0193">frameLabel</a>(frameNumber * dwMicroSecPerFrame);</div><div class="line"><a name="l01308"></a><span class="lineno"> 1308</span>&#160;            stack.addSlice(label, pixels);</div><div class="line"><a name="l01309"></a><span class="lineno"> 1309</span>&#160;          }</div><div class="line"><a name="l01310"></a><span class="lineno"> 1310</span>&#160;        }</div><div class="line"><a name="l01311"></a><span class="lineno"> 1311</span>&#160;        frameNumber++;</div><div class="line"><a name="l01312"></a><span class="lineno"> 1312</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt; lastFrameToRead)</div><div class="line"><a name="l01313"></a><span class="lineno"> 1313</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01314"></a><span class="lineno"> 1314</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01315"></a><span class="lineno"> 1315</span>&#160;        IJ.log(<span class="stringliteral">&quot;skipped &#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(type) + <span class="stringliteral">&quot;&#39; &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(size));</div><div class="line"><a name="l01316"></a><span class="lineno"> 1316</span>&#160;      <span class="keywordflow">if</span> (nextPos &gt; endPosition)</div><div class="line"><a name="l01317"></a><span class="lineno"> 1317</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01318"></a><span class="lineno"> 1318</span>&#160;      raFile.seek(nextPos);</div><div class="line"><a name="l01319"></a><span class="lineno"> 1319</span>&#160;    }</div><div class="line"><a name="l01320"></a><span class="lineno"> 1320</span>&#160;  }</div><div class="line"><a name="l01321"></a><span class="lineno"> 1321</span>&#160;</div><div class="line"><a name="l01322"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#aea9045a6694e8ada35565a2072f9dc85"> 1322</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aea9045a6694e8ada35565a2072f9dc85">readOldFrameIndex</a>(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> Exception, IOException {</div><div class="line"><a name="l01323"></a><span class="lineno"> 1323</span>&#160;    <span class="keywordtype">int</span> offset = -1; <span class="comment">// difference between absolute frame address and address</span></div><div class="line"><a name="l01324"></a><span class="lineno"> 1324</span>&#160;                     <span class="comment">// given in idx1</span></div><div class="line"><a name="l01325"></a><span class="lineno"> 1325</span>&#160;    <span class="keywordtype">int</span>[] offsetsToTry = <span class="keyword">new</span> <span class="keywordtype">int</span>[] { 0, (int) moviPosition }; <span class="comment">// dwOffset may</span></div><div class="line"><a name="l01326"></a><span class="lineno"> 1326</span>&#160;                                                              <span class="comment">// be w.r.t.</span></div><div class="line"><a name="l01327"></a><span class="lineno"> 1327</span>&#160;                                                              <span class="comment">// file start or</span></div><div class="line"><a name="l01328"></a><span class="lineno"> 1328</span>&#160;                                                              <span class="comment">// w.r.t. &#39;movi&#39;</span></div><div class="line"><a name="l01329"></a><span class="lineno"> 1329</span>&#160;                                                              <span class="comment">// list.</span></div><div class="line"><a name="l01330"></a><span class="lineno"> 1330</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l01331"></a><span class="lineno"> 1331</span>&#160;      <span class="keywordflow">if</span> ((raFile.getFilePointer() + 16) &gt; endPosition)</div><div class="line"><a name="l01332"></a><span class="lineno"> 1332</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l01333"></a><span class="lineno"> 1333</span>&#160;</div><div class="line"><a name="l01334"></a><span class="lineno"> 1334</span>&#160;      <span class="keywordtype">int</span> dwChunkId = readInt();</div><div class="line"><a name="l01335"></a><span class="lineno"> 1335</span>&#160;      <span class="keywordtype">int</span> dwFlags = readInt();</div><div class="line"><a name="l01336"></a><span class="lineno"> 1336</span>&#160;      <span class="keywordtype">int</span> dwOffset = readInt();</div><div class="line"><a name="l01337"></a><span class="lineno"> 1337</span>&#160;      <span class="keywordtype">int</span> dwSize = readInt();</div><div class="line"><a name="l01338"></a><span class="lineno"> 1338</span>&#160;      <span class="comment">// IJ.log(&quot;idx1: dwOffset=0x&quot;+Long.toHexString(dwOffset));</span></div><div class="line"><a name="l01339"></a><span class="lineno"> 1339</span>&#160;      <span class="comment">// IJ.log(&quot;moviPosition=0x&quot;+Long.toHexString(moviPosition));</span></div><div class="line"><a name="l01340"></a><span class="lineno"> 1340</span>&#160;      <span class="keywordflow">if</span> ((dwChunkId == type0xdb || dwChunkId == type0xdc) &amp;&amp; dwSize &gt; 0) {</div><div class="line"><a name="l01341"></a><span class="lineno"> 1341</span>&#160;        <span class="keywordflow">if</span> (offset &lt; 0) { <span class="comment">// find out what the offset refers to</span></div><div class="line"><a name="l01342"></a><span class="lineno"> 1342</span>&#160;          <span class="keywordtype">long</span> temp = raFile.getFilePointer();</div><div class="line"><a name="l01343"></a><span class="lineno"> 1343</span>&#160;          <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; offsetsToTry.length; i++) {</div><div class="line"><a name="l01344"></a><span class="lineno"> 1344</span>&#160;            <span class="keywordtype">long</span> pos = (dwOffset + offsetsToTry[i]) &amp; SIZE_MASK;</div><div class="line"><a name="l01345"></a><span class="lineno"> 1345</span>&#160;            <span class="keywordflow">if</span> (pos &lt; moviPosition)</div><div class="line"><a name="l01346"></a><span class="lineno"> 1346</span>&#160;              <span class="keywordflow">continue</span>; <span class="comment">// frame must be in &#39;movi&#39; list</span></div><div class="line"><a name="l01347"></a><span class="lineno"> 1347</span>&#160;            raFile.seek(pos);</div><div class="line"><a name="l01348"></a><span class="lineno"> 1348</span>&#160;            <span class="keywordtype">int</span> chunkIdAtPos = readInt(); <span class="comment">// see whether this offset</span></div><div class="line"><a name="l01349"></a><span class="lineno"> 1349</span>&#160;                                          <span class="comment">// points to the desired chunk</span></div><div class="line"><a name="l01350"></a><span class="lineno"> 1350</span>&#160;            <span class="comment">// IJ.log(&quot;read@=0x&quot;+Long.toHexString(pos)+&quot;:</span></div><div class="line"><a name="l01351"></a><span class="lineno"> 1351</span>&#160;            <span class="comment">// &#39;&quot;+fourccString(chunkIdAtPos)+&quot;&#39;&quot;);</span></div><div class="line"><a name="l01352"></a><span class="lineno"> 1352</span>&#160;            <span class="keywordflow">if</span> (chunkIdAtPos == dwChunkId) {</div><div class="line"><a name="l01353"></a><span class="lineno"> 1353</span>&#160;              offset = offsetsToTry[i];</div><div class="line"><a name="l01354"></a><span class="lineno"> 1354</span>&#160;              <span class="keywordflow">break</span>;</div><div class="line"><a name="l01355"></a><span class="lineno"> 1355</span>&#160;            }</div><div class="line"><a name="l01356"></a><span class="lineno"> 1356</span>&#160;          }</div><div class="line"><a name="l01357"></a><span class="lineno"> 1357</span>&#160;          <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01358"></a><span class="lineno"> 1358</span>&#160;            IJ.log(<span class="stringliteral">&quot;idx1: dwOffsets are w.r.t. 0x&quot;</span> + (offset &lt; 0 ? <span class="stringliteral">&quot; UNKONWN??&quot;</span> : Long.toHexString(offset)));</div><div class="line"><a name="l01359"></a><span class="lineno"> 1359</span>&#160;          raFile.seek(temp);</div><div class="line"><a name="l01360"></a><span class="lineno"> 1360</span>&#160;          <span class="keywordflow">if</span> (offset &lt; 0)</div><div class="line"><a name="l01361"></a><span class="lineno"> 1361</span>&#160;            <span class="keywordflow">return</span>; <span class="comment">// neither offset works</span></div><div class="line"><a name="l01362"></a><span class="lineno"> 1362</span>&#160;        }</div><div class="line"><a name="l01363"></a><span class="lineno"> 1363</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt;= firstFrame) {</div><div class="line"><a name="l01364"></a><span class="lineno"> 1364</span>&#160;          <span class="keywordtype">long</span> framepos = (dwOffset + offset) &amp; SIZE_MASK;</div><div class="line"><a name="l01365"></a><span class="lineno"> 1365</span>&#160;          frameInfos.add(<span class="keyword">new</span> <span class="keywordtype">long</span>[] { framepos + 8, dwSize, (long) frameNumber * dwMicroSecPerFrame });</div><div class="line"><a name="l01366"></a><span class="lineno"> 1366</span>&#160;          <span class="comment">// if (verbose)</span></div><div class="line"><a name="l01367"></a><span class="lineno"> 1367</span>&#160;          <span class="comment">// IJ.log(&quot;idx1 movie data &#39;&quot;+fourccString(dwChunkId)+&quot;&#39;</span></div><div class="line"><a name="l01368"></a><span class="lineno"> 1368</span>&#160;          <span class="comment">// &quot;+posSizeString(framepos,dwSize)+timeString());</span></div><div class="line"><a name="l01369"></a><span class="lineno"> 1369</span>&#160;        }</div><div class="line"><a name="l01370"></a><span class="lineno"> 1370</span>&#160;        frameNumber++;</div><div class="line"><a name="l01371"></a><span class="lineno"> 1371</span>&#160;        <span class="keywordflow">if</span> (frameNumber &gt; lastFrameToRead)</div><div class="line"><a name="l01372"></a><span class="lineno"> 1372</span>&#160;          <span class="keywordflow">break</span>;</div><div class="line"><a name="l01373"></a><span class="lineno"> 1373</span>&#160;      } <span class="comment">// if(dwChunkId...)</span></div><div class="line"><a name="l01374"></a><span class="lineno"> 1374</span>&#160;    } <span class="comment">// while(true)</span></div><div class="line"><a name="l01375"></a><span class="lineno"> 1375</span>&#160;    <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01376"></a><span class="lineno"> 1376</span>&#160;      IJ.log(<span class="stringliteral">&quot;Index read up to frame &quot;</span> + (frameNumber - 1));</div><div class="line"><a name="l01377"></a><span class="lineno"> 1377</span>&#160;</div><div class="line"><a name="l01378"></a><span class="lineno"> 1378</span>&#160;  }</div><div class="line"><a name="l01379"></a><span class="lineno"> 1379</span>&#160;</div><div class="line"><a name="l01384"></a><span class="lineno"> 1384</span>&#160;  <span class="keyword">final</span> <span class="keywordtype">short</span> readShort() <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l01385"></a><span class="lineno"> 1385</span>&#160;    <span class="keywordtype">int</span> low = raFile.readByte() &amp; 0xff;</div><div class="line"><a name="l01386"></a><span class="lineno"> 1386</span>&#160;    <span class="keywordtype">int</span> high = raFile.readByte() &amp; 0xff;</div><div class="line"><a name="l01387"></a><span class="lineno"> 1387</span>&#160;    <span class="keywordflow">return</span> (<span class="keywordtype">short</span>) (high &lt;&lt; 8 | low);</div><div class="line"><a name="l01388"></a><span class="lineno"> 1388</span>&#160;  }</div><div class="line"><a name="l01389"></a><span class="lineno"> 1389</span>&#160;</div><div class="line"><a name="l01390"></a><span class="lineno"> 1390</span>&#160;  <span class="keywordtype">void</span> readStreamHeader() <span class="keywordflow">throws</span> Exception, IOException { <span class="comment">// &#39;strh&#39;</span></div><div class="line"><a name="l01391"></a><span class="lineno"> 1391</span>&#160;    fccStreamHandler = readInt();</div><div class="line"><a name="l01392"></a><span class="lineno"> 1392</span>&#160;    dwStreamFlags = readInt();</div><div class="line"><a name="l01393"></a><span class="lineno"> 1393</span>&#160;    dwPriorityLanguage = readInt();</div><div class="line"><a name="l01394"></a><span class="lineno"> 1394</span>&#160;    dwStreamInitialFrames = readInt();</div><div class="line"><a name="l01395"></a><span class="lineno"> 1395</span>&#160;    dwStreamScale = readInt();</div><div class="line"><a name="l01396"></a><span class="lineno"> 1396</span>&#160;    dwStreamRate = readInt();</div><div class="line"><a name="l01397"></a><span class="lineno"> 1397</span>&#160;    dwStreamStart = readInt();</div><div class="line"><a name="l01398"></a><span class="lineno"> 1398</span>&#160;    dwStreamLength = readInt();</div><div class="line"><a name="l01399"></a><span class="lineno"> 1399</span>&#160;    dwStreamSuggestedBufferSize = readInt();</div><div class="line"><a name="l01400"></a><span class="lineno"> 1400</span>&#160;    dwStreamQuality = readInt();</div><div class="line"><a name="l01401"></a><span class="lineno"> 1401</span>&#160;    dwStreamSampleSize = readInt();</div><div class="line"><a name="l01402"></a><span class="lineno"> 1402</span>&#160;    <span class="comment">// rcFrame rectangle follows, ignored</span></div><div class="line"><a name="l01403"></a><span class="lineno"> 1403</span>&#160;    <span class="keywordflow">if</span> (verbose) {</div><div class="line"><a name="l01404"></a><span class="lineno"> 1404</span>&#160;      IJ.log(<span class="stringliteral">&quot;VIDEO STREAM HEADER (strh):&quot;</span>);</div><div class="line"><a name="l01405"></a><span class="lineno"> 1405</span>&#160;      IJ.log(<span class="stringliteral">&quot;   fccStreamHandler=&#39;&quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">fourccString</a>(fccStreamHandler) + <span class="stringliteral">&quot;&#39;&quot;</span>);</div><div class="line"><a name="l01406"></a><span class="lineno"> 1406</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamFlags=&quot;</span> + dwStreamFlags);</div><div class="line"><a name="l01407"></a><span class="lineno"> 1407</span>&#160;      IJ.log(<span class="stringliteral">&quot;   wPriority,wLanguage=&quot;</span> + dwPriorityLanguage);</div><div class="line"><a name="l01408"></a><span class="lineno"> 1408</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamInitialFrames=&quot;</span> + dwStreamInitialFrames);</div><div class="line"><a name="l01409"></a><span class="lineno"> 1409</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamScale=&quot;</span> + dwStreamScale);</div><div class="line"><a name="l01410"></a><span class="lineno"> 1410</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamRate=&quot;</span> + dwStreamRate);</div><div class="line"><a name="l01411"></a><span class="lineno"> 1411</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamStart=&quot;</span> + dwStreamStart);</div><div class="line"><a name="l01412"></a><span class="lineno"> 1412</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamLength=&quot;</span> + dwStreamLength);</div><div class="line"><a name="l01413"></a><span class="lineno"> 1413</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamSuggestedBufferSize=&quot;</span> + dwStreamSuggestedBufferSize);</div><div class="line"><a name="l01414"></a><span class="lineno"> 1414</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamQuality=&quot;</span> + dwStreamQuality);</div><div class="line"><a name="l01415"></a><span class="lineno"> 1415</span>&#160;      IJ.log(<span class="stringliteral">&quot;   dwStreamSampleSize=&quot;</span> + dwStreamSampleSize);</div><div class="line"><a name="l01416"></a><span class="lineno"> 1416</span>&#160;    }</div><div class="line"><a name="l01417"></a><span class="lineno"> 1417</span>&#160;    <span class="keywordflow">if</span> (dwStreamSampleSize &gt; 1)</div><div class="line"><a name="l01418"></a><span class="lineno"> 1418</span>&#160;      <span class="keywordflow">throw</span> <span class="keyword">new</span> Exception(<span class="stringliteral">&quot;Video stream with &quot;</span> + dwStreamSampleSize + <span class="stringliteral">&quot; (more than 1) frames/chunk not supported&quot;</span>);</div><div class="line"><a name="l01419"></a><span class="lineno"> 1419</span>&#160;    <span class="comment">// what the chunks in that stream will be named (we have two possibilites:</span></div><div class="line"><a name="l01420"></a><span class="lineno"> 1420</span>&#160;    <span class="comment">// uncompressed &amp; compressed)</span></div><div class="line"><a name="l01421"></a><span class="lineno"> 1421</span>&#160;    type0xdb = FOURCC_00db + (streamNumber &lt;&lt; 8); <span class="comment">// &#39;01db&#39; for stream 1, etc.</span></div><div class="line"><a name="l01422"></a><span class="lineno"> 1422</span>&#160;                                                  <span class="comment">// (inverse byte order!)</span></div><div class="line"><a name="l01423"></a><span class="lineno"> 1423</span>&#160;    type0xdc = FOURCC_00dc + (streamNumber &lt;&lt; 8); <span class="comment">// &#39;01dc&#39; for stream 1, etc.</span></div><div class="line"><a name="l01424"></a><span class="lineno"> 1424</span>&#160;  }</div><div class="line"><a name="l01425"></a><span class="lineno"> 1425</span>&#160;</div><div class="line"><a name="l01430"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee"> 1430</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee">readType</a>(<span class="keywordtype">long</span> endPosition) <span class="keywordflow">throws</span> IOException {</div><div class="line"><a name="l01431"></a><span class="lineno"> 1431</span>&#160;    <span class="keywordflow">while</span> (<span class="keyword">true</span>) {</div><div class="line"><a name="l01432"></a><span class="lineno"> 1432</span>&#160;      <span class="keywordtype">long</span> pos = raFile.getFilePointer();</div><div class="line"><a name="l01433"></a><span class="lineno"> 1433</span>&#160;      <span class="keywordflow">if</span> (pos % paddingGranularity != 0) {</div><div class="line"><a name="l01434"></a><span class="lineno"> 1434</span>&#160;        pos = (pos / paddingGranularity + 1) * paddingGranularity;</div><div class="line"><a name="l01435"></a><span class="lineno"> 1435</span>&#160;        raFile.seek(pos); <span class="comment">// pad to even address</span></div><div class="line"><a name="l01436"></a><span class="lineno"> 1436</span>&#160;      }</div><div class="line"><a name="l01437"></a><span class="lineno"> 1437</span>&#160;      <span class="keywordflow">if</span> (pos &gt;= endPosition)</div><div class="line"><a name="l01438"></a><span class="lineno"> 1438</span>&#160;        <span class="keywordflow">return</span> 0;</div><div class="line"><a name="l01439"></a><span class="lineno"> 1439</span>&#160;      <span class="keywordtype">int</span> type = readInt();</div><div class="line"><a name="l01440"></a><span class="lineno"> 1440</span>&#160;      <span class="keywordflow">if</span> (type != FOURCC_JUNK)</div><div class="line"><a name="l01441"></a><span class="lineno"> 1441</span>&#160;        <span class="keywordflow">return</span> type;</div><div class="line"><a name="l01442"></a><span class="lineno"> 1442</span>&#160;      <span class="keywordtype">long</span> size = readInt() &amp; <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">SIZE_MASK</a>;</div><div class="line"><a name="l01443"></a><span class="lineno"> 1443</span>&#160;      <span class="keywordflow">if</span> (verbose)</div><div class="line"><a name="l01444"></a><span class="lineno"> 1444</span>&#160;        IJ.log(<span class="stringliteral">&quot;Skip JUNK: &quot;</span> + <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">posSizeString</a>(size));</div><div class="line"><a name="l01445"></a><span class="lineno"> 1445</span>&#160;      raFile.seek(raFile.getFilePointer() + size); <span class="comment">// skip junk</span></div><div class="line"><a name="l01446"></a><span class="lineno"> 1446</span>&#160;    }</div><div class="line"><a name="l01447"></a><span class="lineno"> 1447</span>&#160;  }</div><div class="line"><a name="l01448"></a><span class="lineno"> 1448</span>&#160;</div><div class="line"><a name="l01453"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a9986cc553cf34bcad781fe508172f4ab"> 1453</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a9986cc553cf34bcad781fe508172f4ab">run</a>(String arg) {</div><div class="line"><a name="l01454"></a><span class="lineno"> 1454</span>&#160;    OpenDialog od = <span class="keyword">new</span> OpenDialog(<span class="stringliteral">&quot;Select AVI File&quot;</span>, arg); <span class="comment">// file dialog</span></div><div class="line"><a name="l01455"></a><span class="lineno"> 1455</span>&#160;    String fileName = od.getFileName();</div><div class="line"><a name="l01456"></a><span class="lineno"> 1456</span>&#160;    <span class="keywordflow">if</span> (fileName == null)</div><div class="line"><a name="l01457"></a><span class="lineno"> 1457</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01458"></a><span class="lineno"> 1458</span>&#160;    String fileDir = od.getDirectory();</div><div class="line"><a name="l01459"></a><span class="lineno"> 1459</span>&#160;    String path = fileDir + fileName;</div><div class="line"><a name="l01460"></a><span class="lineno"> 1460</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l01461"></a><span class="lineno"> 1461</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3ed951465a3d01864dfcd07e0f62fff4">openAndReadHeader</a>(path); <span class="comment">// open and read header</span></div><div class="line"><a name="l01462"></a><span class="lineno"> 1462</span>&#160;    } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l01463"></a><span class="lineno"> 1463</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a>(e));</div><div class="line"><a name="l01464"></a><span class="lineno"> 1464</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01465"></a><span class="lineno"> 1465</span>&#160;    }</div><div class="line"><a name="l01466"></a><span class="lineno"> 1466</span>&#160;    <span class="comment">// if (!showDialog(fileName)) return; //ask for parameters</span></div><div class="line"><a name="l01467"></a><span class="lineno"> 1467</span>&#160;    <span class="keywordflow">try</span> {</div><div class="line"><a name="l01468"></a><span class="lineno"> 1468</span>&#160;      ImageStack stack = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae699b81fde03f1f2acf246a66ca12770">makeStack</a>(path, firstFrame, lastFrame, isVirtual, convertToGray, flipVertical); <span class="comment">// read</span></div><div class="line"><a name="l01469"></a><span class="lineno"> 1469</span>&#160;                                                                                                         <span class="comment">// data</span></div><div class="line"><a name="l01470"></a><span class="lineno"> 1470</span>&#160;    } <span class="keywordflow">catch</span> (Exception e) {</div><div class="line"><a name="l01471"></a><span class="lineno"> 1471</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(<a class="code" href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">exceptionMessage</a>(e));</div><div class="line"><a name="l01472"></a><span class="lineno"> 1472</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01473"></a><span class="lineno"> 1473</span>&#160;    }</div><div class="line"><a name="l01474"></a><span class="lineno"> 1474</span>&#160;    <span class="keywordflow">if</span> (stack == null || aborting || (stack.isVirtual() &amp;&amp; stack.getProcessor(1) == null))</div><div class="line"><a name="l01475"></a><span class="lineno"> 1475</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01476"></a><span class="lineno"> 1476</span>&#160;    <span class="keywordflow">if</span> (stack.getSize() == 0) {</div><div class="line"><a name="l01477"></a><span class="lineno"> 1477</span>&#160;      String rangeText = <span class="stringliteral">&quot;&quot;</span>;</div><div class="line"><a name="l01478"></a><span class="lineno"> 1478</span>&#160;      <span class="keywordflow">if</span> (firstFrame &gt; 1 || lastFrame != 0)</div><div class="line"><a name="l01479"></a><span class="lineno"> 1479</span>&#160;        rangeText = <span class="stringliteral">&quot;\nin Range &quot;</span> + firstFrame + (lastFrame &gt; 0 ? <span class="stringliteral">&quot; - &quot;</span> + lastFrame : <span class="stringliteral">&quot; - end&quot;</span>);</div><div class="line"><a name="l01480"></a><span class="lineno"> 1480</span>&#160;      <a class="code" href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">error</a>(<span class="stringliteral">&quot;Error: No Frames Found&quot;</span> + rangeText);</div><div class="line"><a name="l01481"></a><span class="lineno"> 1481</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l01482"></a><span class="lineno"> 1482</span>&#160;    }</div><div class="line"><a name="l01483"></a><span class="lineno"> 1483</span>&#160;    imp = <span class="keyword">new</span> ImagePlus(WindowManager.getUniqueName(fileName), <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a3718d0e6f5e4617dcc81a8e481361c7e">stack</a>);</div><div class="line"><a name="l01484"></a><span class="lineno"> 1484</span>&#160;    <span class="keywordflow">if</span> (imp.getBitDepth() == 16)</div><div class="line"><a name="l01485"></a><span class="lineno"> 1485</span>&#160;      imp.getProcessor().resetMinAndMax();</div><div class="line"><a name="l01486"></a><span class="lineno"> 1486</span>&#160;    <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a78973ba2fec408d8cd6551dd6929651f">setFramesPerSecond</a>(imp);</div><div class="line"><a name="l01487"></a><span class="lineno"> 1487</span>&#160;    FileInfo fi = <span class="keyword">new</span> FileInfo();</div><div class="line"><a name="l01488"></a><span class="lineno"> 1488</span>&#160;    fi.fileName = fileName;</div><div class="line"><a name="l01489"></a><span class="lineno"> 1489</span>&#160;    fi.directory = fileDir;</div><div class="line"><a name="l01490"></a><span class="lineno"> 1490</span>&#160;    imp.setFileInfo(fi);</div><div class="line"><a name="l01491"></a><span class="lineno"> 1491</span>&#160;    <span class="keywordflow">if</span> (arg.equals(<span class="stringliteral">&quot;&quot;</span>))</div><div class="line"><a name="l01492"></a><span class="lineno"> 1492</span>&#160;      imp.show();</div><div class="line"><a name="l01493"></a><span class="lineno"> 1493</span>&#160;    IJ.showTime(imp, startTime, <span class="stringliteral">&quot;Read AVI in &quot;</span>, stack.getSize());</div><div class="line"><a name="l01494"></a><span class="lineno"> 1494</span>&#160;  }</div><div class="line"><a name="l01495"></a><span class="lineno"> 1495</span>&#160;</div><div class="line"><a name="l01496"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a78973ba2fec408d8cd6551dd6929651f"> 1496</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a78973ba2fec408d8cd6551dd6929651f">setFramesPerSecond</a>(ImagePlus imp) {</div><div class="line"><a name="l01497"></a><span class="lineno"> 1497</span>&#160;    <span class="keywordflow">if</span> (dwMicroSecPerFrame &lt; 1000 &amp;&amp; dwStreamRate &gt; 0) <span class="comment">// if no reasonable</span></div><div class="line"><a name="l01498"></a><span class="lineno"> 1498</span>&#160;                                                       <span class="comment">// frame time, get it</span></div><div class="line"><a name="l01499"></a><span class="lineno"> 1499</span>&#160;                                                       <span class="comment">// from rate</span></div><div class="line"><a name="l01500"></a><span class="lineno"> 1500</span>&#160;      dwMicroSecPerFrame = (int) (dwStreamScale * 1e6 / dwStreamRate);</div><div class="line"><a name="l01501"></a><span class="lineno"> 1501</span>&#160;    <span class="keywordflow">if</span> (dwMicroSecPerFrame &gt;= 1000)</div><div class="line"><a name="l01502"></a><span class="lineno"> 1502</span>&#160;      imp.getCalibration().fps = 1e6 / <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a226b0a1d6946d4295dd0f0472f0ee378">dwMicroSecPerFrame</a>;</div><div class="line"><a name="l01503"></a><span class="lineno"> 1503</span>&#160;  }</div><div class="line"><a name="l01504"></a><span class="lineno"> 1504</span>&#160;</div><div class="line"><a name="l01506"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#afceeac5fe2c92fbc4a2bf188bf7b27e4"> 1506</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classthird___party_1_1_a_v_i___reader.html#afceeac5fe2c92fbc4a2bf188bf7b27e4">showDialog</a>(String fileName) {</div><div class="line"><a name="l01507"></a><span class="lineno"> 1507</span>&#160;    <span class="keywordflow">if</span> (lastFrame != -1)</div><div class="line"><a name="l01508"></a><span class="lineno"> 1508</span>&#160;      lastFrame = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a687586aa131c3fed450ee954833497de">dwTotalFrames</a>;</div><div class="line"><a name="l01509"></a><span class="lineno"> 1509</span>&#160;    <span class="keywordflow">if</span> (!IJ.isMacro()) {</div><div class="line"><a name="l01510"></a><span class="lineno"> 1510</span>&#160;      convertToGray = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a1c9b6b612edba7d066f7385771c15613">staticConvertToGray</a>;</div><div class="line"><a name="l01511"></a><span class="lineno"> 1511</span>&#160;      flipVertical = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#abf21677829232d48cb9bc1efcdfd1557">staticFlipVertical</a>;</div><div class="line"><a name="l01512"></a><span class="lineno"> 1512</span>&#160;      isVirtual = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4d27bb277c107c931e0f80ce7947f5ea">staticIsVirtual</a>;</div><div class="line"><a name="l01513"></a><span class="lineno"> 1513</span>&#160;    }</div><div class="line"><a name="l01514"></a><span class="lineno"> 1514</span>&#160;    GenericDialog gd = <span class="keyword">new</span> GenericDialog(<span class="stringliteral">&quot;AVI Reader&quot;</span>);</div><div class="line"><a name="l01515"></a><span class="lineno"> 1515</span>&#160;</div><div class="line"><a name="l01516"></a><span class="lineno"> 1516</span>&#160;    gd.addNumericField(<span class="stringliteral">&quot;First Frame: &quot;</span>, firstFrame, 0);</div><div class="line"><a name="l01517"></a><span class="lineno"> 1517</span>&#160;    gd.addNumericField(<span class="stringliteral">&quot;Last Frame: &quot;</span>, lastFrame, 0, 6, <span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l01518"></a><span class="lineno"> 1518</span>&#160;    gd.addCheckbox(<span class="stringliteral">&quot;Use Virtual Stack&quot;</span>, isVirtual);</div><div class="line"><a name="l01519"></a><span class="lineno"> 1519</span>&#160;    gd.addCheckbox(<span class="stringliteral">&quot;Convert to Grayscale&quot;</span>, convertToGray);</div><div class="line"><a name="l01520"></a><span class="lineno"> 1520</span>&#160;    gd.addCheckbox(<span class="stringliteral">&quot;Flip Vertical&quot;</span>, flipVertical);</div><div class="line"><a name="l01521"></a><span class="lineno"> 1521</span>&#160;    gd.showDialog();</div><div class="line"><a name="l01522"></a><span class="lineno"> 1522</span>&#160;    <span class="keywordflow">if</span> (gd.wasCanceled())</div><div class="line"><a name="l01523"></a><span class="lineno"> 1523</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">false</span>;</div><div class="line"><a name="l01524"></a><span class="lineno"> 1524</span>&#160;    firstFrame = (int) gd.getNextNumber();</div><div class="line"><a name="l01525"></a><span class="lineno"> 1525</span>&#160;    lastFrame = (int) gd.getNextNumber();</div><div class="line"><a name="l01526"></a><span class="lineno"> 1526</span>&#160;    isVirtual = gd.getNextBoolean();</div><div class="line"><a name="l01527"></a><span class="lineno"> 1527</span>&#160;    convertToGray = gd.getNextBoolean();</div><div class="line"><a name="l01528"></a><span class="lineno"> 1528</span>&#160;    flipVertical = gd.getNextBoolean();</div><div class="line"><a name="l01529"></a><span class="lineno"> 1529</span>&#160;    <span class="keywordflow">if</span> (!IJ.isMacro()) {</div><div class="line"><a name="l01530"></a><span class="lineno"> 1530</span>&#160;      staticConvertToGray = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a4ed3ed255ad8de9543bc052fdf79c1bf">convertToGray</a>;</div><div class="line"><a name="l01531"></a><span class="lineno"> 1531</span>&#160;      staticFlipVertical = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#af80522b94aad967163e1c1f632ccae18">flipVertical</a>;</div><div class="line"><a name="l01532"></a><span class="lineno"> 1532</span>&#160;      staticIsVirtual = <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a7a2de66ab228979ef527d69ef6f715d8">isVirtual</a>;</div><div class="line"><a name="l01533"></a><span class="lineno"> 1533</span>&#160;    }</div><div class="line"><a name="l01534"></a><span class="lineno"> 1534</span>&#160;    IJ.register(this.getClass());</div><div class="line"><a name="l01535"></a><span class="lineno"> 1535</span>&#160;    <span class="keywordflow">return</span> <span class="keyword">true</span>;</div><div class="line"><a name="l01536"></a><span class="lineno"> 1536</span>&#160;  }</div><div class="line"><a name="l01537"></a><span class="lineno"> 1537</span>&#160;</div><div class="line"><a name="l01538"></a><span class="lineno"><a class="line" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53"> 1538</a></span>&#160;  <span class="keyword">private</span> String <a class="code" href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">timeString</a>() {</div><div class="line"><a name="l01539"></a><span class="lineno"> 1539</span>&#160;    <span class="keywordflow">return</span> <span class="stringliteral">&quot; (t=&quot;</span> + (System.currentTimeMillis() - <a class="code" href="classthird___party_1_1_a_v_i___reader.html#ae51c21e096fc7d3c16c4b098e8772b50">startTime</a>) + <span class="stringliteral">&quot; ms)&quot;</span>;</div><div class="line"><a name="l01540"></a><span class="lineno"> 1540</span>&#160;  }</div><div class="line"><a name="l01541"></a><span class="lineno"> 1541</span>&#160;</div><div class="line"><a name="l01546"></a><span class="lineno"> 1546</span>&#160;  <span class="keywordtype">void</span> unpack(byte[] rawData, <span class="keywordtype">int</span> rawOffset, <span class="keywordtype">int</span>[] pixels, <span class="keywordtype">int</span> intOffset, <span class="keywordtype">int</span> w) {</div><div class="line"><a name="l01547"></a><span class="lineno"> 1547</span>&#160;    <span class="keywordtype">int</span> j = intOffset;</div><div class="line"><a name="l01548"></a><span class="lineno"> 1548</span>&#160;    <span class="keywordtype">int</span> k = rawOffset;</div><div class="line"><a name="l01549"></a><span class="lineno"> 1549</span>&#160;    <span class="keywordflow">switch</span> (dataCompression) {</div><div class="line"><a name="l01550"></a><span class="lineno"> 1550</span>&#160;    <span class="keywordflow">case</span> NO_COMPRESSION:</div><div class="line"><a name="l01551"></a><span class="lineno"> 1551</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++) {</div><div class="line"><a name="l01552"></a><span class="lineno"> 1552</span>&#160;        <span class="keywordtype">int</span> b0 = (((int) (rawData[k++])) &amp; 0xff);</div><div class="line"><a name="l01553"></a><span class="lineno"> 1553</span>&#160;        <span class="keywordtype">int</span> b1 = (((int) (rawData[k++])) &amp; 0xff) &lt;&lt; 8;</div><div class="line"><a name="l01554"></a><span class="lineno"> 1554</span>&#160;        <span class="keywordtype">int</span> b2 = (((int) (rawData[k++])) &amp; 0xff) &lt;&lt; 16;</div><div class="line"><a name="l01555"></a><span class="lineno"> 1555</span>&#160;        <span class="keywordflow">if</span> (biBitCount == 32)</div><div class="line"><a name="l01556"></a><span class="lineno"> 1556</span>&#160;          k++; <span class="comment">// ignore 4th byte (alpha value)</span></div><div class="line"><a name="l01557"></a><span class="lineno"> 1557</span>&#160;        pixels[j++] = 0xff000000 | b0 | b1 | b2;</div><div class="line"><a name="l01558"></a><span class="lineno"> 1558</span>&#160;      }</div><div class="line"><a name="l01559"></a><span class="lineno"> 1559</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01560"></a><span class="lineno"> 1560</span>&#160;    <span class="keywordflow">case</span> YUY2_COMPRESSION:</div><div class="line"><a name="l01561"></a><span class="lineno"> 1561</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w / 2; i++) {</div><div class="line"><a name="l01562"></a><span class="lineno"> 1562</span>&#160;        <span class="keywordtype">int</span> y0 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01563"></a><span class="lineno"> 1563</span>&#160;        <span class="keywordtype">int</span> u = rawData[k++] ^ 0xffffff80; <span class="comment">// converts byte range 0...ff to</span></div><div class="line"><a name="l01564"></a><span class="lineno"> 1564</span>&#160;                                           <span class="comment">// -128 ... 127</span></div><div class="line"><a name="l01565"></a><span class="lineno"> 1565</span>&#160;        <span class="keywordtype">int</span> y1 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01566"></a><span class="lineno"> 1566</span>&#160;        <span class="keywordtype">int</span> v = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01567"></a><span class="lineno"> 1567</span>&#160;        writeRGBfromYUV(y0, u, v, pixels, j++);</div><div class="line"><a name="l01568"></a><span class="lineno"> 1568</span>&#160;        writeRGBfromYUV(y1, u, v, pixels, j++);</div><div class="line"><a name="l01569"></a><span class="lineno"> 1569</span>&#160;      }</div><div class="line"><a name="l01570"></a><span class="lineno"> 1570</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01571"></a><span class="lineno"> 1571</span>&#160;    <span class="keywordflow">case</span> UYVY_COMPRESSION:</div><div class="line"><a name="l01572"></a><span class="lineno"> 1572</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w / 2; i++) {</div><div class="line"><a name="l01573"></a><span class="lineno"> 1573</span>&#160;        <span class="keywordtype">int</span> u = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01574"></a><span class="lineno"> 1574</span>&#160;        <span class="keywordtype">int</span> y0 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01575"></a><span class="lineno"> 1575</span>&#160;        <span class="keywordtype">int</span> v = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01576"></a><span class="lineno"> 1576</span>&#160;        <span class="keywordtype">int</span> y1 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01577"></a><span class="lineno"> 1577</span>&#160;        writeRGBfromYUV(y0, u, v, pixels, j++);</div><div class="line"><a name="l01578"></a><span class="lineno"> 1578</span>&#160;        writeRGBfromYUV(y1, u, v, pixels, j++);</div><div class="line"><a name="l01579"></a><span class="lineno"> 1579</span>&#160;      }</div><div class="line"><a name="l01580"></a><span class="lineno"> 1580</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01581"></a><span class="lineno"> 1581</span>&#160;    <span class="keywordflow">case</span> YVYU_COMPRESSION:</div><div class="line"><a name="l01582"></a><span class="lineno"> 1582</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w / 2; i++) {</div><div class="line"><a name="l01583"></a><span class="lineno"> 1583</span>&#160;        <span class="keywordtype">int</span> y0 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01584"></a><span class="lineno"> 1584</span>&#160;        <span class="keywordtype">int</span> v = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01585"></a><span class="lineno"> 1585</span>&#160;        <span class="keywordtype">int</span> y1 = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01586"></a><span class="lineno"> 1586</span>&#160;        <span class="keywordtype">int</span> u = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01587"></a><span class="lineno"> 1587</span>&#160;        writeRGBfromYUV(y0, u, v, pixels, j++);</div><div class="line"><a name="l01588"></a><span class="lineno"> 1588</span>&#160;        writeRGBfromYUV(y1, u, v, pixels, j++);</div><div class="line"><a name="l01589"></a><span class="lineno"> 1589</span>&#160;      }</div><div class="line"><a name="l01590"></a><span class="lineno"> 1590</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01591"></a><span class="lineno"> 1591</span>&#160;    <span class="keywordflow">case</span> AYUV_COMPRESSION:</div><div class="line"><a name="l01592"></a><span class="lineno"> 1592</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++) {</div><div class="line"><a name="l01593"></a><span class="lineno"> 1593</span>&#160;        k++; <span class="comment">// ignore alpha channel</span></div><div class="line"><a name="l01594"></a><span class="lineno"> 1594</span>&#160;        <span class="keywordtype">int</span> y = rawData[k++] &amp; 0xff;</div><div class="line"><a name="l01595"></a><span class="lineno"> 1595</span>&#160;        <span class="keywordtype">int</span> v = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01596"></a><span class="lineno"> 1596</span>&#160;        <span class="keywordtype">int</span> u = rawData[k++] ^ 0xffffff80;</div><div class="line"><a name="l01597"></a><span class="lineno"> 1597</span>&#160;        writeRGBfromYUV(y, u, v, pixels, j++);</div><div class="line"><a name="l01598"></a><span class="lineno"> 1598</span>&#160;      }</div><div class="line"><a name="l01599"></a><span class="lineno"> 1599</span>&#160;      <span class="keywordflow">break</span>;</div><div class="line"><a name="l01600"></a><span class="lineno"> 1600</span>&#160;</div><div class="line"><a name="l01601"></a><span class="lineno"> 1601</span>&#160;    }</div><div class="line"><a name="l01602"></a><span class="lineno"> 1602</span>&#160;  }</div><div class="line"><a name="l01603"></a><span class="lineno"> 1603</span>&#160;</div><div class="line"><a name="l01608"></a><span class="lineno"> 1608</span>&#160;  <span class="keywordtype">void</span> unpack8bit(byte[] rawData, <span class="keywordtype">int</span> rawOffset, byte[] pixels, <span class="keywordtype">int</span> byteOffset, <span class="keywordtype">int</span> w) {</div><div class="line"><a name="l01609"></a><span class="lineno"> 1609</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++)</div><div class="line"><a name="l01610"></a><span class="lineno"> 1610</span>&#160;      pixels[byteOffset + i] = rawData[rawOffset + i];</div><div class="line"><a name="l01611"></a><span class="lineno"> 1611</span>&#160;  }</div><div class="line"><a name="l01612"></a><span class="lineno"> 1612</span>&#160;</div><div class="line"><a name="l01617"></a><span class="lineno"> 1617</span>&#160;  <span class="keywordtype">void</span> unpackGray(byte[] rawData, <span class="keywordtype">int</span> rawOffset, byte[] pixels, <span class="keywordtype">int</span> byteOffset, <span class="keywordtype">int</span> w) {</div><div class="line"><a name="l01618"></a><span class="lineno"> 1618</span>&#160;    <span class="keywordtype">int</span> j = byteOffset;</div><div class="line"><a name="l01619"></a><span class="lineno"> 1619</span>&#160;    <span class="keywordtype">int</span> k = rawOffset;</div><div class="line"><a name="l01620"></a><span class="lineno"> 1620</span>&#160;    <span class="keywordflow">if</span> (dataCompression == 0) {</div><div class="line"><a name="l01621"></a><span class="lineno"> 1621</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++) {</div><div class="line"><a name="l01622"></a><span class="lineno"> 1622</span>&#160;        <span class="keywordtype">int</span> b0 = (((int) (rawData[k++])) &amp; 0xff);</div><div class="line"><a name="l01623"></a><span class="lineno"> 1623</span>&#160;        <span class="keywordtype">int</span> b1 = (((int) (rawData[k++])) &amp; 0xff);</div><div class="line"><a name="l01624"></a><span class="lineno"> 1624</span>&#160;        <span class="keywordtype">int</span> b2 = (((int) (rawData[k++])) &amp; 0xff);</div><div class="line"><a name="l01625"></a><span class="lineno"> 1625</span>&#160;        <span class="keywordflow">if</span> (biBitCount == 32)</div><div class="line"><a name="l01626"></a><span class="lineno"> 1626</span>&#160;          k++; <span class="comment">// ignore 4th byte (alpha value)</span></div><div class="line"><a name="l01627"></a><span class="lineno"> 1627</span>&#160;        pixels[j++] = (byte) ((b0 * 934 + b1 * 4809 + b2 * 2449 + 4096) &gt;&gt; 13); <span class="comment">// 0.299*R+0.587*G+0.114*B</span></div><div class="line"><a name="l01628"></a><span class="lineno"> 1628</span>&#160;      }</div><div class="line"><a name="l01629"></a><span class="lineno"> 1629</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l01630"></a><span class="lineno"> 1630</span>&#160;      <span class="keywordflow">if</span> (dataCompression == UYVY_COMPRESSION || dataCompression == AYUV_COMPRESSION)</div><div class="line"><a name="l01631"></a><span class="lineno"> 1631</span>&#160;        k++; <span class="comment">// skip first byte in these formats (chroma)</span></div><div class="line"><a name="l01632"></a><span class="lineno"> 1632</span>&#160;      <span class="keywordtype">int</span> step = dataCompression == AYUV_COMPRESSION ? 4 : 2;</div><div class="line"><a name="l01633"></a><span class="lineno"> 1633</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++) {</div><div class="line"><a name="l01634"></a><span class="lineno"> 1634</span>&#160;        pixels[j++] = rawData[k]; <span class="comment">// Non-standard: no scaling from 16-235 to</span></div><div class="line"><a name="l01635"></a><span class="lineno"> 1635</span>&#160;                                  <span class="comment">// 0-255 here</span></div><div class="line"><a name="l01636"></a><span class="lineno"> 1636</span>&#160;        k += step;</div><div class="line"><a name="l01637"></a><span class="lineno"> 1637</span>&#160;      }</div><div class="line"><a name="l01638"></a><span class="lineno"> 1638</span>&#160;    }</div><div class="line"><a name="l01639"></a><span class="lineno"> 1639</span>&#160;  }</div><div class="line"><a name="l01640"></a><span class="lineno"> 1640</span>&#160;</div><div class="line"><a name="l01645"></a><span class="lineno"> 1645</span>&#160;  <span class="keywordtype">void</span> unpackShort(byte[] rawData, <span class="keywordtype">int</span> rawOffset, <span class="keywordtype">short</span>[] pixels, <span class="keywordtype">int</span> shortOffset, <span class="keywordtype">int</span> w) {</div><div class="line"><a name="l01646"></a><span class="lineno"> 1646</span>&#160;    <span class="keywordtype">int</span> j = shortOffset;</div><div class="line"><a name="l01647"></a><span class="lineno"> 1647</span>&#160;    <span class="keywordtype">int</span> k = rawOffset;</div><div class="line"><a name="l01648"></a><span class="lineno"> 1648</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; w; i++) {</div><div class="line"><a name="l01649"></a><span class="lineno"> 1649</span>&#160;      pixels[j++] = (short) ((<span class="keywordtype">int</span>) (rawData[k++] &amp; 0xFF) | (((<span class="keywordtype">int</span>) (rawData[k++] &amp; 0xFF)) &lt;&lt; 8));</div><div class="line"><a name="l01650"></a><span class="lineno"> 1650</span>&#160;    }</div><div class="line"><a name="l01651"></a><span class="lineno"> 1651</span>&#160;  }</div><div class="line"><a name="l01652"></a><span class="lineno"> 1652</span>&#160;</div><div class="line"><a name="l01657"></a><span class="lineno"> 1657</span>&#160;  <span class="keyword">final</span> <span class="keywordtype">void</span> writeRGBfromYUV(<span class="keywordtype">int</span> y, <span class="keywordtype">int</span> u, <span class="keywordtype">int</span> v, <span class="keywordtype">int</span>[] pixels, <span class="keywordtype">int</span> intArrayIndex) {</div><div class="line"><a name="l01658"></a><span class="lineno"> 1658</span>&#160;    <span class="comment">// int r = (int)(1.164*(y-16)+1.596*v+0.5);</span></div><div class="line"><a name="l01659"></a><span class="lineno"> 1659</span>&#160;    <span class="comment">// int g = (int)(1.164*(y-16)-0.391*u-0.813*v+0.5);</span></div><div class="line"><a name="l01660"></a><span class="lineno"> 1660</span>&#160;    <span class="comment">// int b = (int)(1.164*(y-16)+2.018*u+0.5);</span></div><div class="line"><a name="l01661"></a><span class="lineno"> 1661</span>&#160;    <span class="keywordtype">int</span> r = (9535 * y + 13074 * v - 148464) &gt;&gt; 13;</div><div class="line"><a name="l01662"></a><span class="lineno"> 1662</span>&#160;    <span class="keywordtype">int</span> g = (9535 * y - 6660 * v - 3203 * u - 148464) &gt;&gt; 13;</div><div class="line"><a name="l01663"></a><span class="lineno"> 1663</span>&#160;    <span class="keywordtype">int</span> b = (9535 * y + 16531 * u - 148464) &gt;&gt; 13;</div><div class="line"><a name="l01664"></a><span class="lineno"> 1664</span>&#160;    <span class="keywordflow">if</span> (r &gt; 255)</div><div class="line"><a name="l01665"></a><span class="lineno"> 1665</span>&#160;      r = 255;</div><div class="line"><a name="l01666"></a><span class="lineno"> 1666</span>&#160;    <span class="keywordflow">if</span> (r &lt; 0)</div><div class="line"><a name="l01667"></a><span class="lineno"> 1667</span>&#160;      r = 0;</div><div class="line"><a name="l01668"></a><span class="lineno"> 1668</span>&#160;    <span class="keywordflow">if</span> (g &gt; 255)</div><div class="line"><a name="l01669"></a><span class="lineno"> 1669</span>&#160;      g = 255;</div><div class="line"><a name="l01670"></a><span class="lineno"> 1670</span>&#160;    <span class="keywordflow">if</span> (g &lt; 0)</div><div class="line"><a name="l01671"></a><span class="lineno"> 1671</span>&#160;      g = 0;</div><div class="line"><a name="l01672"></a><span class="lineno"> 1672</span>&#160;    <span class="keywordflow">if</span> (b &gt; 255)</div><div class="line"><a name="l01673"></a><span class="lineno"> 1673</span>&#160;      b = 255;</div><div class="line"><a name="l01674"></a><span class="lineno"> 1674</span>&#160;    <span class="keywordflow">if</span> (b &lt; 0)</div><div class="line"><a name="l01675"></a><span class="lineno"> 1675</span>&#160;      b = 0;</div><div class="line"><a name="l01676"></a><span class="lineno"> 1676</span>&#160;    pixels[intArrayIndex] = 0xff000000 | (r &lt;&lt; 16) | (g &lt;&lt; 8) | b;</div><div class="line"><a name="l01677"></a><span class="lineno"> 1677</span>&#160;  }</div><div class="line"><a name="l01678"></a><span class="lineno"> 1678</span>&#160;}</div><div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa13826806384d5f2ba71ef4b285ff94f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa13826806384d5f2ba71ef4b285ff94f">third_Party.AVI_Reader.streamNumber</a></div><div class="ttdeci">int streamNumber</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00424">AVI_Reader.java:424</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ac397f59813ccb9e2d9e477a3d796aedf"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ac397f59813ccb9e2d9e477a3d796aedf">third_Party.AVI_Reader.dwStreamStart</a></div><div class="ttdeci">int dwStreamStart</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00479">AVI_Reader.java:479</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad6257fda79573f030a67ca47eecc1fba"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad6257fda79573f030a67ca47eecc1fba">third_Party.AVI_Reader.type0xdb</a></div><div class="ttdeci">int type0xdb</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00425">AVI_Reader.java:425</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad05d8b83afe5487585ba0b76b4e562bf"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad05d8b83afe5487585ba0b76b4e562bf">third_Party.AVI_Reader.dwStreamSuggestedBufferSize</a></div><div class="ttdeci">int dwStreamSuggestedBufferSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00482">AVI_Reader.java:482</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0339593a5d0faed6f1da7d41a631bbfa"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0339593a5d0faed6f1da7d41a631bbfa">third_Party.AVI_Reader.MJPG_COMPRESSION</a></div><div class="ttdeci">static final int MJPG_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00328">AVI_Reader.java:328</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a2f4d53cdf9cb569e0717514dc7a0e9e0"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a2f4d53cdf9cb569e0717514dc7a0e9e0">third_Party.AVI_Reader.biSizeImage</a></div><div class="ttdeci">int biSizeImage</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00493">AVI_Reader.java:493</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8618c6504f71d01eaf20a48c933aa036"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8618c6504f71d01eaf20a48c933aa036">third_Party.AVI_Reader.raFile</a></div><div class="ttdeci">RandomAccessFile raFile</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00420">AVI_Reader.java:420</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4ed3ed255ad8de9543bc052fdf79c1bf"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4ed3ed255ad8de9543bc052fdf79c1bf">third_Party.AVI_Reader.convertToGray</a></div><div class="ttdeci">boolean convertToGray</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00415">AVI_Reader.java:415</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a35aefea5caf4ac524e96bd3aaf72e589"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a35aefea5caf4ac524e96bd3aaf72e589">third_Party.AVI_Reader.frameInfos</a></div><div class="ttdeci">Vector frameInfos</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00449">AVI_Reader.java:449</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7c06c634e54b80462f7a61b91ba2bfc0"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7c06c634e54b80462f7a61b91ba2bfc0">third_Party.AVI_Reader.lastFrameToRead</a></div><div class="ttdeci">int lastFrameToRead</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00437">AVI_Reader.java:437</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a9aa0ffa678be4bc0d8a6dd481d1d5a69"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a9aa0ffa678be4bc0d8a6dd481d1d5a69">third_Party.AVI_Reader.dwInitialFrames</a></div><div class="ttdeci">int dwInitialFrames</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00465">AVI_Reader.java:465</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad5d205e0f80feda5219d2fec97cc7aeb"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad5d205e0f80feda5219d2fec97cc7aeb">third_Party.AVI_Reader.dwStreamFlags</a></div><div class="ttdeci">int dwStreamFlags</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00473">AVI_Reader.java:473</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aea9045a6694e8ada35565a2072f9dc85"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aea9045a6694e8ada35565a2072f9dc85">third_Party.AVI_Reader.readOldFrameIndex</a></div><div class="ttdeci">void readOldFrameIndex(long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01322">AVI_Reader.java:1322</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a6e9e2a42694051e63732ac5fd8188d53"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a6e9e2a42694051e63732ac5fd8188d53">third_Party.AVI_Reader.timeString</a></div><div class="ttdeci">String timeString()</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01538">AVI_Reader.java:1538</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a73bf03f3e7d7151d897dc4686668678c"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a73bf03f3e7d7151d897dc4686668678c">third_Party.AVI_Reader.V422_COMPRESSION</a></div><div class="ttdeci">static final int V422_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00307">AVI_Reader.java:307</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a78973ba2fec408d8cd6551dd6929651f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a78973ba2fec408d8cd6551dd6929651f">third_Party.AVI_Reader.setFramesPerSecond</a></div><div class="ttdeci">void setFramesPerSecond(ImagePlus imp)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01496">AVI_Reader.java:1496</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae622bf22747273cf481d814dfa90eb6f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae622bf22747273cf481d814dfa90eb6f">third_Party.AVI_Reader.raFilePath</a></div><div class="ttdeci">String raFilePath</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00421">AVI_Reader.java:421</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a060fa4dce1c907b733737ef07d44ceca"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a060fa4dce1c907b733737ef07d44ceca">third_Party.AVI_Reader.BITMASK24</a></div><div class="ttdeci">static final int BITMASK24</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00341">AVI_Reader.java:341</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7a2de66ab228979ef527d69ef6f715d8"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7a2de66ab228979ef527d69ef6f715d8">third_Party.AVI_Reader.isVirtual</a></div><div class="ttdeci">boolean isVirtual</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00418">AVI_Reader.java:418</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a9986cc553cf34bcad781fe508172f4ab"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a9986cc553cf34bcad781fe508172f4ab">third_Party.AVI_Reader.run</a></div><div class="ttdeci">void run(String arg)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01453">AVI_Reader.java:1453</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abe195a2bd8d05269e650b346693b3f80"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abe195a2bd8d05269e650b346693b3f80">third_Party.AVI_Reader.findFourccAndRead</a></div><div class="ttdeci">long findFourccAndRead(int fourcc, boolean isList, long endPosition, boolean throwNotFoundException)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00537">AVI_Reader.java:537</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad22821cde3b5326489f24ad437513919"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad22821cde3b5326489f24ad437513919">third_Party.AVI_Reader.readAvi2Index</a></div><div class="ttdeci">void readAvi2Index(long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00847">AVI_Reader.java:847</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa0f9805a5e31b86fdae78b0c83397560"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa0f9805a5e31b86fdae78b0c83397560">third_Party.AVI_Reader.dwHeight</a></div><div class="ttdeci">int dwHeight</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00470">AVI_Reader.java:470</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4de5805ac7c9c98431da308b4680a030"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4de5805ac7c9c98431da308b4680a030">third_Party.AVI_Reader.dwStreamRate</a></div><div class="ttdeci">int dwStreamRate</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00478">AVI_Reader.java:478</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a927a521601ccafb80d30d5d0b6938db4"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a927a521601ccafb80d30d5d0b6938db4">third_Party.AVI_Reader.dwReserved1</a></div><div class="ttdeci">int dwReserved1</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00461">AVI_Reader.java:461</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4d27bb277c107c931e0f80ce7947f5ea"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4d27bb277c107c931e0f80ce7947f5ea">third_Party.AVI_Reader.staticIsVirtual</a></div><div class="ttdeci">static boolean staticIsVirtual</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00364">AVI_Reader.java:364</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_afd0dc38d34abecc1cc6a8e85700fb8aa"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#afd0dc38d34abecc1cc6a8e85700fb8aa">third_Party.AVI_Reader.getWidth</a></div><div class="ttdeci">int getWidth()</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00678">AVI_Reader.java:678</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abf18fc31d04ba9d41a2cf2127a5b4eaf"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abf18fc31d04ba9d41a2cf2127a5b4eaf">third_Party.AVI_Reader.biHeight</a></div><div class="ttdeci">int biHeight</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00488">AVI_Reader.java:488</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a2a2f40a58431f6f38931303068eb2816"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a2a2f40a58431f6f38931303068eb2816">third_Party.AVI_Reader.JPEG_COMPRESSION3</a></div><div class="ttdeci">static final int JPEG_COMPRESSION3</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00325">AVI_Reader.java:325</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae22b1bffcf28d81d7416e1393ef6a5e3"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae22b1bffcf28d81d7416e1393ef6a5e3">third_Party.AVI_Reader.variableLength</a></div><div class="ttdeci">boolean variableLength</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00446">AVI_Reader.java:446</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a1d0790ceb95e12b7cbca6a0a0958ce83"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a1d0790ceb95e12b7cbca6a0a0958ce83">third_Party.AVI_Reader.aborting</a></div><div class="ttdeci">boolean aborting</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00457">AVI_Reader.java:457</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a1f0f36836e9db15d92386a6af40d20db"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a1f0f36836e9db15d92386a6af40d20db">third_Party.AVI_Reader.NO_COMPRESSION</a></div><div class="ttdeci">static final int NO_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00275">AVI_Reader.java:275</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a79325bbe63915f151cb0a6dc44bf0425"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a79325bbe63915f151cb0a6dc44bf0425">third_Party.AVI_Reader.FOURCC_vids</a></div><div class="ttdeci">static final int FOURCC_vids</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00270">AVI_Reader.java:270</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a857b41097078525ba73d3d62fe99047e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a857b41097078525ba73d3d62fe99047e">third_Party.AVI_Reader.getImagePlus</a></div><div class="ttdeci">ImagePlus getImagePlus()</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00616">AVI_Reader.java:616</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0f7f2e01806b2d5f10b90b7af43a2c5d"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0f7f2e01806b2d5f10b90b7af43a2c5d">third_Party.AVI_Reader.FOURCC_00db</a></div><div class="ttdeci">static final int FOURCC_00db</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00271">AVI_Reader.java:271</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aec1d39b5f017b81e865a3e77708d06af"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aec1d39b5f017b81e865a3e77708d06af">third_Party.AVI_Reader.NO_COMPRESSION_GREY</a></div><div class="ttdeci">static final int NO_COMPRESSION_GREY</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00286">AVI_Reader.java:286</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0416d25470c685f6657b2a6b1f25e48c"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0416d25470c685f6657b2a6b1f25e48c">third_Party.AVI_Reader.AYUV_COMPRESSION</a></div><div class="ttdeci">static final int AYUV_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00294">AVI_Reader.java:294</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a3718d0e6f5e4617dcc81a8e481361c7e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a3718d0e6f5e4617dcc81a8e481361c7e">third_Party.AVI_Reader.stack</a></div><div class="ttdeci">ImageStack stack</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00451">AVI_Reader.java:451</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ac3215b5ca71c819b5596da8de72d1c51"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ac3215b5ca71c819b5596da8de72d1c51">third_Party.AVI_Reader.firstFrame</a></div><div class="ttdeci">int firstFrame</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00413">AVI_Reader.java:413</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa5be394b26e7e3ab6e590ce7d455a05b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa5be394b26e7e3ab6e590ce7d455a05b">third_Party.AVI_Reader.AVI_INDEX_OF_INDEXES</a></div><div class="ttdeci">static final byte AVI_INDEX_OF_INDEXES</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00358">AVI_Reader.java:358</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4c7dafb648f3af0e271835e7b57d336b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4c7dafb648f3af0e271835e7b57d336b">third_Party.AVI_Reader.dwStreamQuality</a></div><div class="ttdeci">int dwStreamQuality</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00483">AVI_Reader.java:483</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_af6db5b310a46bfa10d55b88219caf652"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#af6db5b310a46bfa10d55b88219caf652">third_Party.AVI_Reader.AVIF_MUSTUSEINDEX</a></div><div class="ttdeci">static final int AVIF_MUSTUSEINDEX</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00349">AVI_Reader.java:349</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ab5eedec5cfca724a1ae285acde216554"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ab5eedec5cfca724a1ae285acde216554">third_Party.AVI_Reader.paddingGranularity</a></div><div class="ttdeci">int paddingGranularity</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00433">AVI_Reader.java:433</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a317f840efd0048699567082757a29245"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a317f840efd0048699567082757a29245">third_Party.AVI_Reader.PNG_COMPRESSION2</a></div><div class="ttdeci">static final int PNG_COMPRESSION2</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00335">AVI_Reader.java:335</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a9ea7f652ebad5fd64eaf7510593099ca"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a9ea7f652ebad5fd64eaf7510593099ca">third_Party.AVI_Reader.FOURCC_strf</a></div><div class="ttdeci">static final int FOURCC_strf</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00266">AVI_Reader.java:266</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7ce69cd349ed8434299bbf8688a22971"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7ce69cd349ed8434299bbf8688a22971">third_Party.AVI_Reader.dwMaxBytesPerSec</a></div><div class="ttdeci">int dwMaxBytesPerSec</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00460">AVI_Reader.java:460</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a2ae593bd5a753069baf4f052e4436ff6"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a2ae593bd5a753069baf4f052e4436ff6">third_Party.AVI_Reader.BUFFERSIZE</a></div><div class="ttdeci">final static int BUFFERSIZE</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00370">AVI_Reader.java:370</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a2162fee9234157ca1547716e83a26f37"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a2162fee9234157ca1547716e83a26f37">third_Party.AVI_Reader.dataCompression</a></div><div class="ttdeci">int dataCompression</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00442">AVI_Reader.java:442</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aac533bfe76b36f0fb97cf2b737483911"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aac533bfe76b36f0fb97cf2b737483911">third_Party.AVI_Reader.PNG_COMPRESSION3</a></div><div class="ttdeci">static final int PNG_COMPRESSION3</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00339">AVI_Reader.java:339</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a5ee060949ab9bce8c73729050bc737a2"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a5ee060949ab9bce8c73729050bc737a2">third_Party.AVI_Reader.dataTopDown</a></div><div class="ttdeci">boolean dataTopDown</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00444">AVI_Reader.java:444</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a3ed951465a3d01864dfcd07e0f62fff4"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a3ed951465a3d01864dfcd07e0f62fff4">third_Party.AVI_Reader.openAndReadHeader</a></div><div class="ttdeci">void openAndReadHeader(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00739">AVI_Reader.java:739</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a41caf5016716a9db732d16f7f7cfeaad"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a41caf5016716a9db732d16f7f7cfeaad">third_Party.AVI_Reader.FOURCC_indx</a></div><div class="ttdeci">static final int FOURCC_indx</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00258">AVI_Reader.java:258</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a6e950b01e3308a25915da47063657900"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a6e950b01e3308a25915da47063657900">third_Party.AVI_Reader.JPEG_COMPRESSION</a></div><div class="ttdeci">static final int JPEG_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00319">AVI_Reader.java:319</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7da1a1be394a0f561653e1c1be3b3c19"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7da1a1be394a0f561653e1c1be3b3c19">third_Party.AVI_Reader.biXPelsPerMeter</a></div><div class="ttdeci">int biXPelsPerMeter</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00496">AVI_Reader.java:496</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abd76827a0d420fc84cea9939fa729629"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abd76827a0d420fc84cea9939fa729629">third_Party.AVI_Reader.biSize</a></div><div class="ttdeci">int biSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00486">AVI_Reader.java:486</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae17659bc83a5a05ced0bb379c8fbfd19"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae17659bc83a5a05ced0bb379c8fbfd19">third_Party.AVI_Reader.FOURCC_movi</a></div><div class="ttdeci">static final int FOURCC_movi</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00267">AVI_Reader.java:267</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aeecf0501939b72f8c9439da4ffb31681"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aeecf0501939b72f8c9439da4ffb31681">third_Party.AVI_Reader.dwPriorityLanguage</a></div><div class="ttdeci">int dwPriorityLanguage</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00474">AVI_Reader.java:474</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a1219695073e216806175234ee03f49b9"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a1219695073e216806175234ee03f49b9">third_Party.AVI_Reader.headerPositionEnd</a></div><div class="ttdeci">long headerPositionEnd</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00429">AVI_Reader.java:429</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abd09c719eac6258ba43f4f22ba6e587e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abd09c719eac6258ba43f4f22ba6e587e">third_Party.AVI_Reader.readAVI</a></div><div class="ttdeci">void readAVI(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00772">AVI_Reader.java:772</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a215ef7fd53bae77c17ea7d3743948ef8"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a215ef7fd53bae77c17ea7d3743948ef8">third_Party.AVI_Reader.posSizeString</a></div><div class="ttdeci">String posSizeString(long pos, long size)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00767">AVI_Reader.java:767</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aefc30707c2f9e4d9294f23590613584e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aefc30707c2f9e4d9294f23590613584e">third_Party.AVI_Reader.UYNV_COMPRESSION</a></div><div class="ttdeci">static final int UYNV_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00303">AVI_Reader.java:303</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad2278f058a9bb4421b37747cf5c5bd32"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad2278f058a9bb4421b37747cf5c5bd32">third_Party.AVI_Reader.imp</a></div><div class="ttdeci">ImagePlus imp</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00453">AVI_Reader.java:453</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a270bcae68f2d35537d6eb66edce16058"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a270bcae68f2d35537d6eb66edce16058">third_Party.AVI_Reader.scanLineSize</a></div><div class="ttdeci">int scanLineSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00443">AVI_Reader.java:443</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a169633f81044867d9ac16d556f878916"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a169633f81044867d9ac16d556f878916">third_Party.AVI_Reader.FOURCC_strh</a></div><div class="ttdeci">static final int FOURCC_strh</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00265">AVI_Reader.java:265</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a85350caab45622b078587a67833fe2b4"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a85350caab45622b078587a67833fe2b4">third_Party.AVI_Reader.readContents</a></div><div class="ttdeci">boolean readContents(int fourcc, long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01139">AVI_Reader.java:1139</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aafa0b30baaf56a88cdd8f4d40d979776"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aafa0b30baaf56a88cdd8f4d40d979776">third_Party.AVI_Reader.HUFFMAN_LENGTH</a></div><div class="ttdeci">final static int HUFFMAN_LENGTH</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00411">AVI_Reader.java:411</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad9521d7c6e8c59f4a5ee43a9de2b9865"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad9521d7c6e8c59f4a5ee43a9de2b9865">third_Party.AVI_Reader.FOURCC_ix00</a></div><div class="ttdeci">static final int FOURCC_ix00</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00257">AVI_Reader.java:257</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7a8a9e1a6cdb0c23f0920887559e20fa"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7a8a9e1a6cdb0c23f0920887559e20fa">third_Party.AVI_Reader.readCompressedFrame</a></div><div class="ttdeci">Object readCompressedFrame(RandomAccessFile rFile, int size)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01116">AVI_Reader.java:1116</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0036bc3816e079367360ff7f0a713682"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0036bc3816e079367360ff7f0a713682">third_Party.AVI_Reader.exceptionMessage</a></div><div class="ttdeci">String exceptionMessage(Exception e)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00523">AVI_Reader.java:523</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_acf3deb2ecb0e067f80f2dc6a2f34f010"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#acf3deb2ecb0e067f80f2dc6a2f34f010">third_Party.AVI_Reader.YUY2_COMPRESSION</a></div><div class="ttdeci">static final int YUY2_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00309">AVI_Reader.java:309</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a3789f5d56eb31a9779e684c7deb6ee3a"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a3789f5d56eb31a9779e684c7deb6ee3a">third_Party.AVI_Reader.NO_COMPRESSION_Y8</a></div><div class="ttdeci">static final int NO_COMPRESSION_Y8</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00284">AVI_Reader.java:284</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a1c9b6b612edba7d066f7385771c15613"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a1c9b6b612edba7d066f7385771c15613">third_Party.AVI_Reader.staticConvertToGray</a></div><div class="ttdeci">static boolean staticConvertToGray</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00362">AVI_Reader.java:362</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a889770167a698f8bfa91ee66947af086"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a889770167a698f8bfa91ee66947af086">third_Party.AVI_Reader.AVI_INDEX_OF_CHUNKS</a></div><div class="ttdeci">static final byte AVI_INDEX_OF_CHUNKS</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00356">AVI_Reader.java:356</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a66745b6dd14a2d5a3540fe40108e6c57"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a66745b6dd14a2d5a3540fe40108e6c57">third_Party.AVI_Reader.FOURCC_idx1</a></div><div class="ttdeci">static final int FOURCC_idx1</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00259">AVI_Reader.java:259</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a31a4fa4c68cbc3c5fc109a866190c528"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a31a4fa4c68cbc3c5fc109a866190c528">third_Party.AVI_Reader.biCompression</a></div><div class="ttdeci">int biCompression</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00492">AVI_Reader.java:492</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aff28fa92f59b85a19c8d53b6fcabe69e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aff28fa92f59b85a19c8d53b6fcabe69e">third_Party.AVI_Reader.NO_COMPRESSION_Y800</a></div><div class="ttdeci">static final int NO_COMPRESSION_Y800</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00281">AVI_Reader.java:281</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_adf0ed21b252fa1d8aee518d97c43509b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#adf0ed21b252fa1d8aee518d97c43509b">third_Party.AVI_Reader.FOURCC_JUNK</a></div><div class="ttdeci">static final int FOURCC_JUNK</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00269">AVI_Reader.java:269</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a68aadbc95be2cc904f2ad270a6c1a294"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a68aadbc95be2cc904f2ad270a6c1a294">third_Party.AVI_Reader.headerOK</a></div><div class="ttdeci">boolean headerOK</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00422">AVI_Reader.java:422</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ad6d68bb12b1df808a76e92a5b1e3f5fd"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ad6d68bb12b1df808a76e92a5b1e3f5fd">third_Party.AVI_Reader.lastFrame</a></div><div class="ttdeci">int lastFrame</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00414">AVI_Reader.java:414</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ab646837fe76c95f4e50b41ce2a32cf54"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ab646837fe76c95f4e50b41ce2a32cf54">third_Party.AVI_Reader.indexForCountingOnly</a></div><div class="ttdeci">boolean indexForCountingOnly</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00439">AVI_Reader.java:439</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a88bb4aaade5e30fed579a366ec01aaef"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a88bb4aaade5e30fed579a366ec01aaef">third_Party.AVI_Reader.dwStreamLength</a></div><div class="ttdeci">int dwStreamLength</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00481">AVI_Reader.java:481</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0272cce922406183d9d5ac381e78908b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0272cce922406183d9d5ac381e78908b">third_Party.AVI_Reader.indexPositionEnd</a></div><div class="ttdeci">long indexPositionEnd</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00431">AVI_Reader.java:431</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abae261f54bdef65ceb5328e248922c17"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abae261f54bdef65ceb5328e248922c17">third_Party.AVI_Reader.FOURCC_strl</a></div><div class="ttdeci">static final int FOURCC_strl</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00264">AVI_Reader.java:264</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa9e38fa52fb30a225ae304cbc51f6a9f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa9e38fa52fb30a225ae304cbc51f6a9f">third_Party.AVI_Reader.biPlanes</a></div><div class="ttdeci">short biPlanes</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00489">AVI_Reader.java:489</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a08c43e3e1b584ab46351d34f5e673d52"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a08c43e3e1b584ab46351d34f5e673d52">third_Party.AVI_Reader.dwWidth</a></div><div class="ttdeci">int dwWidth</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00469">AVI_Reader.java:469</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a38fa9e3cad9c0a5a7df0ddd3d11aad0e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a38fa9e3cad9c0a5a7df0ddd3d11aad0e">third_Party.AVI_Reader.JPEG_COMPRESSION2</a></div><div class="ttdeci">static final int JPEG_COMPRESSION2</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00322">AVI_Reader.java:322</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a060dc5f95135dda72fcb1fc27ddc0c3f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a060dc5f95135dda72fcb1fc27ddc0c3f">third_Party.AVI_Reader.posSizeString</a></div><div class="ttdeci">String posSizeString(long size)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00763">AVI_Reader.java:763</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a163cd0565b88b3dead8638bb2b78e0ee"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a163cd0565b88b3dead8638bb2b78e0ee">third_Party.AVI_Reader.readType</a></div><div class="ttdeci">int readType(long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01430">AVI_Reader.java:1430</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa9e91f666aee5aaa5e4e8de3a8a0d04c"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa9e91f666aee5aaa5e4e8de3a8a0d04c">third_Party.AVI_Reader.FOURCC_LIST</a></div><div class="ttdeci">static final int FOURCC_LIST</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00261">AVI_Reader.java:261</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7fe2f1443f6ace6bc10f161736cf37fe"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7fe2f1443f6ace6bc10f161736cf37fe">third_Party.AVI_Reader.dwSuggestedBufferSize</a></div><div class="ttdeci">int dwSuggestedBufferSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00468">AVI_Reader.java:468</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ac4222c0f7a1f465b2501b8a6d494b97d"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ac4222c0f7a1f465b2501b8a6d494b97d">third_Party.AVI_Reader.dwStreamSampleSize</a></div><div class="ttdeci">int dwStreamSampleSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00484">AVI_Reader.java:484</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html">third_Party.AVI_Reader</a></div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00150">AVI_Reader.java:150</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a6232c065caed00248e86b52888e9b752"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a6232c065caed00248e86b52888e9b752">third_Party.AVI_Reader.FOURCC_rec</a></div><div class="ttdeci">static final int FOURCC_rec</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00268">AVI_Reader.java:268</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a5f50db97ac24d22f928d9fe84349df6b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a5f50db97ac24d22f928d9fe84349df6b">third_Party.AVI_Reader.dwFlags</a></div><div class="ttdeci">int dwFlags</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00462">AVI_Reader.java:462</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_af71dfd9842e0d49e7093425c682accc2"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#af71dfd9842e0d49e7093425c682accc2">third_Party.AVI_Reader.dwStreams</a></div><div class="ttdeci">int dwStreams</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00467">AVI_Reader.java:467</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a736023d549bc0b8cdd7d4519f344a613"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a736023d549bc0b8cdd7d4519f344a613">third_Party.AVI_Reader.biYPelsPerMeter</a></div><div class="ttdeci">int biYPelsPerMeter</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00499">AVI_Reader.java:499</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8dffa6826007ce508024f79583167472"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8dffa6826007ce508024f79583167472">third_Party.AVI_Reader.FOURCC_hdrl</a></div><div class="ttdeci">static final int FOURCC_hdrl</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00262">AVI_Reader.java:262</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0ce25d675c642fe70f4b9568e6514dc0"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0ce25d675c642fe70f4b9568e6514dc0">third_Party.AVI_Reader.getProcessor</a></div><div class="ttdeci">synchronized ImageProcessor getProcessor(int n)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00625">AVI_Reader.java:625</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a482297bdb9a884d5820d1342f0e13d8a"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a482297bdb9a884d5820d1342f0e13d8a">third_Party.AVI_Reader.Y422_COMPRESSION</a></div><div class="ttdeci">static final int Y422_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00301">AVI_Reader.java:301</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a35f0e3b79e23892ab4cf6b8e2628bef7"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a35f0e3b79e23892ab4cf6b8e2628bef7">third_Party.AVI_Reader.PNG_COMPRESSION</a></div><div class="ttdeci">static final int PNG_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00332">AVI_Reader.java:332</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_afceeac5fe2c92fbc4a2bf188bf7b27e4"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#afceeac5fe2c92fbc4a2bf188bf7b27e4">third_Party.AVI_Reader.showDialog</a></div><div class="ttdeci">boolean showDialog(String fileName)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01506">AVI_Reader.java:1506</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a05011c9bdfcfe2e5b3489416fb12ff87"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a05011c9bdfcfe2e5b3489416fb12ff87">third_Party.AVI_Reader.readAVIX</a></div><div class="ttdeci">void readAVIX(long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00958">AVI_Reader.java:958</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a16f7685800fae0997023bdb905c94d72"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a16f7685800fae0997023bdb905c94d72">third_Party.AVI_Reader.NO_COMPRESSION_MIL</a></div><div class="ttdeci">static final int NO_COMPRESSION_MIL</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00292">AVI_Reader.java:292</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abcd92cbd1dcb6a276e2917ab5cd8f4bd"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abcd92cbd1dcb6a276e2917ab5cd8f4bd">third_Party.AVI_Reader.moviPosition</a></div><div class="ttdeci">long moviPosition</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00432">AVI_Reader.java:432</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a23c19fb8474ea86b45cfa13fe4dd16dd"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a23c19fb8474ea86b45cfa13fe4dd16dd">third_Party.AVI_Reader.YUNV_COMPRESSION</a></div><div class="ttdeci">static final int YUNV_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00312">AVI_Reader.java:312</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8a6d0d067c96a7855defd0b583175a69"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8a6d0d067c96a7855defd0b583175a69">third_Party.AVI_Reader.dwStreamInitialFrames</a></div><div class="ttdeci">int dwStreamInitialFrames</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00476">AVI_Reader.java:476</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a2b73f21f7624cabb5866d7f4efb510ae"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a2b73f21f7624cabb5866d7f4efb510ae">third_Party.AVI_Reader.cm</a></div><div class="ttdeci">ColorModel cm</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00445">AVI_Reader.java:445</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a7e97ef03c7c523da98768584afc88d78"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a7e97ef03c7c523da98768584afc88d78">third_Party.AVI_Reader.FOURCC_avih</a></div><div class="ttdeci">static final int FOURCC_avih</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00263">AVI_Reader.java:263</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a1b8bc08588b4d1c07756176010cecd58"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a1b8bc08588b4d1c07756176010cecd58">third_Party.AVI_Reader.biClrImportant</a></div><div class="ttdeci">int biClrImportant</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00503">AVI_Reader.java:503</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_afafd9f635c9ae45059288714c17b2daa"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#afafd9f635c9ae45059288714c17b2daa">third_Party.AVI_Reader.FOURCC_AVIX</a></div><div class="ttdeci">static final int FOURCC_AVIX</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00256">AVI_Reader.java:256</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_adddcf5a0e55227976c71d5fd5916b0a5"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#adddcf5a0e55227976c71d5fd5916b0a5">third_Party.AVI_Reader.NO_COMPRESSION_RGB</a></div><div class="ttdeci">static final int NO_COMPRESSION_RGB</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00277">AVI_Reader.java:277</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a226b0a1d6946d4295dd0f0472f0ee378"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a226b0a1d6946d4295dd0f0472f0ee378">third_Party.AVI_Reader.dwMicroSecPerFrame</a></div><div class="ttdeci">int dwMicroSecPerFrame</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00459">AVI_Reader.java:459</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a85598e264b22ea229afe9e0d9a5bc968"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a85598e264b22ea229afe9e0d9a5bc968">third_Party.AVI_Reader.FOURCC_00dc</a></div><div class="ttdeci">static final int FOURCC_00dc</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00273">AVI_Reader.java:273</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4fb4207960d5de1c5dfab8e085517e49"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4fb4207960d5de1c5dfab8e085517e49">third_Party.AVI_Reader.verbose</a></div><div class="ttdeci">boolean verbose</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00455">AVI_Reader.java:455</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a038e3c7cc6e7d22182bd5e83725f971f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a038e3c7cc6e7d22182bd5e83725f971f">third_Party.AVI_Reader.fourccString</a></div><div class="ttdeci">String fourccString(int fourcc)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00596">AVI_Reader.java:596</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aad6e7cb0d09711ad82ecf6fe3defab69"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aad6e7cb0d09711ad82ecf6fe3defab69">third_Party.AVI_Reader.HUFFMAN_TABLES</a></div><div class="ttdeci">final static byte [] HUFFMAN_TABLES</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00373">AVI_Reader.java:373</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abdad34900c6c58013d7d982d29b4575b"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abdad34900c6c58013d7d982d29b4575b">third_Party.AVI_Reader.AVIF_HASINDEX</a></div><div class="ttdeci">static final int AVIF_HASINDEX</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00348">AVI_Reader.java:348</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ac50ce7513ebc95b0f78d6920bd306f52"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ac50ce7513ebc95b0f78d6920bd306f52">third_Party.AVI_Reader.SIZE_MASK</a></div><div class="ttdeci">static final long SIZE_MASK</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00344">AVI_Reader.java:344</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ac3f9afd4034b5c3e012207318a5256e5"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ac3f9afd4034b5c3e012207318a5256e5">third_Party.AVI_Reader.frameNumber</a></div><div class="ttdeci">int frameNumber</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00434">AVI_Reader.java:434</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_af80522b94aad967163e1c1f632ccae18"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#af80522b94aad967163e1c1f632ccae18">third_Party.AVI_Reader.flipVertical</a></div><div class="ttdeci">boolean flipVertical</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00417">AVI_Reader.java:417</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a18ff7da5dccb4c6607f2dc5068f2cbee"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a18ff7da5dccb4c6607f2dc5068f2cbee">third_Party.AVI_Reader.NO_COMPRESSION_RAW</a></div><div class="ttdeci">static final int NO_COMPRESSION_RAW</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00279">AVI_Reader.java:279</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae51c21e096fc7d3c16c4b098e8772b50"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae51c21e096fc7d3c16c4b098e8772b50">third_Party.AVI_Reader.startTime</a></div><div class="ttdeci">long startTime</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00456">AVI_Reader.java:456</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_afc4ad2de3e2a87833b883d0c2be1c26c"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#afc4ad2de3e2a87833b883d0c2be1c26c">third_Party.AVI_Reader.dwStreamScale</a></div><div class="ttdeci">int dwStreamScale</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00477">AVI_Reader.java:477</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a61f851865cb3fb2ac79662c76f75d1e1"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a61f851865cb3fb2ac79662c76f75d1e1">third_Party.AVI_Reader.YVYU_COMPRESSION</a></div><div class="ttdeci">static final int YVYU_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00316">AVI_Reader.java:316</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae73329845c623f6ec46c0d2015232711"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae73329845c623f6ec46c0d2015232711">third_Party.AVI_Reader.indexPosition</a></div><div class="ttdeci">long indexPosition</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00430">AVI_Reader.java:430</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a336978e2eb7112d383ea131ff8bd0193"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a336978e2eb7112d383ea131ff8bd0193">third_Party.AVI_Reader.frameLabel</a></div><div class="ttdeci">String frameLabel(long timeMicroSec)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00606">AVI_Reader.java:606</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a687586aa131c3fed450ee954833497de"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a687586aa131c3fed450ee954833497de">third_Party.AVI_Reader.dwTotalFrames</a></div><div class="ttdeci">int dwTotalFrames</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00463">AVI_Reader.java:463</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8ab8de0b3441fc072aa023892c98a230"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8ab8de0b3441fc072aa023892c98a230">third_Party.AVI_Reader.deleteSlice</a></div><div class="ttdeci">void deleteSlice(int n)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00510">AVI_Reader.java:510</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a192aaa41f285d424c462e29ef7f6e87e"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a192aaa41f285d424c462e29ef7f6e87e">third_Party.AVI_Reader.YUYV_COMPRESSION</a></div><div class="ttdeci">static final int YUYV_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00314">AVI_Reader.java:314</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4c4590dd4505a88b0a26aee5d575df20"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4c4590dd4505a88b0a26aee5d575df20">third_Party.AVI_Reader.findFourccAndSkip</a></div><div class="ttdeci">long findFourccAndSkip(int fourcc, boolean isList, long endPosition)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00572">AVI_Reader.java:572</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_afee2b0fe721d4be2e5d6edec9eef0e09"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#afee2b0fe721d4be2e5d6edec9eef0e09">third_Party.AVI_Reader.UYVY_COMPRESSION</a></div><div class="ttdeci">static final int UYVY_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00298">AVI_Reader.java:298</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_abf21677829232d48cb9bc1efcdfd1557"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#abf21677829232d48cb9bc1efcdfd1557">third_Party.AVI_Reader.staticFlipVertical</a></div><div class="ttdeci">static boolean staticFlipVertical</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00363">AVI_Reader.java:363</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ada09a7124313fca7fec5b0d7b8eab470"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ada09a7124313fca7fec5b0d7b8eab470">third_Party.AVI_Reader.aviSize</a></div><div class="ttdeci">long aviSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00428">AVI_Reader.java:428</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a3bd3cdd8c8ece98211ccf6b866093dc5"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a3bd3cdd8c8ece98211ccf6b866093dc5">third_Party.AVI_Reader.getSize</a></div><div class="ttdeci">int getSize()</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00660">AVI_Reader.java:660</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_adcbc1efe812b80e03f786802aca91c9f"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#adcbc1efe812b80e03f786802aca91c9f">third_Party.AVI_Reader.fccStreamHandler</a></div><div class="ttdeci">int fccStreamHandler</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00472">AVI_Reader.java:472</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a398f49f5494ee8c68e125e2910c09c71"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a398f49f5494ee8c68e125e2910c09c71">third_Party.AVI_Reader.readFixedLengthFrame</a></div><div class="ttdeci">Object readFixedLengthFrame(RandomAccessFile rFile, int size)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01197">AVI_Reader.java:1197</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a00c56445525fd1e21ef004a496ac4b40"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a00c56445525fd1e21ef004a496ac4b40">third_Party.AVI_Reader.AVIF_ISINTERLEAVED</a></div><div class="ttdeci">static final int AVIF_ISINTERLEAVED</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00352">AVI_Reader.java:352</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a0be6592d9bd99ecad01a7877e6caeadb"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a0be6592d9bd99ecad01a7877e6caeadb">third_Party.AVI_Reader.biClrUsed</a></div><div class="ttdeci">int biClrUsed</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00501">AVI_Reader.java:501</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a940c57c06ee865b01eba1b36ccd87817"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a940c57c06ee865b01eba1b36ccd87817">third_Party.AVI_Reader.FOURCC_RIFF</a></div><div class="ttdeci">static final int FOURCC_RIFF</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00254">AVI_Reader.java:254</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a54eb6f808c5b9eee02976314a451dcad"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a54eb6f808c5b9eee02976314a451dcad">third_Party.AVI_Reader.CYUV_COMPRESSION</a></div><div class="ttdeci">static final int CYUV_COMPRESSION</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00305">AVI_Reader.java:305</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_ae699b81fde03f1f2acf246a66ca12770"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#ae699b81fde03f1f2acf246a66ca12770">third_Party.AVI_Reader.makeStack</a></div><div class="ttdeci">ImageStack makeStack(String path, int firstFrame, int lastFrame, boolean isVirtual, boolean convertToGray, boolean flipVertical)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00700">AVI_Reader.java:700</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a5847e6c3323a34b06326a61e874616b2"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a5847e6c3323a34b06326a61e874616b2">third_Party.AVI_Reader.getSliceLabel</a></div><div class="ttdeci">String getSliceLabel(int n)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00671">AVI_Reader.java:671</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a06edff2c6566087d15d8cf7bd653da74"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a06edff2c6566087d15d8cf7bd653da74">third_Party.AVI_Reader.FOURCC_AVI</a></div><div class="ttdeci">static final int FOURCC_AVI</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00255">AVI_Reader.java:255</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa71c4bd35a9fe20e158956bd2cb25b28"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa71c4bd35a9fe20e158956bd2cb25b28">third_Party.AVI_Reader.totalFramesFromIndex</a></div><div class="ttdeci">int totalFramesFromIndex</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00438">AVI_Reader.java:438</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8996757bd683838a4c14dc3802bc4d80"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8996757bd683838a4c14dc3802bc4d80">third_Party.AVI_Reader.biWidth</a></div><div class="ttdeci">int biWidth</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00487">AVI_Reader.java:487</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_adb6767b5b747f411aa4b70fe8f9e8994"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#adb6767b5b747f411aa4b70fe8f9e8994">third_Party.AVI_Reader.NO_COMPRESSION_Y16</a></div><div class="ttdeci">static final int NO_COMPRESSION_Y16</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00288">AVI_Reader.java:288</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a8c2b5b20326297322c3386972e2df424"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a8c2b5b20326297322c3386972e2df424">third_Party.AVI_Reader.fileSize</a></div><div class="ttdeci">long fileSize</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00427">AVI_Reader.java:427</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aff3fc9eaa729eaec5eb046fefd4d04fc"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aff3fc9eaa729eaec5eb046fefd4d04fc">third_Party.AVI_Reader.error</a></div><div class="ttdeci">void error(String msg)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00518">AVI_Reader.java:518</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_aa67e28fcf751e79407a8e33309c4df59"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#aa67e28fcf751e79407a8e33309c4df59">third_Party.AVI_Reader.getHeight</a></div><div class="ttdeci">int getHeight()</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00611">AVI_Reader.java:611</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4a25d354ac0e1c0771dde30e7e7379ae"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4a25d354ac0e1c0771dde30e7e7379ae">third_Party.AVI_Reader.readFrame</a></div><div class="ttdeci">Object readFrame(RandomAccessFile rFile, long filePos, int size)</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l01239">AVI_Reader.java:1239</a></div></div>
<div class="ttc" id="classthird___party_1_1_a_v_i___reader_html_a4a949422fb2bb2aa1b70307b7591def9"><div class="ttname"><a href="classthird___party_1_1_a_v_i___reader.html#a4a949422fb2bb2aa1b70307b7591def9">third_Party.AVI_Reader.biBitCount</a></div><div class="ttdeci">short biBitCount</div><div class="ttdef"><b>Definition:</b> <a href="_a_v_i___reader_8java_source.html#l00491">AVI_Reader.java:491</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5eb159725f84c66aafd839904a4acdd0.html">main</a></li><li class="navelem"><a class="el" href="dir_fd3f6763802dee1ad875f6c80eac0bda.html">java</a></li><li class="navelem"><a class="el" href="dir_b038f93d3b3b8074c52047f40e037da1.html">third_Party</a></li><li class="navelem"><a class="el" href="_a_v_i___reader_8java.html">AVI_Reader.java</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
