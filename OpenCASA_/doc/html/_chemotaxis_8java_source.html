<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.12"/>
<meta name="viewport" content="width=device-width, initial-scale=1"/>
<title>OpenCASA: Chemotaxis.java Source File</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtreedata.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/searchdata.js"></script>
<script type="text/javascript" src="search/search.js"></script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td id="projectlogo"><img alt="Logo" src="Morphometry.png"/></td>
  <td id="projectalign" style="padding-left: 0.5em;">
   <div id="projectname">OpenCASA
   &#160;<span id="projectnumber">v0.8</span>
   </div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.12 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
<script type="text/javascript" src="menudata.js"></script>
<script type="text/javascript" src="menu.js"></script>
<script type="text/javascript">
$(function() {
  initMenu('',true,false,'search.php','Search');
  $(document).ready(function() { init_search(); });
});
</script>
<div id="main-nav"></div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('_chemotaxis_8java_source.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
</div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="headertitle">
<div class="title">Chemotaxis.java</div>  </div>
</div><!--header-->
<div class="contents">
<a href="_chemotaxis_8java.html">Go to the documentation of this file.</a><div class="fragment"><div class="line"><a name="l00001"></a><span class="lineno">    1</span>&#160;<span class="comment">/*</span></div><div class="line"><a name="l00002"></a><span class="lineno">    2</span>&#160;<span class="comment"> *   OpenCASA software v0.8 for video and image analysis</span></div><div class="line"><a name="l00003"></a><span class="lineno">    3</span>&#160;<span class="comment"> *   Copyright (C) 2017  Carlos Alqu√©zar</span></div><div class="line"><a name="l00004"></a><span class="lineno">    4</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00005"></a><span class="lineno">    5</span>&#160;<span class="comment"> *   This program is free software: you can redistribute it and/or modify</span></div><div class="line"><a name="l00006"></a><span class="lineno">    6</span>&#160;<span class="comment"> *   it under the terms of the GNU General Public License as published by</span></div><div class="line"><a name="l00007"></a><span class="lineno">    7</span>&#160;<span class="comment"> *   the Free Software Foundation, either version 3 of the License, or</span></div><div class="line"><a name="l00008"></a><span class="lineno">    8</span>&#160;<span class="comment"> *   (at your option) any later version.</span></div><div class="line"><a name="l00009"></a><span class="lineno">    9</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00010"></a><span class="lineno">   10</span>&#160;<span class="comment"> *   This program is distributed in the hope that it will be useful,</span></div><div class="line"><a name="l00011"></a><span class="lineno">   11</span>&#160;<span class="comment"> *   but WITHOUT ANY WARRANTY; without even the implied warranty of</span></div><div class="line"><a name="l00012"></a><span class="lineno">   12</span>&#160;<span class="comment"> *   MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span></div><div class="line"><a name="l00013"></a><span class="lineno">   13</span>&#160;<span class="comment"> *   GNU General Public License for more details.</span></div><div class="line"><a name="l00014"></a><span class="lineno">   14</span>&#160;<span class="comment"> *</span></div><div class="line"><a name="l00015"></a><span class="lineno">   15</span>&#160;<span class="comment"> *   You should have received a copy of the GNU General Public License</span></div><div class="line"><a name="l00016"></a><span class="lineno">   16</span>&#160;<span class="comment"> *   along with this program.  If not, see &lt;https://www.gnu.org/licenses/&gt;.</span></div><div class="line"><a name="l00017"></a><span class="lineno">   17</span>&#160;<span class="comment">*/</span>         </div><div class="line"><a name="l00018"></a><span class="lineno">   18</span>&#160;</div><div class="line"><a name="l00019"></a><span class="lineno"><a class="line" href="namespaceanalysis.html">   19</a></span>&#160;<span class="keyword">package </span>analysis;</div><div class="line"><a name="l00020"></a><span class="lineno">   20</span>&#160;</div><div class="line"><a name="l00021"></a><span class="lineno">   21</span>&#160;<span class="keyword">import</span> java.util.ArrayList;</div><div class="line"><a name="l00022"></a><span class="lineno">   22</span>&#160;<span class="keyword">import</span> java.util.Collections;</div><div class="line"><a name="l00023"></a><span class="lineno">   23</span>&#160;<span class="keyword">import</span> java.util.HashMap;</div><div class="line"><a name="l00024"></a><span class="lineno">   24</span>&#160;<span class="keyword">import</span> java.util.List;</div><div class="line"><a name="l00025"></a><span class="lineno">   25</span>&#160;<span class="keyword">import</span> java.util.ListIterator;</div><div class="line"><a name="l00026"></a><span class="lineno">   26</span>&#160;<span class="keyword">import</span> java.util.Map;</div><div class="line"><a name="l00027"></a><span class="lineno">   27</span>&#160;<span class="keyword">import</span> java.util.Set;</div><div class="line"><a name="l00028"></a><span class="lineno">   28</span>&#160;</div><div class="line"><a name="l00029"></a><span class="lineno">   29</span>&#160;<span class="keyword">import</span> javax.swing.SwingWorker;</div><div class="line"><a name="l00030"></a><span class="lineno">   30</span>&#160;</div><div class="line"><a name="l00031"></a><span class="lineno">   31</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacedata.html">data</a>.<a class="code" href="classdata_1_1_params.html">Params</a>;</div><div class="line"><a name="l00032"></a><span class="lineno">   32</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacedata.html">data</a>.<a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a>;</div><div class="line"><a name="l00033"></a><span class="lineno">   33</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacedata.html">data</a>.<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>;</div><div class="line"><a name="l00034"></a><span class="lineno">   34</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacedata.html">data</a>.<a class="code" href="classdata_1_1_trial.html">Trial</a>;</div><div class="line"><a name="l00035"></a><span class="lineno">   35</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacefunctions.html">functions</a>.<a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a>;</div><div class="line"><a name="l00036"></a><span class="lineno">   36</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacefunctions.html">functions</a>.<a class="code" href="classfunctions_1_1_paint.html">Paint</a>;</div><div class="line"><a name="l00037"></a><span class="lineno">   37</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacefunctions.html">functions</a>.<a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a>;</div><div class="line"><a name="l00038"></a><span class="lineno">   38</span>&#160;<span class="keyword">import</span> <a class="code" href="namespacefunctions.html">functions</a>.<a class="code" href="classfunctions_1_1_utils.html">Utils</a>;</div><div class="line"><a name="l00039"></a><span class="lineno">   39</span>&#160;<span class="keyword">import</span> ij.IJ;</div><div class="line"><a name="l00040"></a><span class="lineno">   40</span>&#160;<span class="keyword">import</span> ij.gui.GenericDialog;</div><div class="line"><a name="l00041"></a><span class="lineno">   41</span>&#160;<span class="keyword">import</span> ij.measure.ResultsTable;</div><div class="line"><a name="l00042"></a><span class="lineno">   42</span>&#160;</div><div class="line"><a name="l00048"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html">   48</a></span>&#160;<span class="keyword">public</span> <span class="keyword">class </span><a class="code" href="classanalysis_1_1_chemotaxis.html">Chemotaxis</a> <span class="keyword">extends</span> SwingWorker&lt;Boolean, String&gt; {</div><div class="line"><a name="l00049"></a><span class="lineno">   49</span>&#160;</div><div class="line"><a name="l00050"></a><span class="lineno"><a class="line" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">   50</a></span>&#160;  <span class="keyword">private</span> <span class="keyword">enum</span> <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a> {</div><div class="line"><a name="l00051"></a><span class="lineno"><a class="line" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a899caa602e4fff675b17cdbab33607ec">   51</a></span>&#160;    BOOTSTRAPPING, BOOTSTRAPPINGSIMULATIONS, INDEXESDIRECTORY, INDEXESFILE, INDEXESSIMULATIONS, NONE</div><div class="line"><a name="l00052"></a><span class="lineno">   52</span>&#160;  }</div><div class="line"><a name="l00053"></a><span class="lineno">   53</span>&#160;</div><div class="line"><a name="l00054"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ae0c6f15cfb3c589fb7817738e51998bd">   54</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a> <a class="code" href="namespaceanalysis.html">analysis</a> = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a899caa602e4fff675b17cdbab33607ec">NONE</a>;</div><div class="line"><a name="l00055"></a><span class="lineno">   55</span>&#160;</div><div class="line"><a name="l00066"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#aaa89eb018d311df9e98b904088d282a5">   66</a></span>&#160;  <span class="keyword">private</span> ResultsTable <a class="code" href="classanalysis_1_1_chemotaxis.html#aaa89eb018d311df9e98b904088d282a5">analyseCondition</a>(Map&lt;String, Trial&gt; controls, Map&lt;String, Trial&gt; tests) {</div><div class="line"><a name="l00067"></a><span class="lineno">   67</span>&#160;    ResultsTable rt = <span class="keyword">new</span> ResultsTable();</div><div class="line"><a name="l00068"></a><span class="lineno">   68</span>&#160;    <span class="keywordflow">switch</span> (analysis) {</div><div class="line"><a name="l00069"></a><span class="lineno">   69</span>&#160;      <span class="keywordflow">case</span> INDEXESDIRECTORY:</div><div class="line"><a name="l00070"></a><span class="lineno">   70</span>&#160;      <span class="keywordflow">case</span> INDEXESSIMULATIONS:</div><div class="line"><a name="l00071"></a><span class="lineno">   71</span>&#160;        rt = <a class="code" href="classanalysis_1_1_chemotaxis.html#ae0431b7311aa1bb593e062536734de2c">indexesAnalysis</a>(controls, tests);</div><div class="line"><a name="l00072"></a><span class="lineno">   72</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00073"></a><span class="lineno">   73</span>&#160;      <span class="keywordflow">case</span> BOOTSTRAPPING:</div><div class="line"><a name="l00074"></a><span class="lineno">   74</span>&#160;      <span class="keywordflow">case</span> BOOTSTRAPPINGSIMULATIONS:</div><div class="line"><a name="l00075"></a><span class="lineno">   75</span>&#160;        rt = <a class="code" href="classanalysis_1_1_chemotaxis.html#a381aa5dd2dd75a72b6b21f7b2475d888">bootstrappingAnalysis</a>(controls, tests);</div><div class="line"><a name="l00076"></a><span class="lineno">   76</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00077"></a><span class="lineno">   77</span>&#160;      <span class="keywordflow">default</span>:</div><div class="line"><a name="l00078"></a><span class="lineno">   78</span>&#160;    }</div><div class="line"><a name="l00079"></a><span class="lineno">   79</span>&#160;    <span class="keywordflow">return</span> rt;</div><div class="line"><a name="l00080"></a><span class="lineno">   80</span>&#160;  }</div><div class="line"><a name="l00081"></a><span class="lineno">   81</span>&#160;</div><div class="line"><a name="l00088"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ad8447fb7554f7f126822c7a3f3f680ce">   88</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ad8447fb7554f7f126822c7a3f3f680ce">analyseDirectory</a>() {</div><div class="line"><a name="l00089"></a><span class="lineno">   89</span>&#160;    <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a> fm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a>();</div><div class="line"><a name="l00090"></a><span class="lineno">   90</span>&#160;    String folder = fm.<a class="code" href="classfunctions_1_1_file_manager.html#af19fd6734ccb746c4f276c83b6a47689">selectFolder</a>();</div><div class="line"><a name="l00091"></a><span class="lineno">   91</span>&#160;    Map&lt;String, Trial&gt; cTrials = <a class="code" href="classanalysis_1_1_chemotaxis.html#a00ea60f92f2e11a363c01d04b6df7f10">getControlTrials</a>(folder);</div><div class="line"><a name="l00092"></a><span class="lineno">   92</span>&#160;    List&lt;String&gt; testFolders = <a class="code" href="classanalysis_1_1_chemotaxis.html#a973011dfbed998ea23443c2b79ac9ee3">getTestFolders</a>(folder);</div><div class="line"><a name="l00093"></a><span class="lineno">   93</span>&#160;    <span class="keywordflow">if</span>(testFolders.size()==0){</div><div class="line"><a name="l00094"></a><span class="lineno">   94</span>&#160;      IJ.showMessage(<span class="stringliteral">&quot;No \&quot;test\&quot; folders have been found&quot;</span>);</div><div class="line"><a name="l00095"></a><span class="lineno">   95</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00096"></a><span class="lineno">   96</span>&#160;    }</div><div class="line"><a name="l00097"></a><span class="lineno">   97</span>&#160;    <span class="keywordflow">for</span> (String f : testFolders) {</div><div class="line"><a name="l00098"></a><span class="lineno">   98</span>&#160;      List&lt;String&gt; tests = fm.<a class="code" href="classfunctions_1_1_file_manager.html#a3a54a5574abfddd928b2b8675e8affa6">getFiles</a>(f);</div><div class="line"><a name="l00099"></a><span class="lineno">   99</span>&#160;      Map&lt;String, Trial&gt; tTrials = <a class="code" href="classanalysis_1_1_chemotaxis.html#a5580224f7f7e9df7d925ad14f9364d98">getTrials</a>(tests);</div><div class="line"><a name="l00100"></a><span class="lineno">  100</span>&#160;      ResultsTable rt = <a class="code" href="classanalysis_1_1_chemotaxis.html#aaa89eb018d311df9e98b904088d282a5">analyseCondition</a>(cTrials, tTrials);</div><div class="line"><a name="l00101"></a><span class="lineno">  101</span>&#160;      String condition = fm.<a class="code" href="classfunctions_1_1_file_manager.html#ad027758f34214960a7aa800e0f7c19db">getFilename</a>(f);</div><div class="line"><a name="l00102"></a><span class="lineno">  102</span>&#160;      <span class="keywordflow">if</span>(rt!=null)</div><div class="line"><a name="l00103"></a><span class="lineno">  103</span>&#160;        rt.show(condition);</div><div class="line"><a name="l00104"></a><span class="lineno">  104</span>&#160;    }</div><div class="line"><a name="l00105"></a><span class="lineno">  105</span>&#160;  }</div><div class="line"><a name="l00106"></a><span class="lineno">  106</span>&#160;</div><div class="line"><a name="l00111"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a0b1464e818c4300782cb7e3322448f95">  111</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a0b1464e818c4300782cb7e3322448f95">analyseFile</a>() {</div><div class="line"><a name="l00112"></a><span class="lineno">  112</span>&#160;    <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a> fm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a>();</div><div class="line"><a name="l00113"></a><span class="lineno">  113</span>&#160;    String file = fm.<a class="code" href="classfunctions_1_1_file_manager.html#aa741a9e7ac4127ae1a463fb626474edf">selectFile</a>();</div><div class="line"><a name="l00114"></a><span class="lineno">  114</span>&#160;    <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a> tm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a>();</div><div class="line"><a name="l00115"></a><span class="lineno">  115</span>&#160;    <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = tm.<a class="code" href="classfunctions_1_1_trial_manager.html#a5d815ce30de28983d08c22c909562e11">getTrialFromAVI</a>(file);</div><div class="line"><a name="l00116"></a><span class="lineno">  116</span>&#160;    <a class="code" href="classanalysis_1_1_chemotaxis.html#ab864eab3ca8e5147e34d6a4747d24e72">drawResults</a>(trial);</div><div class="line"><a name="l00117"></a><span class="lineno">  117</span>&#160;    <span class="keywordflow">if</span>(<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#ae8b85275ab9c5375a3d35dcb7cd8332f">printXY</a>){</div><div class="line"><a name="l00118"></a><span class="lineno">  118</span>&#160;      <a class="code" href="classfunctions_1_1_utils.html">Utils</a> utils = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_utils.html">Utils</a>();</div><div class="line"><a name="l00119"></a><span class="lineno">  119</span>&#160;      IJ.saveString(utils.<a class="code" href="classfunctions_1_1_utils.html#ab85218da3569b5a7c0b9749e7b2b747a">printXYCoords</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>),<span class="stringliteral">&quot;&quot;</span>);</div><div class="line"><a name="l00120"></a><span class="lineno">  120</span>&#160;    }</div><div class="line"><a name="l00121"></a><span class="lineno">  121</span>&#160;  }</div><div class="line"><a name="l00122"></a><span class="lineno">  122</span>&#160;</div><div class="line"><a name="l00128"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ad992aa584aa410ee10b0b5df660c43ec">  128</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ad992aa584aa410ee10b0b5df660c43ec">analyseSimulations</a>() {</div><div class="line"><a name="l00129"></a><span class="lineno">  129</span>&#160;    GenericDialog gd = <span class="keyword">new</span> GenericDialog(<span class="stringliteral">&quot;Set Simulation parameters&quot;</span>);</div><div class="line"><a name="l00130"></a><span class="lineno">  130</span>&#160;    gd.addNumericField(<span class="stringliteral">&quot;Beta&quot;</span>, 0, 2);</div><div class="line"><a name="l00131"></a><span class="lineno">  131</span>&#160;    gd.addNumericField(<span class="stringliteral">&quot;Responsiveness (%)&quot;</span>, 50, 2);</div><div class="line"><a name="l00132"></a><span class="lineno">  132</span>&#160;    gd.addNumericField(<span class="stringliteral">&quot;Number of simulations&quot;</span>, 50, 0);</div><div class="line"><a name="l00133"></a><span class="lineno">  133</span>&#160;    gd.showDialog();</div><div class="line"><a name="l00134"></a><span class="lineno">  134</span>&#160;    <span class="keywordflow">if</span> (gd.wasCanceled())</div><div class="line"><a name="l00135"></a><span class="lineno">  135</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00136"></a><span class="lineno">  136</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">double</span> BETA = gd.getNextNumber();</div><div class="line"><a name="l00137"></a><span class="lineno">  137</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">double</span> RESPONSIVENESS = gd.getNextNumber() / 100;<span class="comment">// value must be</span></div><div class="line"><a name="l00138"></a><span class="lineno">  138</span>&#160;                                                           <span class="comment">// between [0,1]</span></div><div class="line"><a name="l00139"></a><span class="lineno">  139</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> TOTALSIMULATIONS = (int) gd.getNextNumber();</div><div class="line"><a name="l00140"></a><span class="lineno">  140</span>&#160;    <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a> tm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a>();</div><div class="line"><a name="l00141"></a><span class="lineno">  141</span>&#160;    Map&lt;String, Trial&gt; controls = tm.<a class="code" href="classfunctions_1_1_trial_manager.html#a83f9d10eaa1ef4efb6de1f0e8b690978">simulateTrials</a>(0, 0, TOTALSIMULATIONS);</div><div class="line"><a name="l00142"></a><span class="lineno">  142</span>&#160;    Map&lt;String, Trial&gt; tests = tm.<a class="code" href="classfunctions_1_1_trial_manager.html#a83f9d10eaa1ef4efb6de1f0e8b690978">simulateTrials</a>(BETA, RESPONSIVENESS, TOTALSIMULATIONS);</div><div class="line"><a name="l00143"></a><span class="lineno">  143</span>&#160;    ResultsTable rt = <a class="code" href="classanalysis_1_1_chemotaxis.html#aaa89eb018d311df9e98b904088d282a5">analyseCondition</a>(controls, tests);</div><div class="line"><a name="l00144"></a><span class="lineno">  144</span>&#160;    rt.show(<span class="stringliteral">&quot;Results from Simulation (Beta: &quot;</span> + BETA + <span class="stringliteral">&quot;,Responsiveness: &quot;</span> + RESPONSIVENESS + <span class="stringliteral">&quot;)&quot;</span>);</div><div class="line"><a name="l00145"></a><span class="lineno">  145</span>&#160;  }</div><div class="line"><a name="l00146"></a><span class="lineno">  146</span>&#160;</div><div class="line"><a name="l00156"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a381aa5dd2dd75a72b6b21f7b2475d888">  156</a></span>&#160;  <span class="keyword">private</span> ResultsTable <a class="code" href="classanalysis_1_1_chemotaxis.html#a381aa5dd2dd75a72b6b21f7b2475d888">bootstrappingAnalysis</a>(Map&lt;String, Trial&gt; controls, Map&lt;String, Trial&gt; tests) {</div><div class="line"><a name="l00157"></a><span class="lineno">  157</span>&#160;</div><div class="line"><a name="l00158"></a><span class="lineno">  158</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> cMin = <a class="code" href="classanalysis_1_1_chemotaxis.html#a3ae63569c841ffc6aa09be276f526c03">minSampleSize</a>(controls);</div><div class="line"><a name="l00159"></a><span class="lineno">  159</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> tMin = <a class="code" href="classanalysis_1_1_chemotaxis.html#a3ae63569c841ffc6aa09be276f526c03">minSampleSize</a>(tests);</div><div class="line"><a name="l00160"></a><span class="lineno">  160</span>&#160;    <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a11078ae453283411c72774c45caa7519">MAXINSTANGLES</a> = Math.min(cMin, tMin);</div><div class="line"><a name="l00161"></a><span class="lineno">  161</span>&#160;    ResultsTable rt = <span class="keyword">new</span> ResultsTable();</div><div class="line"><a name="l00162"></a><span class="lineno">  162</span>&#160;    <span class="keywordflow">if</span>(!<a class="code" href="classanalysis_1_1_chemotaxis.html#a1ebc6d4aaad3ec1c0eca87acb729ffb5">checkPairs</a>(controls,tests)){</div><div class="line"><a name="l00163"></a><span class="lineno">  163</span>&#160;       String condition = ((<a class="code" href="classdata_1_1_trial.html">Trial</a>) tests.values().toArray()[0]).type;</div><div class="line"><a name="l00164"></a><span class="lineno">  164</span>&#160;       IJ.showMessage(<span class="stringliteral">&quot;No pairs (control-&quot;</span>+condition+<span class="stringliteral">&quot;) with the same ID have been found&quot;</span>);</div><div class="line"><a name="l00165"></a><span class="lineno">  165</span>&#160;       <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00166"></a><span class="lineno">  166</span>&#160;    }</div><div class="line"><a name="l00167"></a><span class="lineno">  167</span>&#160;    <span class="comment">// Calculating OR threshold via resampling</span></div><div class="line"><a name="l00168"></a><span class="lineno">  168</span>&#160;    <span class="keywordtype">double</span> thControl = <a class="code" href="classanalysis_1_1_chemotaxis.html#a8ee54f019a9258760e20482e3cd6b851">orThreshold</a>(controls);</div><div class="line"><a name="l00169"></a><span class="lineno">  169</span>&#160;    <span class="keywordflow">for</span> (String cKey : controls.keySet()) {</div><div class="line"><a name="l00170"></a><span class="lineno">  170</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> cTrial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) controls.get(cKey);</div><div class="line"><a name="l00171"></a><span class="lineno">  171</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> tTrial = <a class="code" href="classanalysis_1_1_chemotaxis.html#a40fa55bdb0e1b4e7e0f9de92076ab2f9">findTrial</a>(cTrial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>, tests);</div><div class="line"><a name="l00172"></a><span class="lineno">  172</span>&#160;      <span class="keywordflow">if</span> (tTrial != null) {</div><div class="line"><a name="l00173"></a><span class="lineno">  173</span>&#160;        <span class="keywordtype">double</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">or</a> = <a class="code" href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">or</a>(cTrial, tTrial);</div><div class="line"><a name="l00174"></a><span class="lineno">  174</span>&#160;        <a class="code" href="classanalysis_1_1_chemotaxis.html#ac5db76309b6da4b0f351cdbb5876fec4">setBootstrappingResults</a>(rt, or, thControl, tTrial);</div><div class="line"><a name="l00175"></a><span class="lineno">  175</span>&#160;      }</div><div class="line"><a name="l00176"></a><span class="lineno">  176</span>&#160;    }</div><div class="line"><a name="l00177"></a><span class="lineno">  177</span>&#160;    <span class="keywordflow">return</span> rt;</div><div class="line"><a name="l00178"></a><span class="lineno">  178</span>&#160;  }</div><div class="line"><a name="l00179"></a><span class="lineno">  179</span>&#160;  <span class="comment">/******************************************************/</span></div><div class="line"><a name="l00187"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">  187</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">float</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">calculateChIndex</a>(List&lt;List&lt;Spermatozoon&gt;&gt; theTracks) {</div><div class="line"><a name="l00188"></a><span class="lineno">  188</span>&#160;    <span class="keywordtype">int</span> trackNr = 0; <span class="comment">// Number of tracks</span></div><div class="line"><a name="l00189"></a><span class="lineno">  189</span>&#160;    <span class="keywordtype">int</span> nTracks = theTracks.size();</div><div class="line"><a name="l00190"></a><span class="lineno">  190</span>&#160;    <span class="keywordtype">int</span>[] displacements = { 0, 0 };</div><div class="line"><a name="l00191"></a><span class="lineno">  191</span>&#160;    <span class="keywordflow">for</span> (List&lt;Spermatozoon&gt; track : theTracks) {</div><div class="line"><a name="l00192"></a><span class="lineno">  192</span>&#160;      IJ.showProgress((<span class="keywordtype">double</span>) trackNr / nTracks);</div><div class="line"><a name="l00193"></a><span class="lineno">  193</span>&#160;      IJ.showStatus(<span class="stringliteral">&quot;Calculating Ch-Index...&quot;</span>);</div><div class="line"><a name="l00194"></a><span class="lineno">  194</span>&#160;      trackNr++;</div><div class="line"><a name="l00195"></a><span class="lineno">  195</span>&#160;      <span class="keywordtype">int</span>[] instD = <a class="code" href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">countInstantDisplacements</a>(track);</div><div class="line"><a name="l00196"></a><span class="lineno">  196</span>&#160;      displacements[0] += instD[0];</div><div class="line"><a name="l00197"></a><span class="lineno">  197</span>&#160;      displacements[1] += instD[1];</div><div class="line"><a name="l00198"></a><span class="lineno">  198</span>&#160;    }</div><div class="line"><a name="l00199"></a><span class="lineno">  199</span>&#160;    <span class="keywordtype">float</span> nUpGradient = displacements[0]; <span class="comment">// Number of displacements in the</span></div><div class="line"><a name="l00200"></a><span class="lineno">  200</span>&#160;                                          <span class="comment">// gradient direction</span></div><div class="line"><a name="l00201"></a><span class="lineno">  201</span>&#160;    <span class="keywordtype">float</span> nOtherDirs = displacements[1]; <span class="comment">// Number of displacements in other</span></div><div class="line"><a name="l00202"></a><span class="lineno">  202</span>&#160;                                         <span class="comment">// direction</span></div><div class="line"><a name="l00203"></a><span class="lineno">  203</span>&#160;    <span class="comment">// IJ.log(&quot;nUpGradient: &quot;+nUpGradient+&quot;; nOtherDirs: &quot;+nOtherDirs);</span></div><div class="line"><a name="l00204"></a><span class="lineno">  204</span>&#160;    <span class="keywordtype">float</span> chIdx = 0;</div><div class="line"><a name="l00205"></a><span class="lineno">  205</span>&#160;    <span class="keywordflow">if</span> ((nUpGradient + nOtherDirs) &gt; 0) {</div><div class="line"><a name="l00206"></a><span class="lineno">  206</span>&#160;      chIdx = nUpGradient / (nUpGradient + nOtherDirs); <span class="comment">// (nUpGradient+nOtherDirs)</span></div><div class="line"><a name="l00207"></a><span class="lineno">  207</span>&#160;                                                        <span class="comment">// = Total number of</span></div><div class="line"><a name="l00208"></a><span class="lineno">  208</span>&#160;                                                        <span class="comment">// shifts</span></div><div class="line"><a name="l00209"></a><span class="lineno">  209</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00210"></a><span class="lineno">  210</span>&#160;      chIdx = -1;</div><div class="line"><a name="l00211"></a><span class="lineno">  211</span>&#160;    }</div><div class="line"><a name="l00212"></a><span class="lineno">  212</span>&#160;    <span class="keywordflow">return</span> chIdx; <span class="comment">// return index between [0,1]</span></div><div class="line"><a name="l00213"></a><span class="lineno">  213</span>&#160;  }</div><div class="line"><a name="l00214"></a><span class="lineno">  214</span>&#160;</div><div class="line"><a name="l00215"></a><span class="lineno">  215</span>&#160;  <span class="comment">/******************************************************/</span></div><div class="line"><a name="l00223"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">  223</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">float</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">calculateSLIndex</a>(List&lt;List&lt;Spermatozoon&gt;&gt; theTracks) {</div><div class="line"><a name="l00224"></a><span class="lineno">  224</span>&#160;</div><div class="line"><a name="l00225"></a><span class="lineno">  225</span>&#160;    <span class="keywordtype">float</span> nUpGradient = 0; <span class="comment">// Number of shifts in the chemoattractant direction</span></div><div class="line"><a name="l00226"></a><span class="lineno">  226</span>&#160;    <span class="keywordtype">float</span> nOtherDirs = 0; <span class="comment">// Number of shifts in other direction</span></div><div class="line"><a name="l00227"></a><span class="lineno">  227</span>&#160;    <span class="keywordtype">int</span> trackNr = 0;</div><div class="line"><a name="l00228"></a><span class="lineno">  228</span>&#160;    <span class="keywordtype">int</span> nTracks = theTracks.size();</div><div class="line"><a name="l00229"></a><span class="lineno">  229</span>&#160;    <span class="keywordtype">double</span> angleChemotaxis = (2 * Math.PI + (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a42568ad774d8f4ccb9535aeda39fc883">angleAmplitude</a> / 2) * Math.PI / 180) % (2 * Math.PI);</div><div class="line"><a name="l00230"></a><span class="lineno">  230</span>&#160;    <span class="keywordtype">float</span> ratioSL = 0;</div><div class="line"><a name="l00231"></a><span class="lineno">  231</span>&#160;    <span class="keywordflow">for</span> (List&lt;Spermatozoon&gt; aTrack : theTracks) {</div><div class="line"><a name="l00232"></a><span class="lineno">  232</span>&#160;      IJ.showProgress((<span class="keywordtype">double</span>) trackNr / nTracks);</div><div class="line"><a name="l00233"></a><span class="lineno">  233</span>&#160;      IJ.showStatus(<span class="stringliteral">&quot;Calculating SL-Index...&quot;</span>);</div><div class="line"><a name="l00234"></a><span class="lineno">  234</span>&#160;      trackNr++;</div><div class="line"><a name="l00235"></a><span class="lineno">  235</span>&#160;      <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> first = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) aTrack.get(1);</div><div class="line"><a name="l00236"></a><span class="lineno">  236</span>&#160;      <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> last = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) aTrack.get(aTrack.size() - 1);</div><div class="line"><a name="l00237"></a><span class="lineno">  237</span>&#160;      <span class="keywordtype">double</span> angle = <a class="code" href="classanalysis_1_1_chemotaxis.html#ab23f946e0f1055d348e975e3058f323d">relativeAngle</a>(first, last); <span class="comment">// Between [-PI,PI]</span></div><div class="line"><a name="l00238"></a><span class="lineno">  238</span>&#160;      <span class="comment">// Check if the angle is upGradient or not</span></div><div class="line"><a name="l00239"></a><span class="lineno">  239</span>&#160;      <span class="keywordflow">if</span> (Math.abs(angle) &lt; angleChemotaxis) {</div><div class="line"><a name="l00240"></a><span class="lineno">  240</span>&#160;        nUpGradient++;</div><div class="line"><a name="l00241"></a><span class="lineno">  241</span>&#160;      } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00242"></a><span class="lineno">  242</span>&#160;        nOtherDirs++;</div><div class="line"><a name="l00243"></a><span class="lineno">  243</span>&#160;      }</div><div class="line"><a name="l00244"></a><span class="lineno">  244</span>&#160;    }</div><div class="line"><a name="l00245"></a><span class="lineno">  245</span>&#160;    <span class="keywordflow">if</span> ((nUpGradient + nOtherDirs) &gt; 0) {</div><div class="line"><a name="l00246"></a><span class="lineno">  246</span>&#160;      ratioSL = nUpGradient / (nUpGradient + nOtherDirs);</div><div class="line"><a name="l00247"></a><span class="lineno">  247</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00248"></a><span class="lineno">  248</span>&#160;      ratioSL = -1;</div><div class="line"><a name="l00249"></a><span class="lineno">  249</span>&#160;    }</div><div class="line"><a name="l00250"></a><span class="lineno">  250</span>&#160;    <span class="keywordflow">return</span> ratioSL;</div><div class="line"><a name="l00251"></a><span class="lineno">  251</span>&#160;  }</div><div class="line"><a name="l00252"></a><span class="lineno">  252</span>&#160;</div><div class="line"><a name="l00259"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a1ebc6d4aaad3ec1c0eca87acb729ffb5">  259</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">boolean</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a1ebc6d4aaad3ec1c0eca87acb729ffb5">checkPairs</a>(Map&lt;String, Trial&gt; controls, Map&lt;String, Trial&gt; tests){</div><div class="line"><a name="l00260"></a><span class="lineno">  260</span>&#160;    <span class="keywordtype">boolean</span> ok = <span class="keyword">false</span>;</div><div class="line"><a name="l00261"></a><span class="lineno">  261</span>&#160;    <span class="keywordflow">for</span> (String cKey : controls.keySet()) {</div><div class="line"><a name="l00262"></a><span class="lineno">  262</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> cTrial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) controls.get(cKey);</div><div class="line"><a name="l00263"></a><span class="lineno">  263</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> tTrial = <a class="code" href="classanalysis_1_1_chemotaxis.html#a40fa55bdb0e1b4e7e0f9de92076ab2f9">findTrial</a>(cTrial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>, tests);</div><div class="line"><a name="l00264"></a><span class="lineno">  264</span>&#160;      <span class="keywordflow">if</span> (tTrial != null) {</div><div class="line"><a name="l00265"></a><span class="lineno">  265</span>&#160;        ok=<span class="keyword">true</span>;</div><div class="line"><a name="l00266"></a><span class="lineno">  266</span>&#160;        <span class="keywordflow">return</span> ok;</div><div class="line"><a name="l00267"></a><span class="lineno">  267</span>&#160;      }</div><div class="line"><a name="l00268"></a><span class="lineno">  268</span>&#160;    }</div><div class="line"><a name="l00269"></a><span class="lineno">  269</span>&#160;    <span class="keywordflow">return</span> ok;</div><div class="line"><a name="l00270"></a><span class="lineno">  270</span>&#160;  }</div><div class="line"><a name="l00271"></a><span class="lineno">  271</span>&#160;</div><div class="line"><a name="l00281"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a50fdf81a3460741674381622f16581cb">  281</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span>[] <a class="code" href="classanalysis_1_1_chemotaxis.html#a50fdf81a3460741674381622f16581cb">circularHistogram</a>(List&lt;Double&gt; angles, <span class="keywordtype">int</span> n) {</div><div class="line"><a name="l00282"></a><span class="lineno">  282</span>&#160;</div><div class="line"><a name="l00283"></a><span class="lineno">  283</span>&#160;    <span class="keywordtype">int</span>[] histogram = <span class="keyword">new</span> <span class="keywordtype">int</span>[n];</div><div class="line"><a name="l00284"></a><span class="lineno">  284</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; n; i++) {</div><div class="line"><a name="l00285"></a><span class="lineno">  285</span>&#160;      histogram[i] = 0;</div><div class="line"><a name="l00286"></a><span class="lineno">  286</span>&#160;    }</div><div class="line"><a name="l00287"></a><span class="lineno">  287</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> BINSIZE = 360 / n;</div><div class="line"><a name="l00288"></a><span class="lineno">  288</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; angles.size(); i++) {</div><div class="line"><a name="l00289"></a><span class="lineno">  289</span>&#160;      <span class="keywordtype">int</span> bin = angles.get(i).intValue() / BINSIZE;</div><div class="line"><a name="l00290"></a><span class="lineno">  290</span>&#160;      histogram[bin]++;</div><div class="line"><a name="l00291"></a><span class="lineno">  291</span>&#160;    }</div><div class="line"><a name="l00292"></a><span class="lineno">  292</span>&#160;    <span class="keywordflow">return</span> histogram;</div><div class="line"><a name="l00293"></a><span class="lineno">  293</span>&#160;  }</div><div class="line"><a name="l00294"></a><span class="lineno">  294</span>&#160;</div><div class="line"><a name="l00306"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a55deae924cf7ec2004a8fdcd8e185f94">  306</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span>[] <a class="code" href="classanalysis_1_1_chemotaxis.html#a55deae924cf7ec2004a8fdcd8e185f94">countAngles</a>(<a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> theTracks) {</div><div class="line"><a name="l00307"></a><span class="lineno">  307</span>&#160;    <span class="keywordtype">int</span>[] angles = { 0, 0 };</div><div class="line"><a name="l00308"></a><span class="lineno">  308</span>&#160;    <span class="keywordflow">for</span> (ListIterator iT = theTracks.listIterator(); iT.hasNext();) {</div><div class="line"><a name="l00309"></a><span class="lineno">  309</span>&#160;      List aTrack = (ArrayList) iT.next();</div><div class="line"><a name="l00310"></a><span class="lineno">  310</span>&#160;      <span class="keywordtype">int</span>[] instantAngles = <a class="code" href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">countInstantDisplacements</a>(aTrack);</div><div class="line"><a name="l00311"></a><span class="lineno">  311</span>&#160;      angles[0] += instantAngles[0];</div><div class="line"><a name="l00312"></a><span class="lineno">  312</span>&#160;      angles[1] += instantAngles[1];</div><div class="line"><a name="l00313"></a><span class="lineno">  313</span>&#160;    }</div><div class="line"><a name="l00314"></a><span class="lineno">  314</span>&#160;    <span class="keywordflow">return</span> angles;</div><div class="line"><a name="l00315"></a><span class="lineno">  315</span>&#160;  }</div><div class="line"><a name="l00316"></a><span class="lineno">  316</span>&#160;</div><div class="line"><a name="l00328"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">  328</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span>[] <a class="code" href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">countInstantDisplacements</a>(List&lt;Spermatozoon&gt; track) {</div><div class="line"><a name="l00329"></a><span class="lineno">  329</span>&#160;    <span class="keywordtype">int</span> nUpGradient = 0;</div><div class="line"><a name="l00330"></a><span class="lineno">  330</span>&#160;    <span class="keywordtype">int</span> nOtherDir = 0;</div><div class="line"><a name="l00331"></a><span class="lineno">  331</span>&#160;    <span class="keywordtype">int</span> nPoints = track.size();</div><div class="line"><a name="l00332"></a><span class="lineno">  332</span>&#160;    <span class="keywordtype">double</span> angleChemotaxis = (2 * Math.PI + (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a42568ad774d8f4ccb9535aeda39fc883">angleAmplitude</a> / 2) * Math.PI / 180) % (2 * Math.PI);</div><div class="line"><a name="l00333"></a><span class="lineno">  333</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; (nPoints - <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a93caa48162e34b2227a839ed71b4ed44">angleDelta</a>); j++) {</div><div class="line"><a name="l00334"></a><span class="lineno">  334</span>&#160;      <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> oldSpermatozoon = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) track.get(j);</div><div class="line"><a name="l00335"></a><span class="lineno">  335</span>&#160;      <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> newSpermatozoon = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) track.get(j + <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a93caa48162e34b2227a839ed71b4ed44">angleDelta</a>);</div><div class="line"><a name="l00336"></a><span class="lineno">  336</span>&#160;      <span class="keywordtype">double</span> angle = <a class="code" href="classanalysis_1_1_chemotaxis.html#ab23f946e0f1055d348e975e3058f323d">relativeAngle</a>(oldSpermatozoon, newSpermatozoon);<span class="comment">// Between interval [-PI,PI]</span></div><div class="line"><a name="l00337"></a><span class="lineno">  337</span>&#160;      <span class="keywordflow">if</span> (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a8c0dba3f8308ea1257549b3cef11ea23">compareOppositeDirections</a>) {<span class="comment">// We only take into account angles in the gradient and opposite direction</span></div><div class="line"><a name="l00338"></a><span class="lineno">  338</span>&#160;        <span class="keywordflow">if</span> (Math.abs(angle) &lt; angleChemotaxis) {</div><div class="line"><a name="l00339"></a><span class="lineno">  339</span>&#160;          nUpGradient++;</div><div class="line"><a name="l00340"></a><span class="lineno">  340</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (Math.abs(angle) &gt; (Math.PI - angleChemotaxis)) {</div><div class="line"><a name="l00341"></a><span class="lineno">  341</span>&#160;          nOtherDir++;</div><div class="line"><a name="l00342"></a><span class="lineno">  342</span>&#160;        }</div><div class="line"><a name="l00343"></a><span class="lineno">  343</span>&#160;      } <span class="keywordflow">else</span> {<span class="comment">// We take into account all angles in all directions</span></div><div class="line"><a name="l00344"></a><span class="lineno">  344</span>&#160;        <span class="keywordflow">if</span> (Math.abs(angle) &lt; angleChemotaxis) {</div><div class="line"><a name="l00345"></a><span class="lineno">  345</span>&#160;          nUpGradient++;</div><div class="line"><a name="l00346"></a><span class="lineno">  346</span>&#160;        } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00347"></a><span class="lineno">  347</span>&#160;          nOtherDir++;</div><div class="line"><a name="l00348"></a><span class="lineno">  348</span>&#160;        }</div><div class="line"><a name="l00349"></a><span class="lineno">  349</span>&#160;      }</div><div class="line"><a name="l00350"></a><span class="lineno">  350</span>&#160;    }</div><div class="line"><a name="l00351"></a><span class="lineno">  351</span>&#160;    <span class="keywordtype">int</span>[] results = <span class="keyword">new</span> <span class="keywordtype">int</span>[2];</div><div class="line"><a name="l00352"></a><span class="lineno">  352</span>&#160;    results[0] = nUpGradient;</div><div class="line"><a name="l00353"></a><span class="lineno">  353</span>&#160;    results[1] = nOtherDir;</div><div class="line"><a name="l00354"></a><span class="lineno">  354</span>&#160;    <span class="keywordflow">return</span> results;</div><div class="line"><a name="l00355"></a><span class="lineno">  355</span>&#160;  }</div><div class="line"><a name="l00356"></a><span class="lineno">  356</span>&#160;</div><div class="line"><a name="l00361"></a><span class="lineno">  361</span>&#160;  @Override</div><div class="line"><a name="l00362"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ab048bf7b5ce8c46bb48b99b8d0999110">  362</a></span>&#160;  <span class="keyword">public</span> Boolean <a class="code" href="classanalysis_1_1_chemotaxis.html#ab048bf7b5ce8c46bb48b99b8d0999110">doInBackground</a>() {</div><div class="line"><a name="l00363"></a><span class="lineno">  363</span>&#160;</div><div class="line"><a name="l00364"></a><span class="lineno">  364</span>&#160;    <span class="keywordflow">switch</span> (analysis) {</div><div class="line"><a name="l00365"></a><span class="lineno">  365</span>&#160;      <span class="keywordflow">case</span> INDEXESFILE:</div><div class="line"><a name="l00366"></a><span class="lineno">  366</span>&#160;        <a class="code" href="classanalysis_1_1_chemotaxis.html#a0b1464e818c4300782cb7e3322448f95">analyseFile</a>();</div><div class="line"><a name="l00367"></a><span class="lineno">  367</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00368"></a><span class="lineno">  368</span>&#160;      <span class="keywordflow">case</span> INDEXESDIRECTORY:</div><div class="line"><a name="l00369"></a><span class="lineno">  369</span>&#160;      <span class="keywordflow">case</span> BOOTSTRAPPING:</div><div class="line"><a name="l00370"></a><span class="lineno">  370</span>&#160;        <a class="code" href="classanalysis_1_1_chemotaxis.html#ad8447fb7554f7f126822c7a3f3f680ce">analyseDirectory</a>();</div><div class="line"><a name="l00371"></a><span class="lineno">  371</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00372"></a><span class="lineno">  372</span>&#160;      <span class="keywordflow">case</span> INDEXESSIMULATIONS:</div><div class="line"><a name="l00373"></a><span class="lineno">  373</span>&#160;      <span class="keywordflow">case</span> BOOTSTRAPPINGSIMULATIONS:</div><div class="line"><a name="l00374"></a><span class="lineno">  374</span>&#160;        <a class="code" href="classanalysis_1_1_chemotaxis.html#ad992aa584aa410ee10b0b5df660c43ec">analyseSimulations</a>();</div><div class="line"><a name="l00375"></a><span class="lineno">  375</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00376"></a><span class="lineno">  376</span>&#160;    }</div><div class="line"><a name="l00377"></a><span class="lineno">  377</span>&#160;</div><div class="line"><a name="l00378"></a><span class="lineno">  378</span>&#160;    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00379"></a><span class="lineno">  379</span>&#160;  }</div><div class="line"><a name="l00380"></a><span class="lineno">  380</span>&#160;</div><div class="line"><a name="l00385"></a><span class="lineno">  385</span>&#160;  @Override</div><div class="line"><a name="l00386"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ab650651e4cda2869f73100c6fd2c821a">  386</a></span>&#160;  <span class="keyword">protected</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ab650651e4cda2869f73100c6fd2c821a">done</a>() {</div><div class="line"><a name="l00387"></a><span class="lineno">  387</span>&#160;    <span class="comment">// switch (analysis) {</span></div><div class="line"><a name="l00388"></a><span class="lineno">  388</span>&#160;    <span class="comment">// case INDEXESFILE:</span></div><div class="line"><a name="l00389"></a><span class="lineno">  389</span>&#160;    <span class="comment">// break;</span></div><div class="line"><a name="l00390"></a><span class="lineno">  390</span>&#160;    <span class="comment">// case INDEXESDIRECTORY:</span></div><div class="line"><a name="l00391"></a><span class="lineno">  391</span>&#160;    <span class="comment">// break;</span></div><div class="line"><a name="l00392"></a><span class="lineno">  392</span>&#160;    <span class="comment">// case BOOTSTRAPPING:</span></div><div class="line"><a name="l00393"></a><span class="lineno">  393</span>&#160;    <span class="comment">// break;</span></div><div class="line"><a name="l00394"></a><span class="lineno">  394</span>&#160;    <span class="comment">// case INDEXESSIMULATIONS:</span></div><div class="line"><a name="l00395"></a><span class="lineno">  395</span>&#160;    <span class="comment">// break;</span></div><div class="line"><a name="l00396"></a><span class="lineno">  396</span>&#160;    <span class="comment">// case BOOTSTRAPPINGSIMULATIONS:</span></div><div class="line"><a name="l00397"></a><span class="lineno">  397</span>&#160;    <span class="comment">// break;</span></div><div class="line"><a name="l00398"></a><span class="lineno">  398</span>&#160;    <span class="comment">// }</span></div><div class="line"><a name="l00399"></a><span class="lineno">  399</span>&#160;  }</div><div class="line"><a name="l00400"></a><span class="lineno">  400</span>&#160;</div><div class="line"><a name="l00407"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ab864eab3ca8e5147e34d6a4747d24e72">  407</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ab864eab3ca8e5147e34d6a4747d24e72">drawResults</a>(<a class="code" href="classdata_1_1_trial.html">Trial</a> trial) {</div><div class="line"><a name="l00408"></a><span class="lineno">  408</span>&#160;    <span class="keywordflow">if</span> (trial == null)</div><div class="line"><a name="l00409"></a><span class="lineno">  409</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00410"></a><span class="lineno">  410</span>&#160;    <span class="keywordtype">float</span> chIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">calculateChIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00411"></a><span class="lineno">  411</span>&#160;    <span class="keywordtype">float</span> slIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">calculateSLIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00412"></a><span class="lineno">  412</span>&#160;    <span class="keywordtype">int</span>[] hist = <a class="code" href="classanalysis_1_1_chemotaxis.html#a50fdf81a3460741674381622f16581cb">circularHistogram</a>(<a class="code" href="classanalysis_1_1_chemotaxis.html#a0a5886ad5b1d3a1dee18ed4fe5da7ed8">getListOfAngles</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>), 45);</div><div class="line"><a name="l00413"></a><span class="lineno">  413</span>&#160;    <span class="keywordtype">int</span> radius = trial.<a class="code" href="classdata_1_1_trial.html#abce721f4aa25ad8ba8181de990a78b73">fieldWidth</a>;</div><div class="line"><a name="l00414"></a><span class="lineno">  414</span>&#160;    <a class="code" href="classfunctions_1_1_paint.html">Paint</a> paint = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_paint.html">Paint</a>();</div><div class="line"><a name="l00415"></a><span class="lineno">  415</span>&#160;    paint.<a class="code" href="classfunctions_1_1_paint.html#a21dbba9326aa66f10d1dfccb836c14d9">drawChemotaxis</a>(trial, chIdx, slIdx);</div><div class="line"><a name="l00416"></a><span class="lineno">  416</span>&#160;    paint.<a class="code" href="classfunctions_1_1_paint.html#ae6e7f899e277190943b0c57232976e97">drawRoseDiagram</a>(hist, radius, chIdx, trial.<a class="code" href="classdata_1_1_trial.html#a00baeba9d13a88ce01098a02d1e570d5">source</a>);</div><div class="line"><a name="l00417"></a><span class="lineno">  417</span>&#160;  }</div><div class="line"><a name="l00418"></a><span class="lineno">  418</span>&#160;</div><div class="line"><a name="l00429"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a40fa55bdb0e1b4e7e0f9de92076ab2f9">  429</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classdata_1_1_trial.html">Trial</a> <a class="code" href="classanalysis_1_1_chemotaxis.html#a40fa55bdb0e1b4e7e0f9de92076ab2f9">findTrial</a>(String <span class="keywordtype">id</span>, Map&lt;String, Trial&gt; trials) {</div><div class="line"><a name="l00430"></a><span class="lineno">  430</span>&#160;    <span class="keywordflow">for</span> (String k : trials.keySet()) {</div><div class="line"><a name="l00431"></a><span class="lineno">  431</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) trials.get(k);</div><div class="line"><a name="l00432"></a><span class="lineno">  432</span>&#160;      <span class="keywordflow">if</span> (trial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>.equalsIgnoreCase(<span class="keywordtype">id</span>))</div><div class="line"><a name="l00433"></a><span class="lineno">  433</span>&#160;        <span class="keywordflow">return</span> trial;</div><div class="line"><a name="l00434"></a><span class="lineno">  434</span>&#160;    }</div><div class="line"><a name="l00435"></a><span class="lineno">  435</span>&#160;    <span class="keywordflow">return</span> null;</div><div class="line"><a name="l00436"></a><span class="lineno">  436</span>&#160;  }</div><div class="line"><a name="l00437"></a><span class="lineno">  437</span>&#160;</div><div class="line"><a name="l00438"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a00ea60f92f2e11a363c01d04b6df7f10">  438</a></span>&#160;  <span class="keyword">private</span> Map&lt;String, Trial&gt; <a class="code" href="classanalysis_1_1_chemotaxis.html#a00ea60f92f2e11a363c01d04b6df7f10">getControlTrials</a>(String folder) {</div><div class="line"><a name="l00439"></a><span class="lineno">  439</span>&#160;    <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a> fm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a>();</div><div class="line"><a name="l00440"></a><span class="lineno">  440</span>&#160;    List&lt;String&gt; subFolders = fm.<a class="code" href="classfunctions_1_1_file_manager.html#a73efd872c86ccdce535ddb2798aaaea4">getSubfolders</a>(folder);</div><div class="line"><a name="l00441"></a><span class="lineno">  441</span>&#160;    String controlFolder = null;</div><div class="line"><a name="l00442"></a><span class="lineno">  442</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; subFolders.size(); i++) {</div><div class="line"><a name="l00443"></a><span class="lineno">  443</span>&#160;      String tempName = subFolders.get(i).toLowerCase();</div><div class="line"><a name="l00444"></a><span class="lineno">  444</span>&#160;      tempName = fm.<a class="code" href="classfunctions_1_1_file_manager.html#ad027758f34214960a7aa800e0f7c19db">getFilename</a>(tempName);</div><div class="line"><a name="l00445"></a><span class="lineno">  445</span>&#160;      <span class="keywordflow">if</span> (tempName.equals(<span class="stringliteral">&quot;control&quot;</span>)) {</div><div class="line"><a name="l00446"></a><span class="lineno">  446</span>&#160;        controlFolder = subFolders.get(i);</div><div class="line"><a name="l00447"></a><span class="lineno">  447</span>&#160;        <span class="keywordflow">break</span>;</div><div class="line"><a name="l00448"></a><span class="lineno">  448</span>&#160;      }</div><div class="line"><a name="l00449"></a><span class="lineno">  449</span>&#160;    }</div><div class="line"><a name="l00450"></a><span class="lineno">  450</span>&#160;    <span class="keywordflow">if</span>(controlFolder==null){</div><div class="line"><a name="l00451"></a><span class="lineno">  451</span>&#160;      IJ.showMessage(<span class="stringliteral">&quot;No \&quot;control\&quot; folder has been found&quot;</span>);</div><div class="line"><a name="l00452"></a><span class="lineno">  452</span>&#160;      <span class="keywordflow">return</span> <span class="keyword">new</span> HashMap&lt;String, Trial&gt;();</div><div class="line"><a name="l00453"></a><span class="lineno">  453</span>&#160;    }</div><div class="line"><a name="l00454"></a><span class="lineno">  454</span>&#160;    List&lt;String&gt; controlFiles = fm.<a class="code" href="classfunctions_1_1_file_manager.html#a3a54a5574abfddd928b2b8675e8affa6">getFiles</a>(controlFolder);</div><div class="line"><a name="l00455"></a><span class="lineno">  455</span>&#160;    Map&lt;String, Trial&gt; cTrials = <span class="keyword">new</span> HashMap&lt;String, Trial&gt;();</div><div class="line"><a name="l00456"></a><span class="lineno">  456</span>&#160;    <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a> tm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a>();</div><div class="line"><a name="l00457"></a><span class="lineno">  457</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; controlFiles.size(); i++) {</div><div class="line"><a name="l00458"></a><span class="lineno">  458</span>&#160;      String file = controlFiles.get(i);</div><div class="line"><a name="l00459"></a><span class="lineno">  459</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = tm.getTrialFromAVI(file);</div><div class="line"><a name="l00460"></a><span class="lineno">  460</span>&#160;      <span class="keywordflow">if</span> (trial != null)</div><div class="line"><a name="l00461"></a><span class="lineno">  461</span>&#160;        cTrials.put(trial.<a class="code" href="classdata_1_1_trial.html#a0b86e44425dbe3c9d866aa273f87828a">type</a> + <span class="stringliteral">&quot;-_-&quot;</span> + trial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>, trial);</div><div class="line"><a name="l00462"></a><span class="lineno">  462</span>&#160;    }</div><div class="line"><a name="l00463"></a><span class="lineno">  463</span>&#160;    <span class="keywordflow">return</span> cTrials;</div><div class="line"><a name="l00464"></a><span class="lineno">  464</span>&#160;  }</div><div class="line"><a name="l00465"></a><span class="lineno">  465</span>&#160;</div><div class="line"><a name="l00474"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a0a5886ad5b1d3a1dee18ed4fe5da7ed8">  474</a></span>&#160;  <span class="keyword">private</span> List&lt;Double&gt; <a class="code" href="classanalysis_1_1_chemotaxis.html#a0a5886ad5b1d3a1dee18ed4fe5da7ed8">getListOfAngles</a>(<a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> theTracks) {</div><div class="line"><a name="l00475"></a><span class="lineno">  475</span>&#160;    List&lt;Double&gt; instAngles = <span class="keyword">new</span> ArrayList&lt;Double&gt;();</div><div class="line"><a name="l00476"></a><span class="lineno">  476</span>&#160;    <span class="keywordflow">for</span> (ListIterator iT = theTracks.listIterator(); iT.hasNext();) {</div><div class="line"><a name="l00477"></a><span class="lineno">  477</span>&#160;      List track = (ArrayList) iT.next();</div><div class="line"><a name="l00478"></a><span class="lineno">  478</span>&#160;      <span class="keywordtype">int</span> nPoints = track.size();</div><div class="line"><a name="l00479"></a><span class="lineno">  479</span>&#160;      <span class="keywordflow">for</span> (<span class="keywordtype">int</span> j = 0; j &lt; (nPoints - <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a93caa48162e34b2227a839ed71b4ed44">angleDelta</a>); j++) {</div><div class="line"><a name="l00480"></a><span class="lineno">  480</span>&#160;        <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> oldSpermatozoon = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) track.get(j);</div><div class="line"><a name="l00481"></a><span class="lineno">  481</span>&#160;        <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> newSpermatozoon = (<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a>) track.get(j + <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a93caa48162e34b2227a839ed71b4ed44">angleDelta</a>);</div><div class="line"><a name="l00482"></a><span class="lineno">  482</span>&#160;        <span class="keywordtype">float</span> diffX = newSpermatozoon.<a class="code" href="classdata_1_1_spermatozoon.html#ad0da36b2558901e21e7a30f6c227a45e">x</a> - oldSpermatozoon.<a class="code" href="classdata_1_1_spermatozoon.html#ad0da36b2558901e21e7a30f6c227a45e">x</a>;</div><div class="line"><a name="l00483"></a><span class="lineno">  483</span>&#160;        <span class="keywordtype">float</span> diffY = newSpermatozoon.<a class="code" href="classdata_1_1_spermatozoon.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> - oldSpermatozoon.<a class="code" href="classdata_1_1_spermatozoon.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>;</div><div class="line"><a name="l00484"></a><span class="lineno">  484</span>&#160;        <span class="keywordtype">double</span> angle = (360 + Math.atan2(diffY, diffX) * 180 / Math.PI) % (360); <span class="comment">// Absolute</span></div><div class="line"><a name="l00485"></a><span class="lineno">  485</span>&#160;                                                                                 <span class="comment">// angle</span></div><div class="line"><a name="l00486"></a><span class="lineno">  486</span>&#160;        instAngles.add(angle);</div><div class="line"><a name="l00487"></a><span class="lineno">  487</span>&#160;      }</div><div class="line"><a name="l00488"></a><span class="lineno">  488</span>&#160;    }</div><div class="line"><a name="l00489"></a><span class="lineno">  489</span>&#160;    <span class="keywordflow">return</span> instAngles;</div><div class="line"><a name="l00490"></a><span class="lineno">  490</span>&#160;  }</div><div class="line"><a name="l00491"></a><span class="lineno">  491</span>&#160;</div><div class="line"><a name="l00505"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">  505</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">double</span>[] <a class="code" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">getOddsValues</a>(<a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> tracks) {</div><div class="line"><a name="l00506"></a><span class="lineno">  506</span>&#160;</div><div class="line"><a name="l00507"></a><span class="lineno">  507</span>&#160;    <span class="keywordtype">double</span>[] values = <span class="keyword">new</span> <span class="keywordtype">double</span>[] { 0.0, 0.0 };<span class="comment">// [0]-upgradient</span></div><div class="line"><a name="l00508"></a><span class="lineno">  508</span>&#160;                                                <span class="comment">// displacements;[1]-displacements</span></div><div class="line"><a name="l00509"></a><span class="lineno">  509</span>&#160;                                                <span class="comment">// to other directionality</span></div><div class="line"><a name="l00510"></a><span class="lineno">  510</span>&#160;    <span class="keywordtype">int</span> count = 0;</div><div class="line"><a name="l00511"></a><span class="lineno">  511</span>&#160;    <span class="keywordtype">int</span> index = 0;</div><div class="line"><a name="l00512"></a><span class="lineno">  512</span>&#160;    <span class="keywordflow">while</span> ((count &lt; <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a11078ae453283411c72774c45caa7519">MAXINSTANGLES</a>) &amp;&amp; (index &lt; tracks.size())) {</div><div class="line"><a name="l00513"></a><span class="lineno">  513</span>&#160;      <span class="keywordtype">int</span>[] countInstDirections = <a class="code" href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">countInstantDisplacements</a>((List) tracks.get(index));</div><div class="line"><a name="l00514"></a><span class="lineno">  514</span>&#160;      count += countInstDirections[0] + countInstDirections[1];</div><div class="line"><a name="l00515"></a><span class="lineno">  515</span>&#160;      values[0] += (double) countInstDirections[0]; <span class="comment">// number of instantaneous</span></div><div class="line"><a name="l00516"></a><span class="lineno">  516</span>&#160;                                                    <span class="comment">// angles in the positive</span></div><div class="line"><a name="l00517"></a><span class="lineno">  517</span>&#160;                                                    <span class="comment">// direction</span></div><div class="line"><a name="l00518"></a><span class="lineno">  518</span>&#160;      values[1] += (double) (countInstDirections[0] + countInstDirections[1]);</div><div class="line"><a name="l00519"></a><span class="lineno">  519</span>&#160;      index++;</div><div class="line"><a name="l00520"></a><span class="lineno">  520</span>&#160;    }</div><div class="line"><a name="l00521"></a><span class="lineno">  521</span>&#160;    <span class="keywordflow">return</span> values;</div><div class="line"><a name="l00522"></a><span class="lineno">  522</span>&#160;  }</div><div class="line"><a name="l00523"></a><span class="lineno">  523</span>&#160;</div><div class="line"><a name="l00531"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a973011dfbed998ea23443c2b79ac9ee3">  531</a></span>&#160;  <span class="keyword">private</span> List&lt;String&gt; <a class="code" href="classanalysis_1_1_chemotaxis.html#a973011dfbed998ea23443c2b79ac9ee3">getTestFolders</a>(String folder) {</div><div class="line"><a name="l00532"></a><span class="lineno">  532</span>&#160;    <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a> fm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_file_manager.html">FileManager</a>();</div><div class="line"><a name="l00533"></a><span class="lineno">  533</span>&#160;    List&lt;String&gt; testFolders = fm.<a class="code" href="classfunctions_1_1_file_manager.html#a73efd872c86ccdce535ddb2798aaaea4">getSubfolders</a>(folder);</div><div class="line"><a name="l00534"></a><span class="lineno">  534</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; testFolders.size(); i++) {</div><div class="line"><a name="l00535"></a><span class="lineno">  535</span>&#160;      String tempName = testFolders.get(i).toLowerCase();</div><div class="line"><a name="l00536"></a><span class="lineno">  536</span>&#160;      tempName = fm.<a class="code" href="classfunctions_1_1_file_manager.html#ad027758f34214960a7aa800e0f7c19db">getFilename</a>(tempName);</div><div class="line"><a name="l00537"></a><span class="lineno">  537</span>&#160;      <span class="keywordflow">if</span> (tempName.equals(<span class="stringliteral">&quot;control&quot;</span>)) {</div><div class="line"><a name="l00538"></a><span class="lineno">  538</span>&#160;        testFolders.remove(i);</div><div class="line"><a name="l00539"></a><span class="lineno">  539</span>&#160;      }</div><div class="line"><a name="l00540"></a><span class="lineno">  540</span>&#160;    }</div><div class="line"><a name="l00541"></a><span class="lineno">  541</span>&#160;    <span class="keywordflow">return</span> testFolders;</div><div class="line"><a name="l00542"></a><span class="lineno">  542</span>&#160;  }</div><div class="line"><a name="l00543"></a><span class="lineno">  543</span>&#160;</div><div class="line"><a name="l00551"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a5580224f7f7e9df7d925ad14f9364d98">  551</a></span>&#160;  <span class="keyword">private</span> Map&lt;String, Trial&gt; <a class="code" href="classanalysis_1_1_chemotaxis.html#a5580224f7f7e9df7d925ad14f9364d98">getTrials</a>(List&lt;String&gt; filenames) {</div><div class="line"><a name="l00552"></a><span class="lineno">  552</span>&#160;    <span class="comment">// Extract Trials</span></div><div class="line"><a name="l00553"></a><span class="lineno">  553</span>&#160;    <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a> tm = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_trial_manager.html">TrialManager</a>();</div><div class="line"><a name="l00554"></a><span class="lineno">  554</span>&#160;    Map&lt;String, Trial&gt; trials = <span class="keyword">new</span> HashMap&lt;String, Trial&gt;();</div><div class="line"><a name="l00555"></a><span class="lineno">  555</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; filenames.size(); i++) {</div><div class="line"><a name="l00556"></a><span class="lineno">  556</span>&#160;      String file = filenames.get(i);</div><div class="line"><a name="l00557"></a><span class="lineno">  557</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = tm.<a class="code" href="classfunctions_1_1_trial_manager.html#a5d815ce30de28983d08c22c909562e11">getTrialFromAVI</a>(file);</div><div class="line"><a name="l00558"></a><span class="lineno">  558</span>&#160;      <span class="keywordflow">if</span> (trial != null)</div><div class="line"><a name="l00559"></a><span class="lineno">  559</span>&#160;        trials.put(trial.<a class="code" href="classdata_1_1_trial.html#a0b86e44425dbe3c9d866aa273f87828a">type</a> + <span class="stringliteral">&quot;-_-&quot;</span> + trial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>, trial); <span class="comment">// Expression &quot;-_-&quot; is</span></div><div class="line"><a name="l00560"></a><span class="lineno">  560</span>&#160;                                                          <span class="comment">// just a separator</span></div><div class="line"><a name="l00561"></a><span class="lineno">  561</span>&#160;    }</div><div class="line"><a name="l00562"></a><span class="lineno">  562</span>&#160;    <span class="keywordflow">return</span> trials;</div><div class="line"><a name="l00563"></a><span class="lineno">  563</span>&#160;  }</div><div class="line"><a name="l00564"></a><span class="lineno">  564</span>&#160;</div><div class="line"><a name="l00574"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ae0431b7311aa1bb593e062536734de2c">  574</a></span>&#160;  <span class="keyword">private</span> ResultsTable <a class="code" href="classanalysis_1_1_chemotaxis.html#ae0431b7311aa1bb593e062536734de2c">indexesAnalysis</a>(Map&lt;String, Trial&gt; controls, Map&lt;String, Trial&gt; tests) {</div><div class="line"><a name="l00575"></a><span class="lineno">  575</span>&#160;</div><div class="line"><a name="l00576"></a><span class="lineno">  576</span>&#160;    Set&lt;String&gt; ckeySet = controls.keySet();</div><div class="line"><a name="l00577"></a><span class="lineno">  577</span>&#160;    Set&lt;String&gt; tkeySet = tests.keySet();</div><div class="line"><a name="l00578"></a><span class="lineno">  578</span>&#160;    ResultsTable rt = <span class="keyword">new</span> ResultsTable();</div><div class="line"><a name="l00579"></a><span class="lineno">  579</span>&#160;    <span class="keywordflow">for</span> (String k : ckeySet) {</div><div class="line"><a name="l00580"></a><span class="lineno">  580</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) controls.get(k);</div><div class="line"><a name="l00581"></a><span class="lineno">  581</span>&#160;      <span class="keywordtype">float</span> chIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">calculateChIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00582"></a><span class="lineno">  582</span>&#160;      <span class="keywordtype">float</span> slIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">calculateSLIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00583"></a><span class="lineno">  583</span>&#160;      <a class="code" href="classanalysis_1_1_chemotaxis.html#a9c90c33405ef04f0e75e5f8dcb56520e">setIndexesResults</a>(rt, trial, chIdx, slIdx);</div><div class="line"><a name="l00584"></a><span class="lineno">  584</span>&#160;    }</div><div class="line"><a name="l00585"></a><span class="lineno">  585</span>&#160;    <span class="keywordflow">for</span> (String k : tkeySet) {</div><div class="line"><a name="l00586"></a><span class="lineno">  586</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) tests.get(k);</div><div class="line"><a name="l00587"></a><span class="lineno">  587</span>&#160;      <span class="keywordtype">float</span> chIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">calculateChIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00588"></a><span class="lineno">  588</span>&#160;      <span class="keywordtype">float</span> slIdx = <a class="code" href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">calculateSLIndex</a>(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00589"></a><span class="lineno">  589</span>&#160;      <a class="code" href="classanalysis_1_1_chemotaxis.html#a9c90c33405ef04f0e75e5f8dcb56520e">setIndexesResults</a>(rt, trial, chIdx, slIdx);</div><div class="line"><a name="l00590"></a><span class="lineno">  590</span>&#160;    }</div><div class="line"><a name="l00591"></a><span class="lineno">  591</span>&#160;    <span class="keywordflow">return</span> rt;</div><div class="line"><a name="l00592"></a><span class="lineno">  592</span>&#160;  }</div><div class="line"><a name="l00593"></a><span class="lineno">  593</span>&#160;</div><div class="line"><a name="l00602"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a226e01e0b4acab847ec3b2c1bb233740">  602</a></span>&#160;  <span class="keyword">private</span> <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> <a class="code" href="classanalysis_1_1_chemotaxis.html#a226e01e0b4acab847ec3b2c1bb233740">mergeTracks</a>(Map&lt;String, Trial&gt; trials) {</div><div class="line"><a name="l00603"></a><span class="lineno">  603</span>&#160;</div><div class="line"><a name="l00604"></a><span class="lineno">  604</span>&#160;    <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> tracks = <span class="keyword">new</span> <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a>();</div><div class="line"><a name="l00605"></a><span class="lineno">  605</span>&#160;    <span class="keywordflow">for</span> (String k : trials.keySet()) {</div><div class="line"><a name="l00606"></a><span class="lineno">  606</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> trial = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) trials.get(k);</div><div class="line"><a name="l00607"></a><span class="lineno">  607</span>&#160;      tracks.addAll(trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00608"></a><span class="lineno">  608</span>&#160;    }</div><div class="line"><a name="l00609"></a><span class="lineno">  609</span>&#160;    <span class="keywordflow">return</span> tracks;</div><div class="line"><a name="l00610"></a><span class="lineno">  610</span>&#160;  }</div><div class="line"><a name="l00611"></a><span class="lineno">  611</span>&#160;</div><div class="line"><a name="l00621"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a3ae63569c841ffc6aa09be276f526c03">  621</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">int</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a3ae63569c841ffc6aa09be276f526c03">minSampleSize</a>(Map&lt;String, Trial&gt; trials) {</div><div class="line"><a name="l00622"></a><span class="lineno">  622</span>&#160;    <span class="keywordtype">int</span> minimum = 999999999;</div><div class="line"><a name="l00623"></a><span class="lineno">  623</span>&#160;    <span class="keywordflow">for</span> (String k : trials.keySet()) {</div><div class="line"><a name="l00624"></a><span class="lineno">  624</span>&#160;      <a class="code" href="classdata_1_1_trial.html">Trial</a> t = (<a class="code" href="classdata_1_1_trial.html">Trial</a>) trials.get(k);</div><div class="line"><a name="l00625"></a><span class="lineno">  625</span>&#160;      <span class="keywordtype">int</span>[] instantAngles = <a class="code" href="classanalysis_1_1_chemotaxis.html#a55deae924cf7ec2004a8fdcd8e185f94">countAngles</a>(t.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>);</div><div class="line"><a name="l00626"></a><span class="lineno">  626</span>&#160;      <span class="keywordtype">int</span> sampleSize = instantAngles[0] + instantAngles[1];</div><div class="line"><a name="l00627"></a><span class="lineno">  627</span>&#160;      <span class="keywordflow">if</span> (sampleSize &lt; minimum) {</div><div class="line"><a name="l00628"></a><span class="lineno">  628</span>&#160;        minimum = sampleSize;</div><div class="line"><a name="l00629"></a><span class="lineno">  629</span>&#160;      }</div><div class="line"><a name="l00630"></a><span class="lineno">  630</span>&#160;    }</div><div class="line"><a name="l00631"></a><span class="lineno">  631</span>&#160;    <span class="keywordflow">return</span> minimum;</div><div class="line"><a name="l00632"></a><span class="lineno">  632</span>&#160;  }</div><div class="line"><a name="l00633"></a><span class="lineno">  633</span>&#160;</div><div class="line"><a name="l00643"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">  643</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">double</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">or</a>(<a class="code" href="classdata_1_1_trial.html">Trial</a> control, <a class="code" href="classdata_1_1_trial.html">Trial</a> test) {</div><div class="line"><a name="l00644"></a><span class="lineno">  644</span>&#160;    <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> controlTracks = control.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>;</div><div class="line"><a name="l00645"></a><span class="lineno">  645</span>&#160;    <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> conditionTracks = test.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>;</div><div class="line"><a name="l00646"></a><span class="lineno">  646</span>&#160;    <span class="keywordtype">double</span>[] numeratorValues = <a class="code" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">getOddsValues</a>(conditionTracks);<span class="comment">// Calculate</span></div><div class="line"><a name="l00647"></a><span class="lineno">  647</span>&#160;                                                              <span class="comment">// numerator&#39;s</span></div><div class="line"><a name="l00648"></a><span class="lineno">  648</span>&#160;                                                              <span class="comment">// odds value</span></div><div class="line"><a name="l00649"></a><span class="lineno">  649</span>&#160;    <span class="keywordtype">double</span>[] denominatorValues = <a class="code" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">getOddsValues</a>(controlTracks);<span class="comment">// Calculate</span></div><div class="line"><a name="l00650"></a><span class="lineno">  650</span>&#160;                                                              <span class="comment">// denominator&#39;s</span></div><div class="line"><a name="l00651"></a><span class="lineno">  651</span>&#160;                                                              <span class="comment">// odds value</span></div><div class="line"><a name="l00652"></a><span class="lineno">  652</span>&#160;    <span class="keywordtype">double</span> numeratorRatio = numeratorValues[0] / numeratorValues[1];</div><div class="line"><a name="l00653"></a><span class="lineno">  653</span>&#160;    <span class="keywordtype">double</span> denominatorRatio = denominatorValues[0] / denominatorValues[1];</div><div class="line"><a name="l00654"></a><span class="lineno">  654</span>&#160;    <span class="keywordtype">double</span> oddsRatio = numeratorRatio / denominatorRatio;</div><div class="line"><a name="l00655"></a><span class="lineno">  655</span>&#160;    <span class="keywordflow">return</span> oddsRatio;</div><div class="line"><a name="l00656"></a><span class="lineno">  656</span>&#160;  }</div><div class="line"><a name="l00657"></a><span class="lineno">  657</span>&#160;</div><div class="line"><a name="l00666"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a8ee54f019a9258760e20482e3cd6b851">  666</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">double</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a8ee54f019a9258760e20482e3cd6b851">orThreshold</a>(Map&lt;String, Trial&gt; controls) {</div><div class="line"><a name="l00667"></a><span class="lineno">  667</span>&#160;</div><div class="line"><a name="l00668"></a><span class="lineno">  668</span>&#160;    <a class="code" href="classdata_1_1_serializable_list.html">SerializableList</a> controlTracks = <a class="code" href="classanalysis_1_1_chemotaxis.html#a226e01e0b4acab847ec3b2c1bb233740">mergeTracks</a>(controls);</div><div class="line"><a name="l00669"></a><span class="lineno">  669</span>&#160;    List&lt;Double&gt; oRs = <span class="keyword">new</span> ArrayList&lt;Double&gt;();</div><div class="line"><a name="l00670"></a><span class="lineno">  670</span>&#160;    <span class="keywordflow">for</span> (<span class="keywordtype">int</span> i = 0; i &lt; <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#ae808f1c980157cfd070c6e09e587e2aa">NUMSAMPLES</a>; i++) {</div><div class="line"><a name="l00671"></a><span class="lineno">  671</span>&#160;      IJ.showProgress((<span class="keywordtype">double</span>) i / <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#ae808f1c980157cfd070c6e09e587e2aa">NUMSAMPLES</a>);</div><div class="line"><a name="l00672"></a><span class="lineno">  672</span>&#160;      IJ.showStatus(<span class="stringliteral">&quot;Calculating Control Threshold. Shuffle &quot;</span> + i);</div><div class="line"><a name="l00673"></a><span class="lineno">  673</span>&#160;      Collections.shuffle(controlTracks);</div><div class="line"><a name="l00674"></a><span class="lineno">  674</span>&#160;      <span class="keywordtype">double</span>[] numeratorValues = <a class="code" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">getOddsValues</a>(controlTracks);<span class="comment">// Calculate</span></div><div class="line"><a name="l00675"></a><span class="lineno">  675</span>&#160;                                                              <span class="comment">// numerator&#39;s</span></div><div class="line"><a name="l00676"></a><span class="lineno">  676</span>&#160;                                                              <span class="comment">// odds value</span></div><div class="line"><a name="l00677"></a><span class="lineno">  677</span>&#160;      Collections.shuffle(controlTracks);</div><div class="line"><a name="l00678"></a><span class="lineno">  678</span>&#160;      <span class="keywordtype">double</span>[] denominatorValues = <a class="code" href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">getOddsValues</a>(controlTracks);<span class="comment">// Calculate</span></div><div class="line"><a name="l00679"></a><span class="lineno">  679</span>&#160;                                                                <span class="comment">// denominator&#39;s</span></div><div class="line"><a name="l00680"></a><span class="lineno">  680</span>&#160;                                                                <span class="comment">// odds value</span></div><div class="line"><a name="l00681"></a><span class="lineno">  681</span>&#160;      <span class="keywordtype">double</span> numeratorRatio = numeratorValues[0] / numeratorValues[1];</div><div class="line"><a name="l00682"></a><span class="lineno">  682</span>&#160;      <span class="keywordtype">double</span> denominatorRatio = denominatorValues[0] / denominatorValues[1];</div><div class="line"><a name="l00683"></a><span class="lineno">  683</span>&#160;      <span class="keywordtype">double</span> oddsRatio = numeratorRatio / denominatorRatio;</div><div class="line"><a name="l00684"></a><span class="lineno">  684</span>&#160;      oRs.add(oddsRatio);</div><div class="line"><a name="l00685"></a><span class="lineno">  685</span>&#160;      <span class="comment">// IJ.log(&quot;&quot;+oddsRatio);</span></div><div class="line"><a name="l00686"></a><span class="lineno">  686</span>&#160;    }</div><div class="line"><a name="l00687"></a><span class="lineno">  687</span>&#160;    Collections.sort(oRs);</div><div class="line"><a name="l00688"></a><span class="lineno">  688</span>&#160;    <span class="keywordflow">return</span> oRs.get((<span class="keywordtype">int</span>) (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#ae808f1c980157cfd070c6e09e587e2aa">NUMSAMPLES</a> * 0.95));</div><div class="line"><a name="l00689"></a><span class="lineno">  689</span>&#160;  }</div><div class="line"><a name="l00690"></a><span class="lineno">  690</span>&#160;</div><div class="line"><a name="l00701"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ab23f946e0f1055d348e975e3058f323d">  701</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">double</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ab23f946e0f1055d348e975e3058f323d">relativeAngle</a>(<a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> previous, <a class="code" href="classdata_1_1_spermatozoon.html">Spermatozoon</a> next) { <span class="comment">// With</span></div><div class="line"><a name="l00702"></a><span class="lineno">  702</span>&#160;                                                                           <span class="comment">// gradient</span></div><div class="line"><a name="l00703"></a><span class="lineno">  703</span>&#160;                                                                           <span class="comment">// direction</span></div><div class="line"><a name="l00704"></a><span class="lineno">  704</span>&#160;    <span class="keywordtype">double</span> angleDirection = (2 * Math.PI + <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a11ad187f45e1f7add56bde4071bfdf74">angleDirection</a> * Math.PI / 180) % (2 * Math.PI);</div><div class="line"><a name="l00705"></a><span class="lineno">  705</span>&#160;    <span class="keywordtype">float</span> diffX = next.<a class="code" href="classdata_1_1_spermatozoon.html#ad0da36b2558901e21e7a30f6c227a45e">x</a> - previous.<a class="code" href="classdata_1_1_spermatozoon.html#ad0da36b2558901e21e7a30f6c227a45e">x</a>;</div><div class="line"><a name="l00706"></a><span class="lineno">  706</span>&#160;    <span class="keywordtype">float</span> diffY = next.<a class="code" href="classdata_1_1_spermatozoon.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a> - previous.<a class="code" href="classdata_1_1_spermatozoon.html#aa4f0d3eebc3c443f9be81bf48561a217">y</a>;</div><div class="line"><a name="l00707"></a><span class="lineno">  707</span>&#160;    <span class="keywordtype">double</span> angle = (2 * Math.PI + Math.atan2(diffY, diffX)) % (2 * Math.PI); <span class="comment">// Absolute</span></div><div class="line"><a name="l00708"></a><span class="lineno">  708</span>&#160;                                                                             <span class="comment">// angle</span></div><div class="line"><a name="l00709"></a><span class="lineno">  709</span>&#160;    angle = (2 * Math.PI + angle - angleDirection) % (2 * Math.PI); <span class="comment">// Relative</span></div><div class="line"><a name="l00710"></a><span class="lineno">  710</span>&#160;                                                                    <span class="comment">// angle</span></div><div class="line"><a name="l00711"></a><span class="lineno">  711</span>&#160;                                                                    <span class="comment">// between</span></div><div class="line"><a name="l00712"></a><span class="lineno">  712</span>&#160;                                                                    <span class="comment">// interval</span></div><div class="line"><a name="l00713"></a><span class="lineno">  713</span>&#160;                                                                    <span class="comment">// [0,2*Pi]</span></div><div class="line"><a name="l00714"></a><span class="lineno">  714</span>&#160;    <span class="keywordflow">if</span> (angle &gt; Math.PI) {</div><div class="line"><a name="l00715"></a><span class="lineno">  715</span>&#160;      angle = -(2 * Math.PI - angle);</div><div class="line"><a name="l00716"></a><span class="lineno">  716</span>&#160;    }</div><div class="line"><a name="l00717"></a><span class="lineno">  717</span>&#160;    <span class="keywordflow">return</span> angle; <span class="comment">// Between [-PI,PI]</span></div><div class="line"><a name="l00718"></a><span class="lineno">  718</span>&#160;  }</div><div class="line"><a name="l00719"></a><span class="lineno">  719</span>&#160;</div><div class="line"><a name="l00724"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#aef66a58ab7f95817a68a3429550562fc">  724</a></span>&#160;  <span class="keyword">public</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#aef66a58ab7f95817a68a3429550562fc">selectAnalysis</a>() {</div><div class="line"><a name="l00725"></a><span class="lineno">  725</span>&#160;    <span class="comment">// Ask if user wants to analyze a file or directory</span></div><div class="line"><a name="l00726"></a><span class="lineno">  726</span>&#160;    Object[] options = { <span class="stringliteral">&quot;File&quot;</span>, <span class="stringliteral">&quot;Directory&quot;</span>, <span class="stringliteral">&quot; Multiple Simulations&quot;</span> };</div><div class="line"><a name="l00727"></a><span class="lineno">  727</span>&#160;    String question = <span class="stringliteral">&quot;What do you want to analyze?&quot;</span>;</div><div class="line"><a name="l00728"></a><span class="lineno">  728</span>&#160;    String title = <span class="stringliteral">&quot;Choose one analysis...&quot;</span>;</div><div class="line"><a name="l00729"></a><span class="lineno">  729</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> FILE = 0;</div><div class="line"><a name="l00730"></a><span class="lineno">  730</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> DIR = 1;</div><div class="line"><a name="l00731"></a><span class="lineno">  731</span>&#160;    <span class="keyword">final</span> <span class="keywordtype">int</span> SIMULATION = 2;</div><div class="line"><a name="l00732"></a><span class="lineno">  732</span>&#160;    <a class="code" href="classfunctions_1_1_utils.html">Utils</a> utils = <span class="keyword">new</span> <a class="code" href="classfunctions_1_1_utils.html">Utils</a>();</div><div class="line"><a name="l00733"></a><span class="lineno">  733</span>&#160;    <span class="keywordtype">int</span> sourceSelection = utils.<a class="code" href="classfunctions_1_1_utils.html#a0e53c856e8bb35342f949c2f320d0e74">analysisSelectionDialog</a>(options, question, title);</div><div class="line"><a name="l00734"></a><span class="lineno">  734</span>&#160;    <span class="keywordflow">if</span> (sourceSelection &lt; 0) {</div><div class="line"><a name="l00735"></a><span class="lineno">  735</span>&#160;      <span class="keywordflow">return</span>;</div><div class="line"><a name="l00736"></a><span class="lineno">  736</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sourceSelection == FILE) {<span class="comment">// File</span></div><div class="line"><a name="l00737"></a><span class="lineno">  737</span>&#160;      analysis = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a2d2e1e42ff8abcd21e8ddb4d502d9ec3">INDEXESFILE</a>; <span class="comment">// It&#39;s not possible to carry on</span></div><div class="line"><a name="l00738"></a><span class="lineno">  738</span>&#160;                                             <span class="comment">// bootstrapping analysis in a</span></div><div class="line"><a name="l00739"></a><span class="lineno">  739</span>&#160;                                             <span class="comment">// single file</span></div><div class="line"><a name="l00740"></a><span class="lineno">  740</span>&#160;    } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sourceSelection == DIR || sourceSelection == SIMULATION) {<span class="comment">// Directory</span></div><div class="line"><a name="l00741"></a><span class="lineno">  741</span>&#160;                                                                         <span class="comment">// or</span></div><div class="line"><a name="l00742"></a><span class="lineno">  742</span>&#160;                                                                         <span class="comment">// simulations</span></div><div class="line"><a name="l00743"></a><span class="lineno">  743</span>&#160;      <span class="comment">// Ask user which analysis wants to apply</span></div><div class="line"><a name="l00744"></a><span class="lineno">  744</span>&#160;      Object[] options2 = { <span class="stringliteral">&quot;Ch-Index&quot;</span>, <span class="stringliteral">&quot;BOOTSTRAPPING&quot;</span> };</div><div class="line"><a name="l00745"></a><span class="lineno">  745</span>&#160;      question = <span class="stringliteral">&quot;Which analysis do you want to apply to the data?&quot;</span>;</div><div class="line"><a name="l00746"></a><span class="lineno">  746</span>&#160;      title = <span class="stringliteral">&quot;Choose one analysis...&quot;</span>;</div><div class="line"><a name="l00747"></a><span class="lineno">  747</span>&#160;      <span class="keywordtype">int</span> analysisSelection = utils.<a class="code" href="classfunctions_1_1_utils.html#a0e53c856e8bb35342f949c2f320d0e74">analysisSelectionDialog</a>(options2, question, title);</div><div class="line"><a name="l00748"></a><span class="lineno">  748</span>&#160;      <span class="keyword">final</span> <span class="keywordtype">int</span> CHINDEX = 0;</div><div class="line"><a name="l00749"></a><span class="lineno">  749</span>&#160;      <span class="keyword">final</span> <span class="keywordtype">int</span> BOOTSTRAPPING = 1;</div><div class="line"><a name="l00750"></a><span class="lineno">  750</span>&#160;      <span class="keywordflow">if</span> (analysisSelection &lt; 0)</div><div class="line"><a name="l00751"></a><span class="lineno">  751</span>&#160;        <span class="keywordflow">return</span>;</div><div class="line"><a name="l00752"></a><span class="lineno">  752</span>&#160;      <span class="keywordflow">if</span> (sourceSelection == DIR) {</div><div class="line"><a name="l00753"></a><span class="lineno">  753</span>&#160;        <span class="keywordflow">if</span> (analysisSelection == CHINDEX) {</div><div class="line"><a name="l00754"></a><span class="lineno">  754</span>&#160;          analysis = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#aea93300e25d2c79a263d702652974555">INDEXESDIRECTORY</a>;</div><div class="line"><a name="l00755"></a><span class="lineno">  755</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (analysisSelection == BOOTSTRAPPING) {</div><div class="line"><a name="l00756"></a><span class="lineno">  756</span>&#160;          analysis = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#ad9b1fe1a91148ef56f2b25bb3578764f">BOOTSTRAPPING</a>;</div><div class="line"><a name="l00757"></a><span class="lineno">  757</span>&#160;        }</div><div class="line"><a name="l00758"></a><span class="lineno">  758</span>&#160;      } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (sourceSelection == SIMULATION) { <span class="comment">// Simulations</span></div><div class="line"><a name="l00759"></a><span class="lineno">  759</span>&#160;        <span class="keywordflow">if</span> (analysisSelection == CHINDEX) {</div><div class="line"><a name="l00760"></a><span class="lineno">  760</span>&#160;          analysis = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a8c82f8309b37b928874804133c555393">INDEXESSIMULATIONS</a>;</div><div class="line"><a name="l00761"></a><span class="lineno">  761</span>&#160;        } <span class="keywordflow">else</span> <span class="keywordflow">if</span> (analysisSelection == BOOTSTRAPPING) {</div><div class="line"><a name="l00762"></a><span class="lineno">  762</span>&#160;          analysis = <a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">TypeOfAnalysis</a>.<a class="code" href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a7520eb9cb2be4df8fff8c63292caed13">BOOTSTRAPPINGSIMULATIONS</a>;</div><div class="line"><a name="l00763"></a><span class="lineno">  763</span>&#160;        }</div><div class="line"><a name="l00764"></a><span class="lineno">  764</span>&#160;      }</div><div class="line"><a name="l00765"></a><span class="lineno">  765</span>&#160;    }</div><div class="line"><a name="l00766"></a><span class="lineno">  766</span>&#160;  }</div><div class="line"><a name="l00767"></a><span class="lineno">  767</span>&#160;</div><div class="line"><a name="l00781"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#ac5db76309b6da4b0f351cdbb5876fec4">  781</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#ac5db76309b6da4b0f351cdbb5876fec4">setBootstrappingResults</a>(ResultsTable rt, <span class="keywordtype">double</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">or</a>, <span class="keywordtype">double</span> th, <a class="code" href="classdata_1_1_trial.html">Trial</a> trial) {</div><div class="line"><a name="l00782"></a><span class="lineno">  782</span>&#160;    rt.incrementCounter();</div><div class="line"><a name="l00783"></a><span class="lineno">  783</span>&#160;    rt.addValue(<span class="stringliteral">&quot;ID&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>);</div><div class="line"><a name="l00784"></a><span class="lineno">  784</span>&#160;    rt.addValue(<span class="stringliteral">&quot;OR&quot;</span>, or);</div><div class="line"><a name="l00785"></a><span class="lineno">  785</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Threshold&quot;</span>, th);</div><div class="line"><a name="l00786"></a><span class="lineno">  786</span>&#160;    <span class="keywordflow">if</span> (or &gt; (th)) {</div><div class="line"><a name="l00787"></a><span class="lineno">  787</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Result&quot;</span>, <span class="stringliteral">&quot;POSITIVE&quot;</span>);</div><div class="line"><a name="l00788"></a><span class="lineno">  788</span>&#160;    } <span class="keywordflow">else</span> {</div><div class="line"><a name="l00789"></a><span class="lineno">  789</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Result&quot;</span>, <span class="stringliteral">&quot;-&quot;</span>);</div><div class="line"><a name="l00790"></a><span class="lineno">  790</span>&#160;    }</div><div class="line"><a name="l00791"></a><span class="lineno">  791</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Type&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a0b86e44425dbe3c9d866aa273f87828a">type</a>);</div><div class="line"><a name="l00792"></a><span class="lineno">  792</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Source&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a00baeba9d13a88ce01098a02d1e570d5">source</a>);</div><div class="line"><a name="l00793"></a><span class="lineno">  793</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a8c0dba3f8308ea1257549b3cef11ea23">compareOppositeDirections</a>)</div><div class="line"><a name="l00794"></a><span class="lineno">  794</span>&#160;      rt.addValue(<span class="stringliteral">&quot;COD&quot;</span>, <span class="stringliteral">&quot;YES&quot;</span>);</div><div class="line"><a name="l00795"></a><span class="lineno">  795</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00796"></a><span class="lineno">  796</span>&#160;      rt.addValue(<span class="stringliteral">&quot;COD&quot;</span>, <span class="stringliteral">&quot;NO&quot;</span>);</div><div class="line"><a name="l00797"></a><span class="lineno">  797</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a3e07114fb70a676dfe24fad6be8c3c75">male</a>.isEmpty())</div><div class="line"><a name="l00798"></a><span class="lineno">  798</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Male&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a3e07114fb70a676dfe24fad6be8c3c75">male</a>);</div><div class="line"><a name="l00799"></a><span class="lineno">  799</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#aecbab8174a6d72649883508cf9940d58">date</a>.isEmpty())</div><div class="line"><a name="l00800"></a><span class="lineno">  800</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Date&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#aecbab8174a6d72649883508cf9940d58">date</a>);</div><div class="line"><a name="l00801"></a><span class="lineno">  801</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a253e4e926c0399ed1ae42b5a5989824d">genericField</a>.isEmpty())</div><div class="line"><a name="l00802"></a><span class="lineno">  802</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Generic Field&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a253e4e926c0399ed1ae42b5a5989824d">genericField</a>);</div><div class="line"><a name="l00803"></a><span class="lineno">  803</span>&#160;  }</div><div class="line"><a name="l00804"></a><span class="lineno">  804</span>&#160;</div><div class="line"><a name="l00818"></a><span class="lineno"><a class="line" href="classanalysis_1_1_chemotaxis.html#a9c90c33405ef04f0e75e5f8dcb56520e">  818</a></span>&#160;  <span class="keyword">private</span> <span class="keywordtype">void</span> <a class="code" href="classanalysis_1_1_chemotaxis.html#a9c90c33405ef04f0e75e5f8dcb56520e">setIndexesResults</a>(ResultsTable rt, <a class="code" href="classdata_1_1_trial.html">Trial</a> trial, <span class="keywordtype">float</span> chIdx, <span class="keywordtype">float</span> slIdx) {</div><div class="line"><a name="l00819"></a><span class="lineno">  819</span>&#160;    <span class="keywordtype">int</span> nTracks = trial.<a class="code" href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">tracks</a>.size();</div><div class="line"><a name="l00820"></a><span class="lineno">  820</span>&#160;    rt.incrementCounter();</div><div class="line"><a name="l00821"></a><span class="lineno">  821</span>&#160;    rt.addValue(<span class="stringliteral">&quot;nTracks&quot;</span>, nTracks);</div><div class="line"><a name="l00822"></a><span class="lineno">  822</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Ch-Index&quot;</span>, chIdx);</div><div class="line"><a name="l00823"></a><span class="lineno">  823</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Sl-Index&quot;</span>, slIdx);</div><div class="line"><a name="l00824"></a><span class="lineno">  824</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Type&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a0b86e44425dbe3c9d866aa273f87828a">type</a>);</div><div class="line"><a name="l00825"></a><span class="lineno">  825</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Direction (Degrees)&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a11ad187f45e1f7add56bde4071bfdf74">angleDirection</a>);</div><div class="line"><a name="l00826"></a><span class="lineno">  826</span>&#160;    rt.addValue(<span class="stringliteral">&quot;ArcChemotaxis (Degrees)&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a42568ad774d8f4ccb9535aeda39fc883">angleAmplitude</a>);</div><div class="line"><a name="l00827"></a><span class="lineno">  827</span>&#160;    rt.addValue(<span class="stringliteral">&quot;ID&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">ID</a>);</div><div class="line"><a name="l00828"></a><span class="lineno">  828</span>&#160;    rt.addValue(<span class="stringliteral">&quot;Source&quot;</span>, trial.<a class="code" href="classdata_1_1_trial.html#a00baeba9d13a88ce01098a02d1e570d5">source</a>);</div><div class="line"><a name="l00829"></a><span class="lineno">  829</span>&#160;    <span class="keywordflow">if</span> (<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a8c0dba3f8308ea1257549b3cef11ea23">compareOppositeDirections</a>)</div><div class="line"><a name="l00830"></a><span class="lineno">  830</span>&#160;      rt.addValue(<span class="stringliteral">&quot;COD&quot;</span>, <span class="stringliteral">&quot;YES&quot;</span>);</div><div class="line"><a name="l00831"></a><span class="lineno">  831</span>&#160;    <span class="keywordflow">else</span></div><div class="line"><a name="l00832"></a><span class="lineno">  832</span>&#160;      rt.addValue(<span class="stringliteral">&quot;COD&quot;</span>, <span class="stringliteral">&quot;NO&quot;</span>);</div><div class="line"><a name="l00833"></a><span class="lineno">  833</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a3e07114fb70a676dfe24fad6be8c3c75">male</a>.isEmpty())</div><div class="line"><a name="l00834"></a><span class="lineno">  834</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Male&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a3e07114fb70a676dfe24fad6be8c3c75">male</a>);</div><div class="line"><a name="l00835"></a><span class="lineno">  835</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#aecbab8174a6d72649883508cf9940d58">date</a>.isEmpty())</div><div class="line"><a name="l00836"></a><span class="lineno">  836</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Date&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#aecbab8174a6d72649883508cf9940d58">date</a>);</div><div class="line"><a name="l00837"></a><span class="lineno">  837</span>&#160;    <span class="keywordflow">if</span> (!<a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a253e4e926c0399ed1ae42b5a5989824d">genericField</a>.isEmpty())</div><div class="line"><a name="l00838"></a><span class="lineno">  838</span>&#160;      rt.addValue(<span class="stringliteral">&quot;Generic Field&quot;</span>, <a class="code" href="classdata_1_1_params.html">Params</a>.<a class="code" href="classdata_1_1_params.html#a253e4e926c0399ed1ae42b5a5989824d">genericField</a>);</div><div class="line"><a name="l00839"></a><span class="lineno">  839</span>&#160;  }</div><div class="line"><a name="l00840"></a><span class="lineno">  840</span>&#160;}</div><div class="ttc" id="classfunctions_1_1_file_manager_html_af19fd6734ccb746c4f276c83b6a47689"><div class="ttname"><a href="classfunctions_1_1_file_manager.html#af19fd6734ccb746c4f276c83b6a47689">functions.FileManager.selectFolder</a></div><div class="ttdeci">String selectFolder()</div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00227">FileManager.java:227</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ac5db76309b6da4b0f351cdbb5876fec4"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ac5db76309b6da4b0f351cdbb5876fec4">analysis.Chemotaxis.setBootstrappingResults</a></div><div class="ttdeci">void setBootstrappingResults(ResultsTable rt, double or, double th, Trial trial)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00781">Chemotaxis.java:781</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ab864eab3ca8e5147e34d6a4747d24e72"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ab864eab3ca8e5147e34d6a4747d24e72">analysis.Chemotaxis.drawResults</a></div><div class="ttdeci">void drawResults(Trial trial)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00407">Chemotaxis.java:407</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_aea93300e25d2c79a263d702652974555"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#aea93300e25d2c79a263d702652974555">analysis.Chemotaxis.TypeOfAnalysis.INDEXESDIRECTORY</a></div><div class="ttdeci">INDEXESDIRECTORY</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classfunctions_1_1_file_manager_html_a73efd872c86ccdce535ddb2798aaaea4"><div class="ttname"><a href="classfunctions_1_1_file_manager.html#a73efd872c86ccdce535ddb2798aaaea4">functions.FileManager.getSubfolders</a></div><div class="ttdeci">List&lt; String &gt; getSubfolders(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00090">FileManager.java:90</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ad992aa584aa410ee10b0b5df660c43ec"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ad992aa584aa410ee10b0b5df660c43ec">analysis.Chemotaxis.analyseSimulations</a></div><div class="ttdeci">void analyseSimulations()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00128">Chemotaxis.java:128</a></div></div>
<div class="ttc" id="classdata_1_1_spermatozoon_html"><div class="ttname"><a href="classdata_1_1_spermatozoon.html">data.Spermatozoon</a></div><div class="ttdef"><b>Definition:</b> <a href="_spermatozoon_8java_source.html#l00027">Spermatozoon.java:27</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a226e01e0b4acab847ec3b2c1bb233740"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a226e01e0b4acab847ec3b2c1bb233740">analysis.Chemotaxis.mergeTracks</a></div><div class="ttdeci">SerializableList mergeTracks(Map&lt; String, Trial &gt; trials)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00602">Chemotaxis.java:602</a></div></div>
<div class="ttc" id="namespacefunctions_html"><div class="ttname"><a href="namespacefunctions.html">functions</a></div><div class="ttdef"><b>Definition:</b> <a href="_computer_vision_8java_source.html#l00019">ComputerVision.java:19</a></div></div>
<div class="ttc" id="namespacedata_html"><div class="ttname"><a href="namespacedata.html">data</a></div><div class="ttdef"><b>Definition:</b> <a href="_oscillatory_walker_8java_source.html#l00019">OscillatoryWalker.java:19</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ab23f946e0f1055d348e975e3058f323d"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ab23f946e0f1055d348e975e3058f323d">analysis.Chemotaxis.relativeAngle</a></div><div class="ttdeci">double relativeAngle(Spermatozoon previous, Spermatozoon next)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00701">Chemotaxis.java:701</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a381aa5dd2dd75a72b6b21f7b2475d888"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a381aa5dd2dd75a72b6b21f7b2475d888">analysis.Chemotaxis.bootstrappingAnalysis</a></div><div class="ttdeci">ResultsTable bootstrappingAnalysis(Map&lt; String, Trial &gt; controls, Map&lt; String, Trial &gt; tests)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00156">Chemotaxis.java:156</a></div></div>
<div class="ttc" id="classfunctions_1_1_paint_html"><div class="ttname"><a href="classfunctions_1_1_paint.html">functions.Paint</a></div><div class="ttdef"><b>Definition:</b> <a href="_paint_8java_source.html#l00071">Paint.java:71</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a0b1464e818c4300782cb7e3322448f95"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a0b1464e818c4300782cb7e3322448f95">analysis.Chemotaxis.analyseFile</a></div><div class="ttdeci">void analyseFile()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00111">Chemotaxis.java:111</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ab048bf7b5ce8c46bb48b99b8d0999110"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ab048bf7b5ce8c46bb48b99b8d0999110">analysis.Chemotaxis.doInBackground</a></div><div class="ttdeci">Boolean doInBackground()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00362">Chemotaxis.java:362</a></div></div>
<div class="ttc" id="classfunctions_1_1_utils_html_a0e53c856e8bb35342f949c2f320d0e74"><div class="ttname"><a href="classfunctions_1_1_utils.html#a0e53c856e8bb35342f949c2f320d0e74">functions.Utils.analysisSelectionDialog</a></div><div class="ttdeci">int analysisSelectionDialog(Object[] options, String question, String title)</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8java_source.html#l00042">Utils.java:42</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html_ab0c3156759c41236f7f0bc83e1e5ef8f"><div class="ttname"><a href="classdata_1_1_trial.html#ab0c3156759c41236f7f0bc83e1e5ef8f">data.Trial.tracks</a></div><div class="ttdeci">SerializableList tracks</div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00039">Trial.java:39</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a50fdf81a3460741674381622f16581cb"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a50fdf81a3460741674381622f16581cb">analysis.Chemotaxis.circularHistogram</a></div><div class="ttdeci">int [] circularHistogram(List&lt; Double &gt; angles, int n)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00281">Chemotaxis.java:281</a></div></div>
<div class="ttc" id="namespaceanalysis_html"><div class="ttname"><a href="namespaceanalysis.html">analysis</a></div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00019">Chemotaxis.java:19</a></div></div>
<div class="ttc" id="classdata_1_1_serializable_list_html"><div class="ttname"><a href="classdata_1_1_serializable_list.html">data.SerializableList</a></div><div class="ttdef"><b>Definition:</b> <a href="_serializable_list_8java_source.html#l00029">SerializableList.java:29</a></div></div>
<div class="ttc" id="classfunctions_1_1_file_manager_html_ad027758f34214960a7aa800e0f7c19db"><div class="ttname"><a href="classfunctions_1_1_file_manager.html#ad027758f34214960a7aa800e0f7c19db">functions.FileManager.getFilename</a></div><div class="ttdeci">String getFilename(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00057">FileManager.java:57</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_a899caa602e4fff675b17cdbab33607ec"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a899caa602e4fff675b17cdbab33607ec">analysis.Chemotaxis.TypeOfAnalysis.NONE</a></div><div class="ttdeci">NONE</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classfunctions_1_1_paint_html_ae6e7f899e277190943b0c57232976e97"><div class="ttname"><a href="classfunctions_1_1_paint.html#ae6e7f899e277190943b0c57232976e97">functions.Paint.drawRoseDiagram</a></div><div class="ttdeci">void drawRoseDiagram(int[] histogram, int radius, float chIdx, String sampleID)</div><div class="ttdef"><b>Definition:</b> <a href="_paint_8java_source.html#l00332">Paint.java:332</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_a8c82f8309b37b928874804133c555393"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a8c82f8309b37b928874804133c555393">analysis.Chemotaxis.TypeOfAnalysis.INDEXESSIMULATIONS</a></div><div class="ttdeci">INDEXESSIMULATIONS</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html_a0b86e44425dbe3c9d866aa273f87828a"><div class="ttname"><a href="classdata_1_1_trial.html#a0b86e44425dbe3c9d866aa273f87828a">data.Trial.type</a></div><div class="ttdeci">String type</div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00035">Trial.java:35</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html"><div class="ttname"><a href="classdata_1_1_trial.html">data.Trial</a></div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00027">Trial.java:27</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_aef66a58ab7f95817a68a3429550562fc"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#aef66a58ab7f95817a68a3429550562fc">analysis.Chemotaxis.selectAnalysis</a></div><div class="ttdeci">void selectAnalysis()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00724">Chemotaxis.java:724</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a3e07114fb70a676dfe24fad6be8c3c75"><div class="ttname"><a href="classdata_1_1_params.html#a3e07114fb70a676dfe24fad6be8c3c75">data.Params.male</a></div><div class="ttdeci">static String male</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00061">Params.java:61</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a00ea60f92f2e11a363c01d04b6df7f10"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a00ea60f92f2e11a363c01d04b6df7f10">analysis.Chemotaxis.getControlTrials</a></div><div class="ttdeci">Map&lt; String, Trial &gt; getControlTrials(String folder)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00438">Chemotaxis.java:438</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a0a5886ad5b1d3a1dee18ed4fe5da7ed8"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a0a5886ad5b1d3a1dee18ed4fe5da7ed8">analysis.Chemotaxis.getListOfAngles</a></div><div class="ttdeci">List&lt; Double &gt; getListOfAngles(SerializableList theTracks)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00474">Chemotaxis.java:474</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html_a317298c3409575f71e43acd3f73ce295"><div class="ttname"><a href="classdata_1_1_trial.html#a317298c3409575f71e43acd3f73ce295">data.Trial.ID</a></div><div class="ttdeci">String ID</div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00033">Trial.java:33</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html">analysis.Chemotaxis.TypeOfAnalysis</a></div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00050">Chemotaxis.java:50</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_a7520eb9cb2be4df8fff8c63292caed13"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a7520eb9cb2be4df8fff8c63292caed13">analysis.Chemotaxis.TypeOfAnalysis.BOOTSTRAPPINGSIMULATIONS</a></div><div class="ttdeci">BOOTSTRAPPINGSIMULATIONS</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a973011dfbed998ea23443c2b79ac9ee3"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a973011dfbed998ea23443c2b79ac9ee3">analysis.Chemotaxis.getTestFolders</a></div><div class="ttdeci">List&lt; String &gt; getTestFolders(String folder)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00531">Chemotaxis.java:531</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a8c0dba3f8308ea1257549b3cef11ea23"><div class="ttname"><a href="classdata_1_1_params.html#a8c0dba3f8308ea1257549b3cef11ea23">data.Params.compareOppositeDirections</a></div><div class="ttdeci">static boolean compareOppositeDirections</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00049">Params.java:49</a></div></div>
<div class="ttc" id="classfunctions_1_1_file_manager_html_aa741a9e7ac4127ae1a463fb626474edf"><div class="ttname"><a href="classfunctions_1_1_file_manager.html#aa741a9e7ac4127ae1a463fb626474edf">functions.FileManager.selectFile</a></div><div class="ttdeci">String selectFile()</div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00212">FileManager.java:212</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a11ad187f45e1f7add56bde4071bfdf74"><div class="ttname"><a href="classdata_1_1_params.html#a11ad187f45e1f7add56bde4071bfdf74">data.Params.angleDirection</a></div><div class="ttdeci">static float angleDirection</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00043">Params.java:43</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a3ae63569c841ffc6aa09be276f526c03"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a3ae63569c841ffc6aa09be276f526c03">analysis.Chemotaxis.minSampleSize</a></div><div class="ttdeci">int minSampleSize(Map&lt; String, Trial &gt; trials)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00621">Chemotaxis.java:621</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a253e4e926c0399ed1ae42b5a5989824d"><div class="ttname"><a href="classdata_1_1_params.html#a253e4e926c0399ed1ae42b5a5989824d">data.Params.genericField</a></div><div class="ttdeci">static String genericField</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00059">Params.java:59</a></div></div>
<div class="ttc" id="classdata_1_1_params_html"><div class="ttname"><a href="classdata_1_1_params.html">data.Params</a></div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00033">Params.java:33</a></div></div>
<div class="ttc" id="classfunctions_1_1_file_manager_html"><div class="ttname"><a href="classfunctions_1_1_file_manager.html">functions.FileManager</a></div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00037">FileManager.java:37</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a9c90c33405ef04f0e75e5f8dcb56520e"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a9c90c33405ef04f0e75e5f8dcb56520e">analysis.Chemotaxis.setIndexesResults</a></div><div class="ttdeci">void setIndexesResults(ResultsTable rt, Trial trial, float chIdx, float slIdx)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00818">Chemotaxis.java:818</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_ae808f1c980157cfd070c6e09e587e2aa"><div class="ttname"><a href="classdata_1_1_params.html#ae808f1c980157cfd070c6e09e587e2aa">data.Params.NUMSAMPLES</a></div><div class="ttdeci">static int NUMSAMPLES</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00079">Params.java:79</a></div></div>
<div class="ttc" id="classdata_1_1_spermatozoon_html_ad0da36b2558901e21e7a30f6c227a45e"><div class="ttname"><a href="classdata_1_1_spermatozoon.html#ad0da36b2558901e21e7a30f6c227a45e">data.Spermatozoon.x</a></div><div class="ttdeci">float x</div><div class="ttdef"><b>Definition:</b> <a href="_spermatozoon_8java_source.html#l00042">Spermatozoon.java:42</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a02c2fbfd2097bca3933e285e6712a58d"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a02c2fbfd2097bca3933e285e6712a58d">analysis.Chemotaxis.getOddsValues</a></div><div class="ttdeci">double [] getOddsValues(SerializableList tracks)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00505">Chemotaxis.java:505</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a5580224f7f7e9df7d925ad14f9364d98"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a5580224f7f7e9df7d925ad14f9364d98">analysis.Chemotaxis.getTrials</a></div><div class="ttdeci">Map&lt; String, Trial &gt; getTrials(List&lt; String &gt; filenames)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00551">Chemotaxis.java:551</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_aaa89eb018d311df9e98b904088d282a5"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#aaa89eb018d311df9e98b904088d282a5">analysis.Chemotaxis.analyseCondition</a></div><div class="ttdeci">ResultsTable analyseCondition(Map&lt; String, Trial &gt; controls, Map&lt; String, Trial &gt; tests)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00066">Chemotaxis.java:66</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ad8447fb7554f7f126822c7a3f3f680ce"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ad8447fb7554f7f126822c7a3f3f680ce">analysis.Chemotaxis.analyseDirectory</a></div><div class="ttdeci">void analyseDirectory()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00088">Chemotaxis.java:88</a></div></div>
<div class="ttc" id="classfunctions_1_1_file_manager_html_a3a54a5574abfddd928b2b8675e8affa6"><div class="ttname"><a href="classfunctions_1_1_file_manager.html#a3a54a5574abfddd928b2b8675e8affa6">functions.FileManager.getFiles</a></div><div class="ttdeci">List&lt; String &gt; getFiles(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_file_manager_8java_source.html#l00079">FileManager.java:79</a></div></div>
<div class="ttc" id="classfunctions_1_1_trial_manager_html_a5d815ce30de28983d08c22c909562e11"><div class="ttname"><a href="classfunctions_1_1_trial_manager.html#a5d815ce30de28983d08c22c909562e11">functions.TrialManager.getTrialFromAVI</a></div><div class="ttdeci">Trial getTrialFromAVI(String path)</div><div class="ttdef"><b>Definition:</b> <a href="_trial_manager_8java_source.html#l00050">TrialManager.java:50</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a55deae924cf7ec2004a8fdcd8e185f94"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a55deae924cf7ec2004a8fdcd8e185f94">analysis.Chemotaxis.countAngles</a></div><div class="ttdeci">int [] countAngles(SerializableList theTracks)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00306">Chemotaxis.java:306</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a93caa48162e34b2227a839ed71b4ed44"><div class="ttname"><a href="classdata_1_1_params.html#a93caa48162e34b2227a839ed71b4ed44">data.Params.angleDelta</a></div><div class="ttdeci">static int angleDelta</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00041">Params.java:41</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_a2d2e1e42ff8abcd21e8ddb4d502d9ec3"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#a2d2e1e42ff8abcd21e8ddb4d502d9ec3">analysis.Chemotaxis.TypeOfAnalysis.INDEXESFILE</a></div><div class="ttdeci">INDEXESFILE</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a4cf45f4c73ebe44a71a622c690f0b331"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a4cf45f4c73ebe44a71a622c690f0b331">analysis.Chemotaxis.or</a></div><div class="ttdeci">double or(Trial control, Trial test)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00643">Chemotaxis.java:643</a></div></div>
<div class="ttc" id="classfunctions_1_1_trial_manager_html_a83f9d10eaa1ef4efb6de1f0e8b690978"><div class="ttname"><a href="classfunctions_1_1_trial_manager.html#a83f9d10eaa1ef4efb6de1f0e8b690978">functions.TrialManager.simulateTrials</a></div><div class="ttdeci">Map&lt; String, Trial &gt; simulateTrials(double beta, double responsiveCells, int MAXSIMULATIONS)</div><div class="ttdef"><b>Definition:</b> <a href="_trial_manager_8java_source.html#l00158">TrialManager.java:158</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a668ad1c1240012d6fb70c1fac4a219be"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a668ad1c1240012d6fb70c1fac4a219be">analysis.Chemotaxis.countInstantDisplacements</a></div><div class="ttdeci">int [] countInstantDisplacements(List&lt; Spermatozoon &gt; track)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00328">Chemotaxis.java:328</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a8ee54f019a9258760e20482e3cd6b851"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a8ee54f019a9258760e20482e3cd6b851">analysis.Chemotaxis.orThreshold</a></div><div class="ttdeci">double orThreshold(Map&lt; String, Trial &gt; controls)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00666">Chemotaxis.java:666</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html">analysis.Chemotaxis</a></div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00048">Chemotaxis.java:48</a></div></div>
<div class="ttc" id="classdata_1_1_spermatozoon_html_aa4f0d3eebc3c443f9be81bf48561a217"><div class="ttname"><a href="classdata_1_1_spermatozoon.html#aa4f0d3eebc3c443f9be81bf48561a217">data.Spermatozoon.y</a></div><div class="ttdeci">float y</div><div class="ttdef"><b>Definition:</b> <a href="_spermatozoon_8java_source.html#l00044">Spermatozoon.java:44</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_ae8b85275ab9c5375a3d35dcb7cd8332f"><div class="ttname"><a href="classdata_1_1_params.html#ae8b85275ab9c5375a3d35dcb7cd8332f">data.Params.printXY</a></div><div class="ttdeci">static boolean printXY</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00090">Params.java:90</a></div></div>
<div class="ttc" id="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis_html_ad9b1fe1a91148ef56f2b25bb3578764f"><div class="ttname"><a href="enumanalysis_1_1_chemotaxis_1_1_type_of_analysis.html#ad9b1fe1a91148ef56f2b25bb3578764f">analysis.Chemotaxis.TypeOfAnalysis.BOOTSTRAPPING</a></div><div class="ttdeci">BOOTSTRAPPING</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00051">Chemotaxis.java:51</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a42568ad774d8f4ccb9535aeda39fc883"><div class="ttname"><a href="classdata_1_1_params.html#a42568ad774d8f4ccb9535aeda39fc883">data.Params.angleAmplitude</a></div><div class="ttdeci">static float angleAmplitude</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00036">Params.java:36</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html_a00baeba9d13a88ce01098a02d1e570d5"><div class="ttname"><a href="classdata_1_1_trial.html#a00baeba9d13a88ce01098a02d1e570d5">data.Trial.source</a></div><div class="ttdeci">String source</div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00037">Trial.java:37</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ae0431b7311aa1bb593e062536734de2c"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ae0431b7311aa1bb593e062536734de2c">analysis.Chemotaxis.indexesAnalysis</a></div><div class="ttdeci">ResultsTable indexesAnalysis(Map&lt; String, Trial &gt; controls, Map&lt; String, Trial &gt; tests)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00574">Chemotaxis.java:574</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a4ab493d2d901c65e8387095a69cbf83d"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a4ab493d2d901c65e8387095a69cbf83d">analysis.Chemotaxis.calculateChIndex</a></div><div class="ttdeci">float calculateChIndex(List&lt; List&lt; Spermatozoon &gt;&gt; theTracks)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00187">Chemotaxis.java:187</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a1ebc6d4aaad3ec1c0eca87acb729ffb5"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a1ebc6d4aaad3ec1c0eca87acb729ffb5">analysis.Chemotaxis.checkPairs</a></div><div class="ttdeci">boolean checkPairs(Map&lt; String, Trial &gt; controls, Map&lt; String, Trial &gt; tests)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00259">Chemotaxis.java:259</a></div></div>
<div class="ttc" id="classfunctions_1_1_utils_html"><div class="ttname"><a href="classfunctions_1_1_utils.html">functions.Utils</a></div><div class="ttdef"><b>Definition:</b> <a href="_utils_8java_source.html#l00033">Utils.java:33</a></div></div>
<div class="ttc" id="classfunctions_1_1_paint_html_a21dbba9326aa66f10d1dfccb836c14d9"><div class="ttname"><a href="classfunctions_1_1_paint.html#a21dbba9326aa66f10d1dfccb836c14d9">functions.Paint.drawChemotaxis</a></div><div class="ttdeci">void drawChemotaxis(Trial trial, float chIdx, float slIdx)</div><div class="ttdef"><b>Definition:</b> <a href="_paint_8java_source.html#l00256">Paint.java:256</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ab650651e4cda2869f73100c6fd2c821a"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ab650651e4cda2869f73100c6fd2c821a">analysis.Chemotaxis.done</a></div><div class="ttdeci">void done()</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00386">Chemotaxis.java:386</a></div></div>
<div class="ttc" id="classfunctions_1_1_trial_manager_html"><div class="ttname"><a href="classfunctions_1_1_trial_manager.html">functions.TrialManager</a></div><div class="ttdef"><b>Definition:</b> <a href="_trial_manager_8java_source.html#l00042">TrialManager.java:42</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_a40fa55bdb0e1b4e7e0f9de92076ab2f9"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#a40fa55bdb0e1b4e7e0f9de92076ab2f9">analysis.Chemotaxis.findTrial</a></div><div class="ttdeci">Trial findTrial(String id, Map&lt; String, Trial &gt; trials)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00429">Chemotaxis.java:429</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_aecbab8174a6d72649883508cf9940d58"><div class="ttname"><a href="classdata_1_1_params.html#aecbab8174a6d72649883508cf9940d58">data.Params.date</a></div><div class="ttdeci">static String date</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00051">Params.java:51</a></div></div>
<div class="ttc" id="classdata_1_1_trial_html_abce721f4aa25ad8ba8181de990a78b73"><div class="ttname"><a href="classdata_1_1_trial.html#abce721f4aa25ad8ba8181de990a78b73">data.Trial.fieldWidth</a></div><div class="ttdeci">int fieldWidth</div><div class="ttdef"><b>Definition:</b> <a href="_trial_8java_source.html#l00041">Trial.java:41</a></div></div>
<div class="ttc" id="classdata_1_1_params_html_a11078ae453283411c72774c45caa7519"><div class="ttname"><a href="classdata_1_1_params.html#a11078ae453283411c72774c45caa7519">data.Params.MAXINSTANGLES</a></div><div class="ttdeci">static int MAXINSTANGLES</div><div class="ttdef"><b>Definition:</b> <a href="_params_8java_source.html#l00067">Params.java:67</a></div></div>
<div class="ttc" id="classanalysis_1_1_chemotaxis_html_ae3ff70acea28007b345ce335321b82fe"><div class="ttname"><a href="classanalysis_1_1_chemotaxis.html#ae3ff70acea28007b345ce335321b82fe">analysis.Chemotaxis.calculateSLIndex</a></div><div class="ttdeci">float calculateSLIndex(List&lt; List&lt; Spermatozoon &gt;&gt; theTracks)</div><div class="ttdef"><b>Definition:</b> <a href="_chemotaxis_8java_source.html#l00223">Chemotaxis.java:223</a></div></div>
<div class="ttc" id="classfunctions_1_1_utils_html_ab85218da3569b5a7c0b9749e7b2b747a"><div class="ttname"><a href="classfunctions_1_1_utils.html#ab85218da3569b5a7c0b9749e7b2b747a">functions.Utils.printXYCoords</a></div><div class="ttdeci">String printXYCoords(List theTracks)</div><div class="ttdef"><b>Definition:</b> <a href="_utils_8java_source.html#l00084">Utils.java:84</a></div></div>
</div><!-- fragment --></div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_5eb159725f84c66aafd839904a4acdd0.html">main</a></li><li class="navelem"><a class="el" href="dir_fd3f6763802dee1ad875f6c80eac0bda.html">java</a></li><li class="navelem"><a class="el" href="dir_b7213baed0398854bf32ea8fb386b7df.html">analysis</a></li><li class="navelem"><a class="el" href="_chemotaxis_8java.html">Chemotaxis.java</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.12 </li>
  </ul>
</div>
</body>
</html>
